{"version":3,"file":"color_target_state.spec.js","names":["description","makeTestGroup","assert","unreachable","IsDualSourceBlendingFactor","kBlendFactors","kBlendOperations","GPUConst","kPossibleColorRenderableTextureFormats","AllFeaturesMaxLimitsGPUTest","TextureTestMixin","clamp","TexelView","BlendingTest","createRenderPipelineForTest","colorTargetState","device","createRenderPipeline","layout","fragment","targets","module","createShaderModule","code","entryPoint","vertex","createBindGroupForTest","data","createBindGroup","entries","binding","resource","buffer","makeBufferWithContents","GPUBufferUsage","UNIFORM","g","mapColor","col","f","r","b","a","computeBlendFactor","src","src1","dst","blendColor","factor","v","Math","min","undefined","computeBlendOperation","srcFactor","dstFactor","operation","_","k","max","kBlendingGPUBlendComponentFormat","test","desc","params","u","combine","beginSubcases","filter","t","expand","p","needsBlendConstant","fn","skipIfDeviceDoesNotHaveFeature","textureFormat","srcColor","srcColor1","dstColor","blendConstant","expectedColor","component","useBlendSrc1","pipeline","format","blend","color","alpha","primitive","topology","renderTarget","createTextureTracked","usage","GPUTextureUsage","RENDER_ATTACHMENT","COPY_SRC","size","commandEncoder","createCommandEncoder","renderPass","beginRenderPass","colorAttachments","view","createView","clearValue","loadOp","storeOp","setPipeline","setBlendConstant","setBindGroup","getBindGroupLayout","Float32Array","draw","end","queue","submit","finish","expectSinglePixelComparisonsAreOkInTexture","texture","coord","x","y","exp","R","G","B","A","maxFractionalDiff","skipIfTextureFormatNotSupported","skipIfTextureFormatNotUsableAsRenderAttachment","skipIfTextureFormatNotBlendable","expColor","expTexelView","fromTexelsAsColors","_coords","expectTexelViewComparisonIsOkInTexture","kSize","kWhiteColorData","blendComponent","testPipeline","paramsSubcasesOnly","kColorWriteCombinations","mask","ColorWrite","RED","GREEN","BLUE","ALPHA","writeMask","kBaseColorData","disabled","GPUColorWrite","srcValue","dstValue","expValue"],"sources":["../../../../../src/webgpu/api/operation/rendering/color_target_state.spec.ts"],"sourcesContent":["export const description = `\nTest blending results.\n\nTODO:\n- Test result for all combinations of args (make sure each case is distinguishable from others\n- Test underflow/overflow has consistent behavior\n- ?\n`;\n\nimport { makeTestGroup } from '../../../../common/framework/test_group.js';\nimport { assert, TypedArrayBufferView, unreachable } from '../../../../common/util/util.js';\nimport {\n  IsDualSourceBlendingFactor,\n  kBlendFactors,\n  kBlendOperations,\n} from '../../../capability_info.js';\nimport { GPUConst } from '../../../constants.js';\nimport {\n  EncodableTextureFormat,\n  kPossibleColorRenderableTextureFormats,\n} from '../../../format_info.js';\nimport { AllFeaturesMaxLimitsGPUTest, TextureTestMixin } from '../../../gpu_test.js';\nimport { clamp } from '../../../util/math.js';\nimport { TexelView } from '../../../util/texture/texel_view.js';\n\nclass BlendingTest extends AllFeaturesMaxLimitsGPUTest {\n  createRenderPipelineForTest(colorTargetState: GPUColorTargetState): GPURenderPipeline {\n    return this.device.createRenderPipeline({\n      layout: 'auto',\n      fragment: {\n        targets: [colorTargetState],\n        module: this.device.createShaderModule({\n          code: `\n            struct Params {\n              color : vec4<f32>\n            }\n            @group(0) @binding(0) var<uniform> params : Params;\n            @fragment fn main() -> @location(0) vec4<f32> {\n              return params.color;\n            }\n            `,\n        }),\n        entryPoint: 'main',\n      },\n      vertex: {\n        module: this.device.createShaderModule({\n          code: `\n            @vertex fn main(\n              @builtin(vertex_index) VertexIndex : u32\n              ) -> @builtin(position) vec4<f32> {\n              var pos = array<vec2<f32>, 3>(\n                  vec2<f32>(-1.0, -1.0),\n                  vec2<f32>(3.0, -1.0),\n                  vec2<f32>(-1.0, 3.0));\n              return vec4<f32>(pos[VertexIndex], 0.0, 1.0);\n            }\n            `,\n        }),\n        entryPoint: 'main',\n      },\n    });\n  }\n\n  createBindGroupForTest(layout: GPUBindGroupLayout, data: TypedArrayBufferView): GPUBindGroup {\n    return this.device.createBindGroup({\n      layout,\n      entries: [\n        {\n          binding: 0,\n          resource: {\n            buffer: this.makeBufferWithContents(data, GPUBufferUsage.UNIFORM),\n          },\n        },\n      ],\n    });\n  }\n}\n\nexport const g = makeTestGroup(TextureTestMixin(BlendingTest));\n\nfunction mapColor(\n  col: GPUColorDict,\n  f: (v: number, k: keyof GPUColorDict) => number\n): GPUColorDict {\n  return {\n    r: f(col.r, 'r'),\n    g: f(col.g, 'g'),\n    b: f(col.b, 'b'),\n    a: f(col.a, 'a'),\n  };\n}\n\nfunction computeBlendFactor(\n  src: GPUColorDict,\n  src1: GPUColorDict,\n  dst: GPUColorDict,\n  blendColor: GPUColorDict | undefined,\n  factor: GPUBlendFactor\n): GPUColorDict {\n  switch (factor) {\n    case 'zero':\n      return { r: 0, g: 0, b: 0, a: 0 };\n    case 'one':\n      return { r: 1, g: 1, b: 1, a: 1 };\n    case 'src':\n      return { ...src };\n    case 'one-minus-src':\n      return mapColor(src, v => 1 - v);\n    case 'src-alpha':\n      return mapColor(src, () => src.a);\n    case 'one-minus-src-alpha':\n      return mapColor(src, () => 1 - src.a);\n    case 'dst':\n      return { ...dst };\n    case 'one-minus-dst':\n      return mapColor(dst, v => 1 - v);\n    case 'dst-alpha':\n      return mapColor(dst, () => dst.a);\n    case 'one-minus-dst-alpha':\n      return mapColor(dst, () => 1 - dst.a);\n    case 'src-alpha-saturated': {\n      const f = Math.min(src.a, 1 - dst.a);\n      return { r: f, g: f, b: f, a: 1 };\n    }\n    case 'constant':\n      assert(blendColor !== undefined);\n      return { ...blendColor };\n    case 'one-minus-constant':\n      assert(blendColor !== undefined);\n      return mapColor(blendColor, v => 1 - v);\n    case 'src1':\n      return { ...src1 };\n    case 'one-minus-src1':\n      return mapColor(src1, v => 1 - v);\n    case 'src1-alpha':\n      return mapColor(src1, () => src1.a);\n    case 'one-minus-src1-alpha':\n      return mapColor(src1, () => 1 - src1.a);\n    default:\n      unreachable();\n  }\n}\n\nfunction computeBlendOperation(\n  src: GPUColorDict,\n  srcFactor: GPUColorDict,\n  dst: GPUColorDict,\n  dstFactor: GPUColorDict,\n  operation: GPUBlendOperation\n) {\n  switch (operation) {\n    case 'add':\n      return mapColor(src, (_, k) => srcFactor[k] * src[k] + dstFactor[k] * dst[k]);\n    case 'max':\n      return mapColor(src, (_, k) => Math.max(src[k], dst[k]));\n    case 'min':\n      return mapColor(src, (_, k) => Math.min(src[k], dst[k]));\n    case 'reverse-subtract':\n      return mapColor(src, (_, k) => dstFactor[k] * dst[k] - srcFactor[k] * src[k]);\n    case 'subtract':\n      return mapColor(src, (_, k) => srcFactor[k] * src[k] - dstFactor[k] * dst[k]);\n  }\n}\n\nconst kBlendingGPUBlendComponentFormat = 'rgba16float';\ng.test('blending,GPUBlendComponent')\n  .desc(\n    `Test all combinations of parameters for GPUBlendComponent.\n\n  Tests that parameters are correctly passed to the backend API and blend computations\n  are done correctly by blending a single pixel. The test uses rgba16float as the format\n  to avoid checking clamping behavior (tested in api,operation,rendering,blending:clamp,*).\n\n  Params:\n    - component= {color, alpha} - whether to test blending the color or the alpha component.\n    - srcFactor= {...all GPUBlendFactors}\n    - dstFactor= {...all GPUBlendFactors}\n    - operation= {...all GPUBlendOperations}`\n  )\n  .params(u =>\n    u //\n      .combine('component', ['color', 'alpha'] as const)\n      .combine('srcFactor', kBlendFactors)\n      .combine('dstFactor', kBlendFactors)\n      .beginSubcases()\n      .combine('operation', kBlendOperations)\n      .filter(t => {\n        if (t.operation === 'min' || t.operation === 'max') {\n          return t.srcFactor === 'one' && t.dstFactor === 'one';\n        }\n        return true;\n      })\n      .combine('srcColor', [{ r: 0.11, g: 0.61, b: 0.81, a: 0.44 }])\n      .combine('srcColor1', [{ r: 0.22, g: 0.41, b: 0.51, a: 0.33 }])\n      .combine('dstColor', [\n        { r: 0.51, g: 0.22, b: 0.71, a: 0.33 },\n        { r: 0.09, g: 0.73, b: 0.93, a: 0.81 },\n      ])\n      .expand('blendConstant', p => {\n        const needsBlendConstant =\n          p.srcFactor === 'one-minus-constant' ||\n          p.srcFactor === 'constant' ||\n          p.dstFactor === 'one-minus-constant' ||\n          p.dstFactor === 'constant';\n        return needsBlendConstant ? [{ r: 0.91, g: 0.82, b: 0.73, a: 0.64 }] : [undefined];\n      })\n  )\n  .fn(t => {\n    if (\n      IsDualSourceBlendingFactor(t.params.srcFactor) ||\n      IsDualSourceBlendingFactor(t.params.dstFactor)\n    ) {\n      t.skipIfDeviceDoesNotHaveFeature('dual-source-blending');\n    }\n    const textureFormat: GPUTextureFormat = kBlendingGPUBlendComponentFormat;\n    const srcColor = t.params.srcColor;\n    const srcColor1 = t.params.srcColor1;\n    const dstColor = t.params.dstColor;\n    const blendConstant = t.params.blendConstant;\n\n    const srcFactor = computeBlendFactor(\n      srcColor,\n      srcColor1,\n      dstColor,\n      blendConstant,\n      t.params.srcFactor\n    );\n    const dstFactor = computeBlendFactor(\n      srcColor,\n      srcColor1,\n      dstColor,\n      blendConstant,\n      t.params.dstFactor\n    );\n\n    const expectedColor = computeBlendOperation(\n      srcColor,\n      srcFactor,\n      dstColor,\n      dstFactor,\n      t.params.operation\n    );\n\n    switch (t.params.component) {\n      case 'color':\n        expectedColor.a = srcColor.a;\n        break;\n      case 'alpha':\n        expectedColor.r = srcColor.r;\n        expectedColor.g = srcColor.g;\n        expectedColor.b = srcColor.b;\n        break;\n    }\n\n    const useBlendSrc1 =\n      IsDualSourceBlendingFactor(t.params.srcFactor) ||\n      IsDualSourceBlendingFactor(t.params.dstFactor);\n\n    const pipeline = t.device.createRenderPipeline({\n      layout: 'auto',\n      fragment: {\n        targets: [\n          {\n            format: textureFormat,\n            blend: {\n              // Set both color/alpha to defaults...\n              color: {},\n              alpha: {},\n              // ... but then override the component we're testing.\n              [t.params.component]: {\n                srcFactor: t.params.srcFactor,\n                dstFactor: t.params.dstFactor,\n                operation: t.params.operation,\n              },\n            },\n          },\n        ],\n        module: t.device.createShaderModule({\n          code: `\n${useBlendSrc1 ? 'enable dual_source_blending;' : ''}\n\nstruct Uniform {\n  color: vec4f,\n  blend: vec4f,\n};\n@group(0) @binding(0) var<uniform> u : Uniform;\n\nstruct FragOutput {\n  @location(0) ${useBlendSrc1 ? '@blend_src(0)' : ''} color : vec4f,\n  ${useBlendSrc1 ? '@location(0) @blend_src(1) blend : vec4f,' : ''}\n}\n\n@fragment fn main() ->FragOutput {\n  var fragOutput : FragOutput;\n  fragOutput.color = u.color;\n  ${useBlendSrc1 ? 'fragOutput.blend = u.blend;' : ''}\n  return fragOutput;\n}\n          `,\n        }),\n        entryPoint: 'main',\n      },\n      vertex: {\n        module: t.device.createShaderModule({\n          code: `\n@vertex fn main() -> @builtin(position) vec4<f32> {\n    return vec4<f32>(0.0, 0.0, 0.0, 1.0);\n}\n          `,\n        }),\n        entryPoint: 'main',\n      },\n      primitive: {\n        topology: 'point-list',\n      },\n    });\n\n    const renderTarget = t.createTextureTracked({\n      usage: GPUTextureUsage.RENDER_ATTACHMENT | GPUTextureUsage.COPY_SRC,\n      size: [1, 1, 1],\n      format: textureFormat,\n    });\n\n    const commandEncoder = t.device.createCommandEncoder();\n    const renderPass = commandEncoder.beginRenderPass({\n      colorAttachments: [\n        {\n          view: renderTarget.createView(),\n          clearValue: dstColor,\n          loadOp: 'clear',\n          storeOp: 'store',\n        },\n      ],\n    });\n    renderPass.setPipeline(pipeline);\n    if (blendConstant) {\n      renderPass.setBlendConstant(blendConstant);\n    }\n    renderPass.setBindGroup(\n      0,\n      t.device.createBindGroup({\n        layout: pipeline.getBindGroupLayout(0),\n        entries: [\n          {\n            binding: 0,\n            resource: {\n              buffer: t.makeBufferWithContents(\n                new Float32Array([\n                  srcColor.r,\n                  srcColor.g,\n                  srcColor.b,\n                  srcColor.a,\n                  srcColor1.r,\n                  srcColor1.g,\n                  srcColor1.b,\n                  srcColor1.a,\n                ]),\n                GPUBufferUsage.UNIFORM\n              ),\n            },\n          },\n        ],\n      })\n    );\n    renderPass.draw(1);\n    renderPass.end();\n\n    t.device.queue.submit([commandEncoder.finish()]);\n\n    t.expectSinglePixelComparisonsAreOkInTexture(\n      { texture: renderTarget },\n      [\n        {\n          coord: { x: 0, y: 0 },\n          exp: { R: expectedColor.r, G: expectedColor.g, B: expectedColor.b, A: expectedColor.a },\n        },\n      ],\n      { maxFractionalDiff: 0.003 }\n    );\n  });\n\ng.test('blending,formats')\n  .desc(\n    `Test blending results works for all formats that support it, and that blending is not applied\n  for formats that do not. Blending should be done in linear space for srgb formats.`\n  )\n  .params(u =>\n    u //\n      .combine('format', kPossibleColorRenderableTextureFormats)\n  )\n  .fn(t => {\n    const { format } = t.params;\n    t.skipIfTextureFormatNotSupported(format);\n    t.skipIfTextureFormatNotUsableAsRenderAttachment(format);\n    t.skipIfTextureFormatNotBlendable(format);\n\n    const pipeline = t.device.createRenderPipeline({\n      layout: 'auto',\n      fragment: {\n        targets: [\n          {\n            format,\n            blend: {\n              color: { srcFactor: 'one', dstFactor: 'one', operation: 'add' },\n              alpha: { srcFactor: 'one', dstFactor: 'one', operation: 'add' },\n            },\n          },\n        ],\n        module: t.device.createShaderModule({\n          code: `\n@fragment fn main() -> @location(0) vec4<f32> {\n  return vec4<f32>(0.4, 0.4, 0.4, 0.4);\n}\n          `,\n        }),\n        entryPoint: 'main',\n      },\n      vertex: {\n        module: t.device.createShaderModule({\n          code: `\n@vertex fn main() -> @builtin(position) vec4<f32> {\n    return vec4<f32>(0.0, 0.0, 0.0, 1.0);\n}\n          `,\n        }),\n        entryPoint: 'main',\n      },\n      primitive: {\n        topology: 'point-list',\n      },\n    });\n\n    const renderTarget = t.createTextureTracked({\n      usage: GPUTextureUsage.RENDER_ATTACHMENT | GPUTextureUsage.COPY_SRC,\n      size: [1, 1, 1],\n      format,\n    });\n\n    const commandEncoder = t.device.createCommandEncoder();\n    const renderPass = commandEncoder.beginRenderPass({\n      colorAttachments: [\n        {\n          view: renderTarget.createView(),\n          clearValue: { r: 0.2, g: 0.2, b: 0.2, a: 0.2 },\n          loadOp: 'clear',\n          storeOp: 'store',\n        },\n      ],\n    });\n    renderPass.setPipeline(pipeline);\n    renderPass.draw(1);\n    renderPass.end();\n    t.device.queue.submit([commandEncoder.finish()]);\n\n    const expColor = { R: 0.6, G: 0.6, B: 0.6, A: 0.6 };\n    const expTexelView = TexelView.fromTexelsAsColors(\n      format as EncodableTextureFormat,\n      _coords => expColor\n    );\n    t.expectTexelViewComparisonIsOkInTexture({ texture: renderTarget }, expTexelView, [1, 1, 1]);\n  });\n\ng.test('blend_constant,initial')\n  .desc(`Test that the blend constant is set to [0,0,0,0] at the beginning of a pass.`)\n  .fn(t => {\n    const format = 'rgba8unorm';\n    const kSize = 1;\n    const kWhiteColorData = new Float32Array([255, 255, 255, 255]);\n\n    const blendComponent = { srcFactor: 'constant', dstFactor: 'one', operation: 'add' } as const;\n    const testPipeline = t.createRenderPipelineForTest({\n      format,\n      blend: { color: blendComponent, alpha: blendComponent },\n    });\n\n    const renderTarget = t.createTextureTracked({\n      usage: GPUTextureUsage.RENDER_ATTACHMENT | GPUTextureUsage.COPY_SRC,\n      size: [kSize, kSize],\n      format,\n    });\n\n    const commandEncoder = t.device.createCommandEncoder();\n    const renderPass = commandEncoder.beginRenderPass({\n      colorAttachments: [\n        {\n          view: renderTarget.createView(),\n          loadOp: 'load',\n          storeOp: 'store',\n        },\n      ],\n    });\n    renderPass.setPipeline(testPipeline);\n    renderPass.setBindGroup(\n      0,\n      t.createBindGroupForTest(testPipeline.getBindGroupLayout(0), kWhiteColorData)\n    );\n    renderPass.draw(3);\n    // Draw [1,1,1,1] with `src * constant + dst * 1`.\n    // The blend constant defaults to [0,0,0,0], so the result is\n    // `[1,1,1,1] * [0,0,0,0] + [0,0,0,0] * 1` = [0,0,0,0].\n    renderPass.end();\n    t.device.queue.submit([commandEncoder.finish()]);\n\n    // Check that the initial blend constant is black(0,0,0,0) after setting testPipeline which has\n    // a white color buffer data.\n    const expColor = { R: 0, G: 0, B: 0, A: 0 };\n    const expTexelView = TexelView.fromTexelsAsColors(format, _coords => expColor);\n    t.expectTexelViewComparisonIsOkInTexture({ texture: renderTarget }, expTexelView, [\n      kSize,\n      kSize,\n    ]);\n  });\n\ng.test('blend_constant,setting')\n  .desc(`Test that setting the blend constant to the RGBA values works at the beginning of a pass.`)\n  .paramsSubcasesOnly([\n    { r: 1.0, g: 1.0, b: 1.0, a: 1.0 },\n    { r: 0.5, g: 1.0, b: 0.5, a: 0.0 },\n    { r: 0.0, g: 0.0, b: 0.0, a: 0.0 },\n  ])\n  .fn(t => {\n    const { r, g, b, a } = t.params;\n\n    const format = 'rgba8unorm';\n    const kSize = 1;\n    const kWhiteColorData = new Float32Array([255, 255, 255, 255]);\n\n    const blendComponent = { srcFactor: 'constant', dstFactor: 'one', operation: 'add' } as const;\n    const testPipeline = t.createRenderPipelineForTest({\n      format,\n      blend: { color: blendComponent, alpha: blendComponent },\n    });\n\n    const renderTarget = t.createTextureTracked({\n      usage: GPUTextureUsage.RENDER_ATTACHMENT | GPUTextureUsage.COPY_SRC,\n      size: [kSize, kSize],\n      format,\n    });\n\n    const commandEncoder = t.device.createCommandEncoder();\n    const renderPass = commandEncoder.beginRenderPass({\n      colorAttachments: [\n        {\n          view: renderTarget.createView(),\n          loadOp: 'load',\n          storeOp: 'store',\n        },\n      ],\n    });\n    renderPass.setPipeline(testPipeline);\n    renderPass.setBlendConstant({ r, g, b, a });\n    renderPass.setBindGroup(\n      0,\n      t.createBindGroupForTest(testPipeline.getBindGroupLayout(0), kWhiteColorData)\n    );\n    renderPass.draw(3);\n    // Draw [1,1,1,1] with `src * constant + dst * 1`. The blend constant to [r,g,b,a], so the\n    // result is `[1,1,1,1] * [r,g,b,a] + [0,0,0,0] * 1` = [r,g,b,a].\n    renderPass.end();\n    t.device.queue.submit([commandEncoder.finish()]);\n\n    // Check that the blend constant is the same as the given constant after setting the constant\n    // via setBlendConstant.\n    const expColor = { R: r, G: g, B: b, A: a };\n    const expTexelView = TexelView.fromTexelsAsColors(format, _coords => expColor);\n\n    t.expectTexelViewComparisonIsOkInTexture({ texture: renderTarget }, expTexelView, [\n      kSize,\n      kSize,\n    ]);\n  });\n\ng.test('blend_constant,not_inherited')\n  .desc(`Test that the blending constant is not inherited between render passes.`)\n  .fn(t => {\n    const format = 'rgba8unorm';\n    const kSize = 1;\n    const kWhiteColorData = new Float32Array([255, 255, 255, 255]);\n\n    const blendComponent = { srcFactor: 'constant', dstFactor: 'one', operation: 'add' } as const;\n    const testPipeline = t.createRenderPipelineForTest({\n      format,\n      blend: { color: blendComponent, alpha: blendComponent },\n    });\n\n    const renderTarget = t.createTextureTracked({\n      usage: GPUTextureUsage.RENDER_ATTACHMENT | GPUTextureUsage.COPY_SRC,\n      size: [kSize, kSize],\n      format,\n    });\n\n    const commandEncoder = t.device.createCommandEncoder();\n    {\n      const renderPass = commandEncoder.beginRenderPass({\n        colorAttachments: [\n          {\n            view: renderTarget.createView(),\n            loadOp: 'load',\n            storeOp: 'store',\n          },\n        ],\n      });\n      renderPass.setPipeline(testPipeline);\n      renderPass.setBlendConstant({ r: 1.0, g: 1.0, b: 1.0, a: 1.0 }); // Set to white color.\n      renderPass.setBindGroup(\n        0,\n        t.createBindGroupForTest(testPipeline.getBindGroupLayout(0), kWhiteColorData)\n      );\n      renderPass.draw(3);\n      // Draw [1,1,1,1] with `src * constant + dst * 1`. The blend constant to [1,1,1,1], so the\n      // result is `[1,1,1,1] * [1,1,1,1] + [0,0,0,0] * 1` = [1,1,1,1].\n      renderPass.end();\n    }\n    {\n      const renderPass = commandEncoder.beginRenderPass({\n        colorAttachments: [\n          {\n            view: renderTarget.createView(),\n            loadOp: 'clear',\n            storeOp: 'store',\n          },\n        ],\n      });\n      renderPass.setPipeline(testPipeline);\n      renderPass.setBindGroup(\n        0,\n        t.createBindGroupForTest(testPipeline.getBindGroupLayout(0), kWhiteColorData)\n      );\n      renderPass.draw(3);\n      // Draw [1,1,1,1] with `src * constant + dst * 1`. The blend constant defaults to [0,0,0,0],\n      // so the result is `[1,1,1,1] * [0,0,0,0] + [0,0,0,0] * 1` = [0,0,0,0].\n      renderPass.end();\n    }\n    t.device.queue.submit([commandEncoder.finish()]);\n\n    // Check that the blend constant is not inherited from the first render pass.\n    const expColor = { R: 0, G: 0, B: 0, A: 0 };\n    const expTexelView = TexelView.fromTexelsAsColors(format, _coords => expColor);\n\n    t.expectTexelViewComparisonIsOkInTexture({ texture: renderTarget }, expTexelView, [\n      kSize,\n      kSize,\n    ]);\n  });\n\nconst kColorWriteCombinations: readonly GPUColorWriteFlags[] = [\n  0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15,\n];\n\ng.test('color_write_mask,channel_work')\n  .desc(\n    `\n  Test that the color write mask works with the zero channel, a single channel, multiple channels,\n  and all channels.\n  `\n  )\n  .params(u =>\n    u //\n      .combine('mask', kColorWriteCombinations)\n  )\n  .fn(t => {\n    const { mask } = t.params;\n\n    const format = 'rgba8unorm';\n    const kSize = 1;\n\n    let r = 0,\n      g = 0,\n      b = 0,\n      a = 0;\n    if (mask & GPUConst.ColorWrite.RED) {\n      r = 1;\n    }\n    if (mask & GPUConst.ColorWrite.GREEN) {\n      g = 1;\n    }\n    if (mask & GPUConst.ColorWrite.BLUE) {\n      b = 1;\n    }\n    if (mask & GPUConst.ColorWrite.ALPHA) {\n      a = 1;\n    }\n\n    const testPipeline = t.createRenderPipelineForTest({\n      format,\n      writeMask: mask,\n    });\n\n    const renderTarget = t.createTextureTracked({\n      usage: GPUTextureUsage.RENDER_ATTACHMENT | GPUTextureUsage.COPY_SRC,\n      size: [kSize, kSize],\n      format,\n    });\n\n    const kBaseColorData = new Float32Array([32, 64, 128, 192]);\n\n    const commandEncoder = t.device.createCommandEncoder();\n    {\n      const renderPass = commandEncoder.beginRenderPass({\n        colorAttachments: [\n          {\n            view: renderTarget.createView(),\n            loadOp: 'load',\n            storeOp: 'store',\n          },\n        ],\n      });\n      renderPass.setPipeline(testPipeline);\n      renderPass.setBindGroup(\n        0,\n        t.createBindGroupForTest(testPipeline.getBindGroupLayout(0), kBaseColorData)\n      );\n      renderPass.draw(3);\n      renderPass.end();\n    }\n    t.device.queue.submit([commandEncoder.finish()]);\n\n    const expColor = { R: r, G: g, B: b, A: a };\n    const expTexelView = TexelView.fromTexelsAsColors(format, _coords => expColor);\n\n    t.expectTexelViewComparisonIsOkInTexture({ texture: renderTarget }, expTexelView, [\n      kSize,\n      kSize,\n    ]);\n  });\n\ng.test('color_write_mask,blending_disabled')\n  .desc(\n    `Test that the color write mask works when blending is disabled or set to the defaults\n  (which has the same blending result).`\n  )\n  .params(u => u.combine('disabled', [false, true]))\n  .fn(t => {\n    const format = 'rgba8unorm';\n    const kSize = 1;\n\n    const blend = t.params.disabled ? undefined : { color: {}, alpha: {} };\n\n    const testPipeline = t.createRenderPipelineForTest({\n      format,\n      blend,\n      writeMask: GPUColorWrite.RED,\n    });\n\n    const renderTarget = t.createTextureTracked({\n      usage: GPUTextureUsage.RENDER_ATTACHMENT | GPUTextureUsage.COPY_SRC,\n      size: [kSize, kSize],\n      format,\n    });\n\n    const kBaseColorData = new Float32Array([32, 64, 128, 192]);\n\n    const commandEncoder = t.device.createCommandEncoder();\n    {\n      const renderPass = commandEncoder.beginRenderPass({\n        colorAttachments: [\n          {\n            view: renderTarget.createView(),\n            loadOp: 'load',\n            storeOp: 'store',\n          },\n        ],\n      });\n      renderPass.setPipeline(testPipeline);\n      renderPass.setBindGroup(\n        0,\n        t.createBindGroupForTest(testPipeline.getBindGroupLayout(0), kBaseColorData)\n      );\n      // Draw [1,1,1,1] with `src * 1 + dst * 0`. So the\n      // result is `[1,1,1,1] * [1,1,1,1] + [0,0,0,0] * 0` = [1,1,1,1].\n      renderPass.draw(3);\n      renderPass.end();\n    }\n    t.device.queue.submit([commandEncoder.finish()]);\n\n    const expColor = { R: 1, G: 0, B: 0, A: 0 };\n    const expTexelView = TexelView.fromTexelsAsColors(format, _coords => expColor);\n\n    t.expectTexelViewComparisonIsOkInTexture({ texture: renderTarget }, expTexelView, [\n      kSize,\n      kSize,\n    ]);\n  });\n\ng.test('blending,clamping')\n  .desc(\n    `\n  Test that clamping occurs at the correct points in the blend process: src value, src factor, dst\n  factor, and output.\n    - TODO: Need to test snorm formats.\n    - TODO: Need to test src value, srcFactor and dstFactor.\n  `\n  )\n  .params(u =>\n    u //\n      .combine('format', ['rgba8unorm', 'rg16float'] as const)\n      .combine('srcValue', [0.4, 0.6, 0.8, 1.0])\n      .combine('dstValue', [0.2, 0.4])\n  )\n  .fn(t => {\n    const { format, srcValue, dstValue } = t.params;\n\n    const blendComponent = { srcFactor: 'one', dstFactor: 'one', operation: 'add' } as const;\n\n    const pipeline = t.device.createRenderPipeline({\n      layout: 'auto',\n      fragment: {\n        targets: [\n          {\n            format,\n            blend: {\n              color: blendComponent,\n              alpha: blendComponent,\n            },\n          },\n        ],\n        module: t.device.createShaderModule({\n          code: `\n@fragment fn main() -> @location(0) vec4<f32> {\n  return vec4<f32>(${srcValue}, ${srcValue}, ${srcValue}, ${srcValue});\n}\n          `,\n        }),\n        entryPoint: 'main',\n      },\n      vertex: {\n        module: t.device.createShaderModule({\n          code: `\n@vertex fn main() -> @builtin(position) vec4<f32> {\n    return vec4<f32>(0.0, 0.0, 0.0, 1.0);\n}\n          `,\n        }),\n        entryPoint: 'main',\n      },\n      primitive: {\n        topology: 'point-list',\n      },\n    });\n\n    const renderTarget = t.createTextureTracked({\n      usage: GPUTextureUsage.RENDER_ATTACHMENT | GPUTextureUsage.COPY_SRC,\n      size: [1, 1, 1],\n      format,\n    });\n\n    const commandEncoder = t.device.createCommandEncoder();\n    const renderPass = commandEncoder.beginRenderPass({\n      colorAttachments: [\n        {\n          view: renderTarget.createView(),\n          clearValue: { r: dstValue, g: dstValue, b: dstValue, a: dstValue },\n          loadOp: 'clear',\n          storeOp: 'store',\n        },\n      ],\n    });\n    renderPass.setPipeline(pipeline);\n    renderPass.draw(1);\n    renderPass.end();\n    t.device.queue.submit([commandEncoder.finish()]);\n\n    let expValue: number;\n    switch (format) {\n      case 'rgba8unorm': // unorm types should clamp if the sum of srcValue and dstValue exceeds 1.\n        expValue = clamp(srcValue + dstValue, { min: 0, max: 1 });\n        break;\n      case 'rg16float': // float format types doesn't clamp.\n        expValue = srcValue + dstValue;\n        break;\n    }\n\n    const expColor = { R: expValue, G: expValue, B: expValue, A: expValue };\n    const expTexelView = TexelView.fromTexelsAsColors(format, _coords => expColor);\n\n    t.expectTexelViewComparisonIsOkInTexture({ texture: renderTarget }, expTexelView, [1, 1, 1]);\n  });\n"],"mappings":"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"}