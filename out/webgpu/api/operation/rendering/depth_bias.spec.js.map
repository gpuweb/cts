{"version":3,"file":"depth_bias.spec.js","names":["description","makeTestGroup","unreachable","isDepthTextureFormat","isStencilTextureFormat","AllFeaturesMaxLimitsGPUTest","ttu","TexelView","QuadAngle","kPointTwoFiveBiasForPointTwoFiveZOnFloat","DepthBiasTest","runDepthBiasTestInternal","depthFormat","quadAngle","bias","biasSlopeScale","biasClamp","initialDepth","renderTargetFormat","vertexShaderCode","Flat","TiltedX","renderTarget","createTextureTracked","format","size","width","height","depthOrArrayLayers","usage","GPUTextureUsage","COPY_SRC","RENDER_ATTACHMENT","depthTexture","sampleCount","mipLevelCount","depthStencilAttachment","view","createView","depthLoadOp","undefined","depthStoreOp","stencilLoadOp","stencilStoreOp","depthClearValue","encoder","device","createCommandEncoder","pass","beginRenderPass","colorAttachments","loadOp","storeOp","depthCompare","testState","depthWriteEnabled","depthBias","depthBiasSlopeScale","depthBiasClamp","testPipeline","createRenderPipelineForTest","setPipeline","draw","end","queue","submit","finish","runDepthBiasTest","_expectedDepth","expColor","Depth","expTexelView","fromTexelsAsColors","_coords","expectTexelViewComparisonIsOkInTexture","texture","runDepthBiasTestFor24BitFormat","_expectedColor","R","G","B","A","vertex","depthStencil","createRenderPipeline","layout","module","createShaderModule","code","entryPoint","fragment","targets","g","test","desc","params","u","combineWithParams","beforeAllSubcases","t","skipIf","isCompatibility","fn","combine","Float32Array"],"sources":["../../../../../src/webgpu/api/operation/rendering/depth_bias.spec.ts"],"sourcesContent":["export const description = `\nTests render results with different depth bias values like 'positive', 'negative',\n'slope', 'clamp', etc.\n`;\n\nimport { makeTestGroup } from '../../../../common/framework/test_group.js';\nimport { unreachable } from '../../../../common/util/util.js';\nimport {\n  DepthStencilFormat,\n  EncodableTextureFormat,\n  isDepthTextureFormat,\n  isStencilTextureFormat,\n} from '../../../format_info.js';\nimport { AllFeaturesMaxLimitsGPUTest } from '../../../gpu_test.js';\nimport * as ttu from '../../../texture_test_utils.js';\nimport { TexelView } from '../../../util/texture/texel_view.js';\n\nenum QuadAngle {\n  Flat,\n  TiltedX,\n}\n\n// Floating point depth buffers use the following formula to calculate bias\n// bias = depthBias * 2 ** (exponent(max z of primitive) - number of bits in mantissa) +\n//        slopeScale * maxSlope\n// https://docs.microsoft.com/en-us/windows/win32/direct3d11/d3d10-graphics-programming-guide-output-merger-stage-depth-bias\n// https://www.khronos.org/registry/vulkan/specs/1.2-extensions/man/html/vkCmdSetDepthBias.html\n// https://developer.apple.com/documentation/metal/mtlrendercommandencoder/1516269-setdepthbias\n//\n// To get a final bias of 0.25 for primitives with z = 0.25, we can use\n// depthBias = 0.25 / (2 ** (-2 - 23)) = 8388608.\nconst kPointTwoFiveBiasForPointTwoFiveZOnFloat = 8388608;\n\nclass DepthBiasTest extends AllFeaturesMaxLimitsGPUTest {\n  runDepthBiasTestInternal(\n    depthFormat: DepthStencilFormat,\n    {\n      quadAngle,\n      bias,\n      biasSlopeScale,\n      biasClamp,\n      initialDepth,\n    }: {\n      quadAngle: QuadAngle;\n      bias: number;\n      biasSlopeScale: number;\n      biasClamp: number;\n      initialDepth: number;\n    }\n  ): { renderTarget: GPUTexture; depthTexture: GPUTexture } {\n    const renderTargetFormat = 'rgba8unorm';\n\n    let vertexShaderCode: string;\n    switch (quadAngle) {\n      case QuadAngle.Flat:\n        // Draw a square at z = 0.25.\n        vertexShaderCode = `\n          @vertex\n          fn main(@builtin(vertex_index) VertexIndex : u32) -> @builtin(position) vec4<f32> {\n            var pos = array<vec2<f32>, 6>(\n            vec2<f32>(-1.0, -1.0),\n            vec2<f32>( 1.0, -1.0),\n            vec2<f32>(-1.0,  1.0),\n            vec2<f32>(-1.0,  1.0),\n            vec2<f32>( 1.0, -1.0),\n            vec2<f32>( 1.0,  1.0));\n            return vec4<f32>(pos[VertexIndex], 0.25, 1.0);\n          }\n          `;\n        break;\n      case QuadAngle.TiltedX:\n        // Draw a square ranging from 0 to 0.5, bottom to top.\n        vertexShaderCode = `\n          @vertex\n          fn main(@builtin(vertex_index) VertexIndex : u32) -> @builtin(position) vec4<f32> {\n            var pos = array<vec3<f32>, 6>(\n            vec3<f32>(-1.0, -1.0, 0.0),\n            vec3<f32>( 1.0, -1.0, 0.0),\n            vec3<f32>(-1.0,  1.0, 0.5),\n            vec3<f32>(-1.0,  1.0, 0.5),\n            vec3<f32>( 1.0, -1.0, 0.0),\n            vec3<f32>( 1.0,  1.0, 0.5));\n            return vec4<f32>(pos[VertexIndex], 1.0);\n          }\n          `;\n        break;\n      default:\n        unreachable();\n    }\n\n    const renderTarget = this.createTextureTracked({\n      format: renderTargetFormat,\n      size: { width: 1, height: 1, depthOrArrayLayers: 1 },\n      usage: GPUTextureUsage.COPY_SRC | GPUTextureUsage.RENDER_ATTACHMENT,\n    });\n\n    const depthTexture = this.createTextureTracked({\n      size: { width: 1, height: 1, depthOrArrayLayers: 1 },\n      format: depthFormat,\n      sampleCount: 1,\n      mipLevelCount: 1,\n      usage: GPUTextureUsage.RENDER_ATTACHMENT | GPUTextureUsage.COPY_SRC,\n    });\n\n    const depthStencilAttachment: GPURenderPassDepthStencilAttachment = {\n      view: depthTexture.createView(),\n      depthLoadOp: isDepthTextureFormat(depthFormat) ? 'clear' : undefined,\n      depthStoreOp: isDepthTextureFormat(depthFormat) ? 'store' : undefined,\n      stencilLoadOp: isStencilTextureFormat(depthFormat) ? 'clear' : undefined,\n      stencilStoreOp: isStencilTextureFormat(depthFormat) ? 'store' : undefined,\n      depthClearValue: initialDepth,\n    };\n\n    const encoder = this.device.createCommandEncoder();\n    const pass = encoder.beginRenderPass({\n      colorAttachments: [\n        {\n          view: renderTarget.createView(),\n          loadOp: 'load',\n          storeOp: 'store',\n        },\n      ],\n      depthStencilAttachment,\n    });\n\n    let depthCompare: GPUCompareFunction = 'always';\n    if (depthFormat !== 'depth32float') {\n      depthCompare = 'greater';\n    }\n\n    const testState = {\n      format: depthFormat,\n      depthCompare,\n      depthWriteEnabled: true,\n      depthBias: bias,\n      depthBiasSlopeScale: biasSlopeScale,\n      depthBiasClamp: biasClamp,\n    } as const;\n\n    // Draw a square with the given depth state and bias values.\n    const testPipeline = this.createRenderPipelineForTest(vertexShaderCode, testState);\n    pass.setPipeline(testPipeline);\n    pass.draw(6);\n    pass.end();\n    this.device.queue.submit([encoder.finish()]);\n\n    return { renderTarget, depthTexture };\n  }\n\n  runDepthBiasTest(\n    depthFormat: EncodableTextureFormat & DepthStencilFormat,\n    {\n      quadAngle,\n      bias,\n      biasSlopeScale,\n      biasClamp,\n      _expectedDepth,\n    }: {\n      quadAngle: QuadAngle;\n      bias: number;\n      biasSlopeScale: number;\n      biasClamp: number;\n      _expectedDepth: number;\n    }\n  ) {\n    const { depthTexture } = this.runDepthBiasTestInternal(depthFormat, {\n      quadAngle,\n      bias,\n      biasSlopeScale,\n      biasClamp,\n      initialDepth: 0,\n    });\n\n    const expColor = { Depth: _expectedDepth };\n    const expTexelView = TexelView.fromTexelsAsColors(depthFormat, _coords => expColor);\n    ttu.expectTexelViewComparisonIsOkInTexture(\n      this,\n      { texture: depthTexture },\n      expTexelView,\n      [1, 1]\n    );\n  }\n\n  runDepthBiasTestFor24BitFormat(\n    depthFormat: DepthStencilFormat,\n    {\n      quadAngle,\n      bias,\n      biasSlopeScale,\n      biasClamp,\n      _expectedColor,\n    }: {\n      quadAngle: QuadAngle;\n      bias: number;\n      biasSlopeScale: number;\n      biasClamp: number;\n      _expectedColor: Float32Array;\n    }\n  ) {\n    const { renderTarget } = this.runDepthBiasTestInternal(depthFormat, {\n      quadAngle,\n      bias,\n      biasSlopeScale,\n      biasClamp,\n      initialDepth: 0.4,\n    });\n\n    const renderTargetFormat = 'rgba8unorm';\n    const expColor = {\n      R: _expectedColor[0],\n      G: _expectedColor[1],\n      B: _expectedColor[2],\n      A: _expectedColor[3],\n    };\n    const expTexelView = TexelView.fromTexelsAsColors(renderTargetFormat, _coords => expColor);\n    ttu.expectTexelViewComparisonIsOkInTexture(\n      this,\n      { texture: renderTarget },\n      expTexelView,\n      [1, 1]\n    );\n  }\n\n  createRenderPipelineForTest(\n    vertex: string,\n    depthStencil: GPUDepthStencilState\n  ): GPURenderPipeline {\n    return this.device.createRenderPipeline({\n      layout: 'auto',\n      vertex: {\n        module: this.device.createShaderModule({\n          code: vertex,\n        }),\n        entryPoint: 'main',\n      },\n      fragment: {\n        targets: [{ format: 'rgba8unorm' }],\n        module: this.device.createShaderModule({\n          code: `\n            @fragment fn main() -> @location(0) vec4<f32> {\n              return vec4<f32>(1.0, 0.0, 0.0, 1.0);\n            }`,\n        }),\n        entryPoint: 'main',\n      },\n      depthStencil,\n    });\n  }\n}\n\nexport const g = makeTestGroup(DepthBiasTest);\n\ng.test('depth_bias')\n  .desc(\n    `\n  Tests that a square with different depth bias values like 'positive', 'negative',\n  'slope', 'clamp', etc. is drawn as expected.\n  `\n  )\n  .params(u =>\n    u //\n      .combineWithParams([\n        {\n          quadAngle: QuadAngle.Flat,\n          bias: kPointTwoFiveBiasForPointTwoFiveZOnFloat,\n          biasSlopeScale: 0,\n          biasClamp: 0,\n          _expectedDepth: 0.5,\n        },\n        {\n          quadAngle: QuadAngle.Flat,\n          bias: kPointTwoFiveBiasForPointTwoFiveZOnFloat,\n          biasSlopeScale: 0,\n          biasClamp: 0.125,\n          _expectedDepth: 0.375,\n        },\n        {\n          quadAngle: QuadAngle.Flat,\n          bias: -kPointTwoFiveBiasForPointTwoFiveZOnFloat,\n          biasSlopeScale: 0,\n          biasClamp: 0.125,\n          _expectedDepth: 0,\n        },\n        {\n          quadAngle: QuadAngle.Flat,\n          bias: -kPointTwoFiveBiasForPointTwoFiveZOnFloat,\n          biasSlopeScale: 0,\n          biasClamp: -0.125,\n          _expectedDepth: 0.125,\n        },\n        {\n          quadAngle: QuadAngle.TiltedX,\n          bias: 0,\n          biasSlopeScale: 0,\n          biasClamp: 0,\n          _expectedDepth: 0.25,\n        },\n        {\n          quadAngle: QuadAngle.TiltedX,\n          bias: 0,\n          biasSlopeScale: 1,\n          biasClamp: 0,\n          _expectedDepth: 0.75,\n        },\n        {\n          quadAngle: QuadAngle.TiltedX,\n          bias: 0,\n          biasSlopeScale: -0.5,\n          biasClamp: 0,\n          _expectedDepth: 0,\n        },\n      ] as const)\n  )\n  .beforeAllSubcases(t => {\n    t.skipIf(\n      t.isCompatibility && t.params.biasClamp !== 0,\n      'non zero depthBiasClamp is not supported in compatibility mode'\n    );\n  })\n  .fn(t => {\n    t.runDepthBiasTest('depth32float', t.params);\n  });\n\ng.test('depth_bias_24bit_format')\n  .desc(\n    `\n  Tests that a square with different depth bias values like 'positive', 'negative',\n  'slope', 'clamp', etc. is drawn as expected with 24 bit depth format.\n\n  TODO: Enhance these tests by reading back the depth (emulating the copy using texture sampling)\n  and checking the result directly, like the non-24-bit depth tests, instead of just relying on\n  whether the depth test passes or fails.\n  `\n  )\n  .params(u =>\n    u //\n      .combine('format', ['depth24plus', 'depth24plus-stencil8'] as const)\n      .combineWithParams([\n        {\n          quadAngle: QuadAngle.Flat,\n          bias: 0.25 * (1 << 25),\n          biasSlopeScale: 0,\n          biasClamp: 0,\n          _expectedColor: new Float32Array([1.0, 0.0, 0.0, 1.0]),\n        },\n        {\n          quadAngle: QuadAngle.TiltedX,\n          bias: 0.25 * (1 << 25),\n          biasSlopeScale: 1,\n          biasClamp: 0,\n          _expectedColor: new Float32Array([1.0, 0.0, 0.0, 1.0]),\n        },\n        {\n          quadAngle: QuadAngle.Flat,\n          bias: 0.25 * (1 << 25),\n          biasSlopeScale: 0,\n          biasClamp: 0.1,\n          _expectedColor: new Float32Array([0.0, 0.0, 0.0, 0.0]),\n        },\n      ] as const)\n  )\n  .beforeAllSubcases(t => {\n    t.skipIf(\n      t.isCompatibility && t.params.biasClamp !== 0,\n      'non zero depthBiasClamp is not supported in compatibility mode'\n    );\n  })\n  .fn(t => {\n    const { format } = t.params;\n    t.runDepthBiasTestFor24BitFormat(format, t.params);\n  });\n"],"mappings":"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"}