{"version":3,"file":"mapping_test.js","names":["assert","AllFeaturesMaxLimitsGPUTest","MappingTest","checkMapWrite","buffer","offset","mappedContents","size","checkMapWriteZeroed","mappedView","Uint32Array","expected","ArrayBuffer","byteLength","i","length","unmap","expectGPUBufferValuesEqual","arrayBuffer","expectedSize","expect","view","Uint8Array","expectZero","actual","fail"],"sources":["../../../../../src/webgpu/api/operation/buffers/mapping_test.ts"],"sourcesContent":["import { assert } from '../../../../common/util/util.js';\nimport { AllFeaturesMaxLimitsGPUTest } from '../../../gpu_test.js';\n\nexport class MappingTest extends AllFeaturesMaxLimitsGPUTest {\n  checkMapWrite(\n    buffer: GPUBuffer,\n    offset: number,\n    mappedContents: ArrayBuffer,\n    size: number\n  ): void {\n    this.checkMapWriteZeroed(mappedContents, size);\n\n    const mappedView = new Uint32Array(mappedContents);\n    const expected = new Uint32Array(new ArrayBuffer(size));\n    assert(mappedView.byteLength === size);\n    for (let i = 0; i < mappedView.length; ++i) {\n      mappedView[i] = expected[i] = i + 1;\n    }\n    buffer.unmap();\n\n    this.expectGPUBufferValuesEqual(buffer, expected, offset);\n  }\n\n  checkMapWriteZeroed(arrayBuffer: ArrayBuffer, expectedSize: number): void {\n    this.expect(arrayBuffer.byteLength === expectedSize);\n    const view = new Uint8Array(arrayBuffer);\n    this.expectZero(view);\n  }\n\n  expectZero(actual: Uint8Array): void {\n    const size = actual.byteLength;\n    for (let i = 0; i < size; ++i) {\n      if (actual[i] !== 0) {\n        this.fail(`at [${i}], expected zero, got ${actual[i]}`);\n        break;\n      }\n    }\n  }\n}\n"],"mappings":";;GAAA,SAASA,MAAM,QAAQ,iCAAiC,CACxD,SAASC,2BAA2B,QAAQ,sBAAsB;AAElE,OAAO,MAAMC,WAAW,SAASD,2BAA2B,CAAC;EAC3DE,aAAaA;EACXC,MAAiB;EACjBC,MAAc;EACdC,cAA2B;EAC3BC,IAAY;EACN;IACN,IAAI,CAACC,mBAAmB,CAACF,cAAc,EAAEC,IAAI,CAAC;;IAE9C,MAAME,UAAU,GAAG,IAAIC,WAAW,CAACJ,cAAc,CAAC;IAClD,MAAMK,QAAQ,GAAG,IAAID,WAAW,CAAC,IAAIE,WAAW,CAACL,IAAI,CAAC,CAAC;IACvDP,MAAM,CAACS,UAAU,CAACI,UAAU,KAAKN,IAAI,CAAC;IACtC,KAAK,IAAIO,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGL,UAAU,CAACM,MAAM,EAAE,EAAED,CAAC,EAAE;MAC1CL,UAAU,CAACK,CAAC,CAAC,GAAGH,QAAQ,CAACG,CAAC,CAAC,GAAGA,CAAC,GAAG,CAAC;IACrC;IACAV,MAAM,CAACY,KAAK,CAAC,CAAC;;IAEd,IAAI,CAACC,0BAA0B,CAACb,MAAM,EAAEO,QAAQ,EAAEN,MAAM,CAAC;EAC3D;;EAEAG,mBAAmBA,CAACU,WAAwB,EAAEC,YAAoB,EAAQ;IACxE,IAAI,CAACC,MAAM,CAACF,WAAW,CAACL,UAAU,KAAKM,YAAY,CAAC;IACpD,MAAME,IAAI,GAAG,IAAIC,UAAU,CAACJ,WAAW,CAAC;IACxC,IAAI,CAACK,UAAU,CAACF,IAAI,CAAC;EACvB;;EAEAE,UAAUA,CAACC,MAAkB,EAAQ;IACnC,MAAMjB,IAAI,GAAGiB,MAAM,CAACX,UAAU;IAC9B,KAAK,IAAIC,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGP,IAAI,EAAE,EAAEO,CAAC,EAAE;MAC7B,IAAIU,MAAM,CAACV,CAAC,CAAC,KAAK,CAAC,EAAE;QACnB,IAAI,CAACW,IAAI,CAAE,OAAMX,CAAE,yBAAwBU,MAAM,CAACV,CAAC,CAAE,EAAC,CAAC;QACvD;MACF;IACF;EACF;AACF"}