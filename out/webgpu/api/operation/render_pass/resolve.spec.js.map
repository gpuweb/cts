{"version":3,"file":"resolve.spec.js","names":["description","makeTestGroup","isTextureFormatPossiblyResolvable","kColorTextureFormats","AllFeaturesMaxLimitsGPUTest","ttu","kSlotsToResolve","kSize","kDepthStencilFormat","g","test","desc","params","u","combine","filter","t","colorFormat","beginSubcases","unless","transientColorAttachment","separateResolvePass","storeOperation","depthStencilAttachment","transientDepthStencilAttachment","fn","skipIfTextureFormatNotSupported","skipIfTextureFormatNotResolvable","skipIfTransientAttachmentNotSupported","targets","i","numColorAttachments","push","format","depthStencil","depthWriteEnabled","pipeline","device","createRenderPipeline","layout","vertex","module","createShaderModule","code","entryPoint","fragment","primitive","topology","multisample","count","resolveTargets","drawPassAttachments","resolvePassAttachments","kResolveTargetSize","resolveTargetBaseMipLevel","colorAttachment","createTextureTracked","size","sampleCount","mipLevelCount","usage","GPUTextureUsage","RENDER_ATTACHMENT","TRANSIENT_ATTACHMENT","createView","resolveTarget","slotsToResolve","includes","resolveTargetTexture","resolveTargetBaseArrayLayer","COPY_SRC","baseMipLevel","baseArrayLayer","view","clearValue","r","b","a","loadOp","storeOp","depthStencilTexture","depthClearValue","depthLoadOp","depthStoreOp","stencilLoadOp","stencilStoreOp","encoder","createCommandEncoder","pass","beginRenderPass","colorAttachments","setPipeline","draw","end","queue","submit","finish","z","expectSinglePixelComparisonsAreOkInTexture","texture","mipLevel","coord","x","y","exp","R","G","B","A"],"sources":["../../../../../src/webgpu/api/operation/render_pass/resolve.spec.ts"],"sourcesContent":["export const description = `API Operation Tests for multisample resolve in render passes.`;\n\nimport { makeTestGroup } from '../../../../common/framework/test_group.js';\nimport { isTextureFormatPossiblyResolvable, kColorTextureFormats } from '../../../format_info.js';\nimport { AllFeaturesMaxLimitsGPUTest } from '../../../gpu_test.js';\nimport * as ttu from '../../../texture_test_utils.js';\n\nconst kSlotsToResolve = [\n  [0, 2],\n  [1, 3],\n  [0, 1, 2, 3],\n];\n\nconst kSize = 4;\nconst kDepthStencilFormat: GPUTextureFormat = 'depth24plus-stencil8';\n\nexport const g = makeTestGroup(AllFeaturesMaxLimitsGPUTest);\n\ng.test('render_pass_resolve')\n  .desc(\n    `\nTest basic render pass resolve behavior for combinations of:\n  - number of color attachments, some with and some without a resolveTarget\n  - {a single draw+resolve pass, one draw-store pass and one empty load-resolve pass}\n    (attempts to test known driver bugs with empty resolve passes)\n  - in the resolve pass, storeOp set to {'store', 'discard'}\n  - mip levels {0, 1} and array layers {0, 1}\n    TODO: cases where color attachment and resolve target don't have the same mip level\n  - resolveTarget {2d array layer, TODO: 3d slice} {0, >0} with {2d, TODO: 3d} resolveTarget\n    TODO: cases where color attachment and resolve target don't have the same z (slice or layer)\n  - TODO: test that any not-resolved attachments are rendered to correctly.\n  - TODO: test different loadOps\n  - TODO?: resolveTarget mip level {0, >0} (TODO?: different mip level from colorAttachment)\n  - TODO?: resolveTarget {2d array layer, TODO: 3d slice} {0, >0} with {2d, TODO: 3d} resolveTarget\n    (different z from colorAttachment)\n`\n  )\n  .params(u =>\n    u\n      .combine('colorFormat', kColorTextureFormats)\n      .filter(t => isTextureFormatPossiblyResolvable(t.colorFormat))\n      .combine('separateResolvePass', [false, true])\n      .combine('storeOperation', ['discard', 'store'] as const)\n      .beginSubcases()\n      .combine('transientColorAttachment', [false, true])\n      // Exclude if transient AND (separate pass OR storing)\n      .unless(\n        t => t.transientColorAttachment && (t.separateResolvePass || t.storeOperation === 'store')\n      )\n      .combine('numColorAttachments', [2, 4] as const)\n      .combine('slotsToResolve', kSlotsToResolve)\n      .combine('resolveTargetBaseMipLevel', [0, 1] as const)\n      .combine('resolveTargetBaseArrayLayer', [0, 1] as const)\n      .combine('transientDepthStencilAttachment', [false, true])\n      .combine('depthStencilAttachment', [false, true])\n      .unless(t => !t.depthStencilAttachment && t.transientDepthStencilAttachment)\n  )\n  .fn(t => {\n    const { colorFormat } = t.params;\n    t.skipIfTextureFormatNotSupported(colorFormat);\n    t.skipIfTextureFormatNotResolvable(colorFormat);\n    // MAINTENANCE_TODO(#4509): Remove this when TRANSIENT_ATTACHMENT is added to the WebGPU spec.\n    if (t.params.transientColorAttachment || t.params.transientDepthStencilAttachment) {\n      t.skipIfTransientAttachmentNotSupported();\n    }\n\n    const targets: GPUColorTargetState[] = [];\n    for (let i = 0; i < t.params.numColorAttachments; i++) {\n      targets.push({ format: colorFormat });\n    }\n\n    let depthStencil: GPUDepthStencilState | undefined;\n    if (t.params.depthStencilAttachment) {\n      depthStencil = {\n        format: kDepthStencilFormat,\n        depthWriteEnabled: false,\n      };\n    }\n\n    // These shaders will draw a white triangle into a texture. After draw, the top left\n    // half of the texture will be white, and the bottom right half will be unchanged. When this\n    // texture is resolved, there will be two distinct colors in each portion of the texture, as\n    // well as a line between the portions that contain the midpoint color due to the multisample\n    // resolve.\n    const pipeline = t.device.createRenderPipeline({\n      layout: 'auto',\n      vertex: {\n        module: t.device.createShaderModule({\n          code: `\n            @vertex fn main(\n              @builtin(vertex_index) VertexIndex : u32\n              ) -> @builtin(position) vec4<f32> {\n              var pos : array<vec2<f32>, 3> = array<vec2<f32>, 3>(\n                  vec2<f32>(-1.0, -1.0),\n                  vec2<f32>(-1.0,  1.0),\n                  vec2<f32>( 1.0,  1.0));\n              return vec4<f32>(pos[VertexIndex], 0.0, 1.0);\n            }`,\n        }),\n        entryPoint: 'main',\n      },\n      fragment: {\n        module: t.device.createShaderModule({\n          code: `\n            struct Output {\n              @location(0) fragColor0 : vec4<f32>,\n              @location(1) fragColor1 : vec4<f32>,\n              @location(2) fragColor2 : vec4<f32>,\n              @location(3) fragColor3 : vec4<f32>,\n            };\n\n            @fragment fn main() -> Output {\n              return Output(\n                vec4<f32>(1.0, 1.0, 1.0, 1.0),\n                vec4<f32>(1.0, 1.0, 1.0, 1.0),\n                vec4<f32>(1.0, 1.0, 1.0, 1.0),\n                vec4<f32>(1.0, 1.0, 1.0, 1.0)\n              );\n            }`,\n        }),\n        entryPoint: 'main',\n        targets,\n      },\n      depthStencil,\n      primitive: { topology: 'triangle-list' },\n      multisample: { count: 4 },\n    });\n\n    const resolveTargets: GPUTexture[] = [];\n    const drawPassAttachments: GPURenderPassColorAttachment[] = [];\n    const resolvePassAttachments: GPURenderPassColorAttachment[] = [];\n\n    // The resolve target must be the same size as the color attachment. If we're resolving to mip\n    // level 1, the resolve target base mip level should be 2x the color attachment size.\n    const kResolveTargetSize = kSize << t.params.resolveTargetBaseMipLevel;\n\n    for (let i = 0; i < t.params.numColorAttachments; i++) {\n      const colorAttachment = t\n        .createTextureTracked({\n          format: colorFormat,\n          size: [kSize, kSize, 1],\n          sampleCount: 4,\n          mipLevelCount: 1,\n          usage: t.params.transientColorAttachment\n            ? GPUTextureUsage.RENDER_ATTACHMENT | GPUTextureUsage.TRANSIENT_ATTACHMENT\n            : GPUTextureUsage.RENDER_ATTACHMENT,\n        })\n        .createView();\n\n      let resolveTarget: GPUTextureView | undefined;\n      if (t.params.slotsToResolve.includes(i)) {\n        const resolveTargetTexture = t.createTextureTracked({\n          format: colorFormat,\n          size: [kResolveTargetSize, kResolveTargetSize, t.params.resolveTargetBaseArrayLayer + 1],\n          sampleCount: 1,\n          mipLevelCount: t.params.resolveTargetBaseMipLevel + 1,\n          usage: GPUTextureUsage.COPY_SRC | GPUTextureUsage.RENDER_ATTACHMENT,\n        });\n        resolveTargets.push(resolveTargetTexture);\n\n        resolveTarget = resolveTargetTexture.createView({\n          baseMipLevel: t.params.resolveTargetBaseMipLevel,\n          baseArrayLayer: t.params.resolveTargetBaseArrayLayer,\n        });\n      }\n\n      // Clear to black for the load operation. After the draw, the top left half of the attachment\n      // will be white and the bottom right half will be black.\n      if (t.params.separateResolvePass) {\n        drawPassAttachments.push({\n          view: colorAttachment,\n          clearValue: { r: 0.0, g: 0.0, b: 0.0, a: 0.0 },\n          loadOp: 'clear',\n          storeOp: 'store',\n        });\n        resolvePassAttachments.push({\n          view: colorAttachment,\n          resolveTarget,\n          loadOp: 'load',\n          storeOp: t.params.storeOperation,\n        });\n      } else {\n        drawPassAttachments.push({\n          view: colorAttachment,\n          resolveTarget,\n          clearValue: { r: 0.0, g: 0.0, b: 0.0, a: 0.0 },\n          loadOp: 'clear',\n          storeOp: t.params.storeOperation,\n        });\n      }\n    }\n\n    let depthStencilAttachment: GPURenderPassDepthStencilAttachment | undefined;\n    if (t.params.depthStencilAttachment) {\n      const depthStencilTexture = t.createTextureTracked({\n        format: kDepthStencilFormat,\n        size: [kSize, kSize, 1],\n        sampleCount: 4,\n        usage: t.params.transientDepthStencilAttachment\n          ? GPUTextureUsage.RENDER_ATTACHMENT | GPUTextureUsage.TRANSIENT_ATTACHMENT\n          : GPUTextureUsage.RENDER_ATTACHMENT,\n      });\n      depthStencilAttachment = {\n        view: depthStencilTexture.createView(),\n        depthClearValue: 1.0,\n        depthLoadOp: 'clear',\n        depthStoreOp: 'discard',\n        stencilLoadOp: 'clear',\n        stencilStoreOp: 'discard',\n      };\n    }\n\n    const encoder = t.device.createCommandEncoder();\n    const pass = encoder.beginRenderPass({\n      colorAttachments: drawPassAttachments,\n      depthStencilAttachment,\n    });\n    pass.setPipeline(pipeline);\n    pass.draw(3);\n    pass.end();\n    if (t.params.separateResolvePass) {\n      const pass = encoder.beginRenderPass({\n        colorAttachments: resolvePassAttachments,\n        depthStencilAttachment,\n      });\n      pass.end();\n    }\n    t.device.queue.submit([encoder.finish()]);\n\n    // Verify the resolve targets contain the correct values. Note that we use z to specify the\n    // array layer from which to pull the pixels for testing.\n    const z = t.params.resolveTargetBaseArrayLayer;\n    for (const resolveTarget of resolveTargets) {\n      ttu.expectSinglePixelComparisonsAreOkInTexture(\n        t,\n        { texture: resolveTarget, mipLevel: t.params.resolveTargetBaseMipLevel },\n        // Note: Channels that do not exist in the actual texture are not compared.\n        [\n          // Top left pixel should be {1.0, 1.0, 1.0, 1.0}.\n          { coord: { x: 0, y: 0, z }, exp: { R: 1.0, G: 1.0, B: 1.0, A: 1.0 } },\n          // Bottom right pixel should be {0, 0, 0, 0}.\n          { coord: { x: kSize - 1, y: kSize - 1, z }, exp: { R: 0, G: 0, B: 0, A: 0 } },\n          // Top right pixel should be {0.5, 0.5, 0.5, 0.5} due to the multisampled resolve.\n          { coord: { x: kSize - 1, y: 0, z }, exp: { R: 0.5, G: 0.5, B: 0.5, A: 0.5 } },\n        ]\n      );\n    }\n  });\n"],"mappings":"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"}