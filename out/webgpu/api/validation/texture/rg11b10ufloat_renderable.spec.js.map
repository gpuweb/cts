{"version":3,"file":"rg11b10ufloat_renderable.spec.js","names":["description","makeTestGroup","GPUConst","AllFeaturesMaxLimitsValidationTest","g","test","desc","params","u","combine","fn","t","skipIfDeviceDoesNotHaveFeature","sampleCount","descriptor","size","format","usage","TextureUsage","RENDER_ATTACHMENT","createTextureTracked","texture","encoder","device","createCommandEncoder","pass","beginRenderPass","colorAttachments","view","createView","clearValue","r","b","a","loadOp","storeOp","end","finish","renderTexture","resolveTexture","resolveTarget","createRenderBundleEncoder","colorFormats","createRenderPipeline","layout","vertex","module","createShaderModule","code","getNoOpShaderCode","entryPoint","fragment","targets","writeMask","primitive","topology"],"sources":["../../../../../src/webgpu/api/validation/texture/rg11b10ufloat_renderable.spec.ts"],"sourcesContent":["export const description = `\nTests for capabilities added by rg11b10ufloat-renderable flag.\n`;\n\nimport { makeTestGroup } from '../../../../common/framework/test_group.js';\nimport { GPUConst } from '../../../constants.js';\nimport { AllFeaturesMaxLimitsValidationTest } from '../validation_test.js';\n\nexport const g = makeTestGroup(AllFeaturesMaxLimitsValidationTest);\n\ng.test('create_texture')\n  .desc(\n    `\nTest that it is valid to create rg11b10ufloat texture with RENDER_ATTACHMENT usage and/or\nsampleCount > 1, iff rg11b10ufloat-renderable feature is enabled.\nNote, the createTexture tests cover these validation cases where this feature is not enabled.\n`\n  )\n  .params(u => u.combine('sampleCount', [1, 4]))\n  .fn(t => {\n    t.skipIfDeviceDoesNotHaveFeature('rg11b10ufloat-renderable');\n    const { sampleCount } = t.params;\n    const descriptor = {\n      size: [1, 1, 1],\n      format: 'rg11b10ufloat' as const,\n      sampleCount,\n      usage: GPUConst.TextureUsage.RENDER_ATTACHMENT,\n    };\n    t.createTextureTracked(descriptor);\n  });\n\ng.test('begin_render_pass_single_sampled')\n  .desc(\n    `\nTest that it is valid to begin render pass with rg11b10ufloat texture format\niff rg11b10ufloat-renderable feature is enabled. Single sampled case.\n`\n  )\n  .fn(t => {\n    t.skipIfDeviceDoesNotHaveFeature('rg11b10ufloat-renderable');\n    const texture = t.createTextureTracked({\n      size: [1, 1, 1],\n      format: 'rg11b10ufloat',\n      sampleCount: 1,\n      usage: GPUConst.TextureUsage.RENDER_ATTACHMENT,\n    });\n    const encoder = t.device.createCommandEncoder();\n    const pass = encoder.beginRenderPass({\n      colorAttachments: [\n        {\n          view: texture.createView(),\n          clearValue: { r: 1.0, g: 0.0, b: 0.0, a: 1.0 },\n          loadOp: 'clear',\n          storeOp: 'store',\n        },\n      ],\n    });\n    pass.end();\n    encoder.finish();\n  });\n\ng.test('begin_render_pass_msaa_and_resolve')\n  .desc(\n    `\nTest that it is valid to begin render pass with rg11b10ufloat texture format\niff rg11b10ufloat-renderable feature is enabled. MSAA and resolve case.\n`\n  )\n  .fn(t => {\n    t.skipIfDeviceDoesNotHaveFeature('rg11b10ufloat-renderable');\n    const renderTexture = t.createTextureTracked({\n      size: [1, 1, 1],\n      format: 'rg11b10ufloat',\n      sampleCount: 4,\n      usage: GPUConst.TextureUsage.RENDER_ATTACHMENT,\n    });\n    const resolveTexture = t.createTextureTracked({\n      size: [1, 1, 1],\n      format: 'rg11b10ufloat',\n      sampleCount: 1,\n      usage: GPUConst.TextureUsage.RENDER_ATTACHMENT,\n    });\n    const encoder = t.device.createCommandEncoder();\n    const pass = encoder.beginRenderPass({\n      colorAttachments: [\n        {\n          view: renderTexture.createView(),\n          resolveTarget: resolveTexture.createView(),\n          clearValue: { r: 1.0, g: 0.0, b: 0.0, a: 1.0 },\n          loadOp: 'clear',\n          storeOp: 'store',\n        },\n      ],\n    });\n    pass.end();\n    encoder.finish();\n  });\n\ng.test('begin_render_bundle_encoder')\n  .desc(\n    `\nTest that it is valid to begin render bundle encoder with rg11b10ufloat texture\nformat iff rg11b10ufloat-renderable feature is enabled.\n`\n  )\n  .fn(t => {\n    t.skipIfDeviceDoesNotHaveFeature('rg11b10ufloat-renderable');\n    t.device.createRenderBundleEncoder({\n      colorFormats: ['rg11b10ufloat'],\n    });\n  });\n\ng.test('create_render_pipeline')\n  .desc(\n    `\nTest that it is valid to create render pipeline with rg11b10ufloat texture format\nin descriptor.fragment.targets iff rg11b10ufloat-renderable feature is enabled.\n`\n  )\n  .fn(t => {\n    t.skipIfDeviceDoesNotHaveFeature('rg11b10ufloat-renderable');\n    t.device.createRenderPipeline({\n      layout: 'auto',\n      vertex: {\n        module: t.device.createShaderModule({\n          code: t.getNoOpShaderCode('VERTEX'),\n        }),\n        entryPoint: 'main',\n      },\n      fragment: {\n        module: t.device.createShaderModule({\n          code: t.getNoOpShaderCode('FRAGMENT'),\n        }),\n        entryPoint: 'main',\n        targets: [{ format: 'rg11b10ufloat', writeMask: 0 }],\n      },\n      primitive: { topology: 'triangle-list' },\n    });\n  });\n"],"mappings":"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"}