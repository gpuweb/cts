{"version":3,"file":"depth_stencil_state.spec.js","names":["description","makeTestGroup","unreachable","kCompareFunctions","kPrimitiveTopology","kStencilOperations","kAllTextureFormats","kDepthStencilFormats","isDepthOrStencilTextureFormat","isDepthTextureFormat","isStencilTextureFormat","getFragmentShaderCodeWithOutput","vtu","CreateRenderPipelineValidationTest","g","test","desc","params","u","combine","fn","t","isAsync","format","skipIfTextureFormatNotSupported","descriptor","getDescriptor","depthStencil","depthWriteEnabled","depthCompare","doCreateRenderPipelineTest","beginSubcases","undefined","stencilFrontDepthFailOp","stencilBackDepthFailOp","stencilFront","depthFailOp","stencilBack","depthFailOpsAreKeep","stencilStateIsDefault","success","depthTestEnabled","targets","fragmentShaderCode","values","plainType","componentCount","value","hasDepth","combineWithParams","depthBias","depthBiasSlopeScale","depthBiasClamp","topology","isCompatibility","skip","isTriangleTopology","hasDepthBias","shouldSucceed","primitive","face","compare","stencilTestEnabled","faceAndOpType","op","common","failOp","passOp","stencilWriteEnabled"],"sources":["../../../../../src/webgpu/api/validation/render_pipeline/depth_stencil_state.spec.ts"],"sourcesContent":["export const description = `\nThis test dedicatedly tests validation of GPUDepthStencilState of createRenderPipeline.\n`;\n\nimport { makeTestGroup } from '../../../../common/framework/test_group.js';\nimport { unreachable } from '../../../../common/util/util.js';\nimport {\n  kCompareFunctions,\n  kPrimitiveTopology,\n  kStencilOperations,\n} from '../../../capability_info.js';\nimport {\n  kAllTextureFormats,\n  kDepthStencilFormats,\n  isDepthOrStencilTextureFormat,\n  isDepthTextureFormat,\n  isStencilTextureFormat,\n} from '../../../format_info.js';\nimport { getFragmentShaderCodeWithOutput } from '../../../util/shader.js';\nimport * as vtu from '../validation_test_utils.js';\n\nimport { CreateRenderPipelineValidationTest } from './common.js';\n\nexport const g = makeTestGroup(CreateRenderPipelineValidationTest);\n\ng.test('format')\n  .desc(`The texture format in depthStencilState must be a depth/stencil format.`)\n  .params(u =>\n    u //\n      .combine('isAsync', [false, true])\n      .combine('format', kAllTextureFormats)\n  )\n  .fn(t => {\n    const { isAsync, format } = t.params;\n    t.skipIfTextureFormatNotSupported(format);\n\n    const descriptor = t.getDescriptor({\n      depthStencil: { format, depthWriteEnabled: false, depthCompare: 'always' },\n    });\n\n    vtu.doCreateRenderPipelineTest(t, isAsync, isDepthOrStencilTextureFormat(format), descriptor);\n  });\n\ng.test('depthCompare_optional')\n  .desc(\n    `The depthCompare in depthStencilState is optional for stencil-only formats but\n    required for formats with a depth if depthCompare is not used for anything.`\n  )\n  .params(u =>\n    u\n      .combine('isAsync', [false, true])\n      .combine('format', kDepthStencilFormats)\n      .beginSubcases()\n      .combine('depthCompare', ['always', undefined] as const)\n      .combine('depthWriteEnabled', [false, true, undefined] as const)\n      .combine('stencilFrontDepthFailOp', ['keep', 'zero'] as const)\n      .combine('stencilBackDepthFailOp', ['keep', 'zero'] as const)\n  )\n  .fn(t => {\n    const {\n      isAsync,\n      format,\n      depthCompare,\n      depthWriteEnabled,\n      stencilFrontDepthFailOp,\n      stencilBackDepthFailOp,\n    } = t.params;\n    t.skipIfTextureFormatNotSupported(format);\n    const descriptor = t.getDescriptor({\n      depthStencil: {\n        format,\n        depthCompare,\n        depthWriteEnabled,\n        stencilFront: { depthFailOp: stencilFrontDepthFailOp },\n        stencilBack: { depthFailOp: stencilBackDepthFailOp },\n      },\n    });\n\n    const depthFailOpsAreKeep =\n      stencilFrontDepthFailOp === 'keep' && stencilBackDepthFailOp === 'keep';\n    const stencilStateIsDefault = depthFailOpsAreKeep;\n    let success = true;\n    if (depthWriteEnabled || (depthCompare && depthCompare !== 'always')) {\n      if (!isDepthTextureFormat(format)) success = false;\n    }\n    if (!stencilStateIsDefault) {\n      if (!isStencilTextureFormat(format)) success = false;\n    }\n    if (isDepthTextureFormat(format)) {\n      if (depthWriteEnabled === undefined) success = false;\n      if (depthWriteEnabled || !depthFailOpsAreKeep) {\n        if (depthCompare === undefined) success = false;\n      }\n    }\n\n    vtu.doCreateRenderPipelineTest(t, isAsync, success, descriptor);\n  });\n\ng.test('depthWriteEnabled_optional')\n  .desc(\n    `The depthWriteEnabled in depthStencilState is optional for stencil-only formats but required for formats with a depth.`\n  )\n  .params(u => u.combine('isAsync', [false, true]).combine('format', kDepthStencilFormats))\n  .fn(t => {\n    const { isAsync, format } = t.params;\n    t.skipIfTextureFormatNotSupported(format);\n    const descriptor = t.getDescriptor({\n      depthStencil: { format, depthCompare: 'always', depthWriteEnabled: undefined },\n    });\n\n    vtu.doCreateRenderPipelineTest(t, isAsync, !isDepthTextureFormat(format), descriptor);\n  });\n\ng.test('depth_test')\n  .desc(\n    `Depth aspect must be contained in the format if depth test is enabled in depthStencilState.`\n  )\n  .params(u =>\n    u\n      .combine('isAsync', [false, true])\n      .combine('format', kDepthStencilFormats)\n      .combine('depthCompare', kCompareFunctions)\n  )\n  .fn(t => {\n    const { isAsync, format, depthCompare } = t.params;\n    t.skipIfTextureFormatNotSupported(format);\n\n    const descriptor = t.getDescriptor({\n      depthStencil: { format, depthCompare, depthWriteEnabled: false },\n    });\n\n    const depthTestEnabled = depthCompare !== undefined && depthCompare !== 'always';\n    vtu.doCreateRenderPipelineTest(\n      t,\n      isAsync,\n      !depthTestEnabled || isDepthTextureFormat(format),\n      descriptor\n    );\n  });\n\ng.test('depth_write')\n  .desc(\n    `Depth aspect must be contained in the format if depth write is enabled in depthStencilState.`\n  )\n  .params(u =>\n    u\n      .combine('isAsync', [false, true])\n      .combine('format', kDepthStencilFormats)\n      .combine('depthWriteEnabled', [false, true])\n  )\n  .fn(t => {\n    const { isAsync, format, depthWriteEnabled } = t.params;\n    t.skipIfTextureFormatNotSupported(format);\n\n    const descriptor = t.getDescriptor({\n      depthStencil: { format, depthWriteEnabled, depthCompare: 'always' },\n    });\n    vtu.doCreateRenderPipelineTest(\n      t,\n      isAsync,\n      !depthWriteEnabled || isDepthTextureFormat(format),\n      descriptor\n    );\n  });\n\ng.test('depth_write,frag_depth')\n  .desc(`Depth aspect must be contained in the format if frag_depth is written in fragment stage.`)\n  .params(u =>\n    u.combine('isAsync', [false, true]).combine('format', [undefined, ...kDepthStencilFormats])\n  )\n  .fn(t => {\n    const { isAsync, format } = t.params;\n    t.skipIfTextureFormatNotSupported(format);\n\n    const descriptor = t.getDescriptor({\n      // Keep one color target so that the pipeline is still valid with no depth stencil target.\n      targets: [{ format: 'rgba8unorm' }],\n      depthStencil: format\n        ? { format, depthWriteEnabled: true, depthCompare: 'always' }\n        : undefined,\n      fragmentShaderCode: getFragmentShaderCodeWithOutput(\n        [{ values: [1, 1, 1, 1], plainType: 'f32', componentCount: 4 }],\n        { value: 0.5 }\n      ),\n    });\n\n    const hasDepth = format ? isDepthTextureFormat(format) : false;\n    vtu.doCreateRenderPipelineTest(t, isAsync, hasDepth, descriptor);\n  });\n\ng.test('depth_bias')\n  .desc(`Depth bias parameters are only valid with triangle topologies.`)\n  .params(u =>\n    u\n      .combine('isAsync', [false, true])\n      .combine('topology', kPrimitiveTopology)\n      .beginSubcases()\n      .combineWithParams([\n        {},\n        { depthBias: -1 },\n        { depthBias: 0 },\n        { depthBias: 1 },\n        { depthBiasSlopeScale: -1 },\n        { depthBiasSlopeScale: 0 },\n        { depthBiasSlopeScale: 1 },\n        { depthBiasClamp: -1 },\n        { depthBiasClamp: 0 },\n        { depthBiasClamp: 1 },\n      ])\n  )\n  .fn(t => {\n    const { isAsync, topology, depthBias, depthBiasSlopeScale, depthBiasClamp } = t.params;\n\n    if (t.isCompatibility && !!depthBiasClamp) {\n      t.skip('depthBiasClamp must be 0 on compatibility mode');\n    }\n\n    const isTriangleTopology = topology === 'triangle-list' || topology === 'triangle-strip';\n    const hasDepthBias = !!depthBias || !!depthBiasSlopeScale || !!depthBiasClamp;\n    const shouldSucceed = !hasDepthBias || isTriangleTopology;\n\n    const descriptor = t.getDescriptor({\n      primitive: { topology },\n      depthStencil: {\n        format: 'depth24plus',\n        depthWriteEnabled: true,\n        depthCompare: 'less-equal',\n        depthBias,\n        depthBiasSlopeScale,\n        depthBiasClamp,\n      },\n    });\n    vtu.doCreateRenderPipelineTest(t, isAsync, shouldSucceed, descriptor);\n  });\n\ng.test('stencil_test')\n  .desc(\n    `Stencil aspect must be contained in the format if stencil test is enabled in depthStencilState.`\n  )\n  .params(u =>\n    u\n      .combine('isAsync', [false, true])\n      .combine('format', kDepthStencilFormats)\n      .combine('face', ['front', 'back'] as const)\n      .combine('compare', [undefined, ...kCompareFunctions])\n  )\n  .fn(t => {\n    const { isAsync, format, face, compare } = t.params;\n    t.skipIfTextureFormatNotSupported(format);\n\n    let descriptor: GPURenderPipelineDescriptor;\n    if (face === 'front') {\n      descriptor = t.getDescriptor({\n        depthStencil: {\n          format,\n          depthWriteEnabled: false,\n          depthCompare: 'always',\n          stencilFront: { compare },\n        },\n      });\n    } else {\n      descriptor = t.getDescriptor({\n        depthStencil: {\n          format,\n          depthWriteEnabled: false,\n          depthCompare: 'always',\n          stencilBack: { compare },\n        },\n      });\n    }\n\n    const stencilTestEnabled = compare !== undefined && compare !== 'always';\n    vtu.doCreateRenderPipelineTest(\n      t,\n      isAsync,\n      !stencilTestEnabled || isStencilTextureFormat(format),\n      descriptor\n    );\n  });\n\ng.test('stencil_write')\n  .desc(\n    `Stencil aspect must be contained in the format if stencil write is enabled in depthStencilState.`\n  )\n  .params(u =>\n    u\n      .combine('isAsync', [false, true])\n      .combine('format', kDepthStencilFormats)\n      .combine('faceAndOpType', [\n        'frontFailOp',\n        'frontDepthFailOp',\n        'frontPassOp',\n        'backFailOp',\n        'backDepthFailOp',\n        'backPassOp',\n      ] as const)\n      .combine('op', [undefined, ...kStencilOperations])\n  )\n  .fn(t => {\n    const { isAsync, format, faceAndOpType, op } = t.params;\n    t.skipIfTextureFormatNotSupported(format);\n\n    const common = {\n      format,\n      depthWriteEnabled: false,\n      depthCompare: 'always' as GPUCompareFunction,\n    };\n    let depthStencil: GPUDepthStencilState;\n    switch (faceAndOpType) {\n      case 'frontFailOp':\n        depthStencil = { ...common, stencilFront: { failOp: op } };\n        break;\n      case 'frontDepthFailOp':\n        depthStencil = { ...common, stencilFront: { depthFailOp: op } };\n        break;\n      case 'frontPassOp':\n        depthStencil = { ...common, stencilFront: { passOp: op } };\n        break;\n      case 'backFailOp':\n        depthStencil = { ...common, stencilBack: { failOp: op } };\n        break;\n      case 'backDepthFailOp':\n        depthStencil = { ...common, stencilBack: { depthFailOp: op } };\n        break;\n      case 'backPassOp':\n        depthStencil = { ...common, stencilBack: { passOp: op } };\n        break;\n      default:\n        unreachable();\n    }\n    const descriptor = t.getDescriptor({ depthStencil });\n\n    const stencilWriteEnabled = op !== undefined && op !== 'keep';\n    vtu.doCreateRenderPipelineTest(\n      t,\n      isAsync,\n      !stencilWriteEnabled || isStencilTextureFormat(format),\n      descriptor\n    );\n  });\n"],"mappings":"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"}