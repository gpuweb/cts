{"version":3,"file":"in_render_common.spec.js","names":["description","makeTestGroup","assert","unreachable","MaxLimitsTestMixin","ValidationTest","kTextureBindingTypes","IsReadOnlyTextureBindingType","t","F","getColorAttachment","texture","textureViewDescriptor","view","createView","clearValue","r","g","b","a","loadOp","storeOp","createBindGroupForTest","textureView","textureUsage","sampleType","bindGroupLayoutEntry","binding","visibility","GPUShaderStage","FRAGMENT","viewDimension","storageTexture","access","format","layout","device","createBindGroupLayout","entries","createBindGroup","resource","isRangeNotOverlapped","start0","end0","start1","end1","kTextureSize","kTextureLevels","kTextureLayers","test","desc","params","u","combine","unless","inSamePass","level0","level1","beforeAllSubcases","selectDeviceForRenderableColorFormatOrSkipTestCase","fn","layer0","layer1","createTextureTracked","usage","GPUTextureUsage","RENDER_ATTACHMENT","size","mipLevelCount","colorAttachment1","dimension","baseArrayLayer","arrayLayerCount","baseMipLevel","colorAttachment2","encoder","createCommandEncoder","renderPass","beginRenderPass","colorAttachments","end","renderPass1","renderPass2","success","expectValidationError","finish","combineWithParams","bgLevel","bgLevelCount","bgLayer","bgLayerCount","bgUsage","isCompatibility","skipIf","colorAttachmentLevel","colorAttachmentLayer","limits","maxStorageTexturesInFragmentStage","TEXTURE_BINDING","STORAGE_BINDING","bindGroupView","bindGroup","colorAttachment","setBindGroup","texture2","isMipLevelNotOverlapped","isArrayLayerNotOverlapped","isNotOverlapped","beginSubcases","dsLevel","dsLayer","depthReadOnly","stencilReadOnly","bgAspect","aspect","attachmentView","depthStencilAttachment","depthLoadOp","undefined","depthStoreOp","stencilLoadOp","stencilStoreOp","readonly","base","count","bgUsage0","bg0Levels","bgUsage1","bg1Levels","bg0Layers","bg1Layers","bg0","bg1","bindGroup0","bindGroup1","colorTexture","bothReadOnly","view0Layers","view1Layers","view0Levels","view1Levels","aspect0","aspect1","bindGroupView0","bindGroupView1","sampleType0","sampleType1"],"sources":["../../../../../../src/webgpu/api/validation/resource_usages/texture/in_render_common.spec.ts"],"sourcesContent":["export const description = `\nTexture Usages Validation Tests in Same or Different Render Pass Encoders.\n`;\n\nimport { makeTestGroup } from '../../../../../common/framework/test_group.js';\nimport { assert, unreachable } from '../../../../../common/util/util.js';\nimport { MaxLimitsTestMixin } from '../../../../gpu_test.js';\nimport { ValidationTest } from '../../validation_test.js';\n\nexport type TextureBindingType =\n  | 'sampled-texture'\n  | 'writeonly-storage-texture'\n  | 'readonly-storage-texture'\n  | 'readwrite-storage-texture';\nexport const kTextureBindingTypes = [\n  'sampled-texture',\n  'writeonly-storage-texture',\n  'readonly-storage-texture',\n  'readwrite-storage-texture',\n] as const;\nexport function IsReadOnlyTextureBindingType(t: TextureBindingType): boolean {\n  return t === 'sampled-texture' || t === 'readonly-storage-texture';\n}\n\nclass F extends ValidationTest {\n  getColorAttachment(\n    texture: GPUTexture,\n    textureViewDescriptor?: GPUTextureViewDescriptor\n  ): GPURenderPassColorAttachment {\n    const view = texture.createView(textureViewDescriptor);\n\n    return {\n      view,\n      clearValue: { r: 1.0, g: 0.0, b: 0.0, a: 1.0 },\n      loadOp: 'clear',\n      storeOp: 'store',\n    };\n  }\n\n  createBindGroupForTest(\n    textureView: GPUTextureView,\n    textureUsage: TextureBindingType,\n    sampleType: 'unfilterable-float' | 'depth' | 'uint'\n  ) {\n    const bindGroupLayoutEntry: GPUBindGroupLayoutEntry = {\n      binding: 0,\n      visibility: GPUShaderStage.FRAGMENT,\n    };\n    switch (textureUsage) {\n      case 'sampled-texture':\n        bindGroupLayoutEntry.texture = { viewDimension: '2d-array', sampleType };\n        break;\n      case 'readonly-storage-texture':\n        bindGroupLayoutEntry.storageTexture = {\n          access: 'read-only',\n          format: 'r32float',\n          viewDimension: '2d-array',\n        };\n        break;\n      case 'readwrite-storage-texture':\n        bindGroupLayoutEntry.storageTexture = {\n          access: 'read-write',\n          format: 'r32float',\n          viewDimension: '2d-array',\n        };\n        break;\n      case 'writeonly-storage-texture':\n        bindGroupLayoutEntry.storageTexture = {\n          access: 'write-only',\n          format: 'r32float',\n          viewDimension: '2d-array',\n        };\n        break;\n      default:\n        unreachable();\n        break;\n    }\n    const layout = this.device.createBindGroupLayout({\n      entries: [bindGroupLayoutEntry],\n    });\n    return this.device.createBindGroup({\n      layout,\n      entries: [{ binding: 0, resource: textureView }],\n    });\n  }\n\n  isRangeNotOverlapped(start0: number, end0: number, start1: number, end1: number): boolean {\n    assert(start0 <= end0 && start1 <= end1);\n    // There are only two possibilities for two non-overlapped ranges:\n    // [start0, end0] [start1, end1] or\n    // [start1, end1] [start0, end0]\n    return end0 < start1 || end1 < start0;\n  }\n}\n\nexport const g = makeTestGroup(MaxLimitsTestMixin(F));\n\nconst kTextureSize = 16;\nconst kTextureLevels = 3;\nconst kTextureLayers = 3;\n\ng.test('subresources,color_attachments')\n  .desc(\n    `\n  Test that the different subresource of the same texture are allowed to be used as color\n  attachments in same / different render pass encoder, while the same subresource is only allowed\n  to be used as different color attachments in different render pass encoders.`\n  )\n  .params(u =>\n    u\n      .combine('layer0', [0, 1])\n      .combine('level0', [0, 1])\n      .combine('layer1', [0, 1])\n      .combine('level1', [0, 1])\n      .combine('inSamePass', [true, false])\n      .unless(t => t.inSamePass && t.level0 !== t.level1)\n  )\n  .beforeAllSubcases(t => {\n    t.selectDeviceForRenderableColorFormatOrSkipTestCase('r32float');\n  })\n  .fn(t => {\n    const { layer0, level0, layer1, level1, inSamePass } = t.params;\n\n    const texture = t.createTextureTracked({\n      format: 'r32float',\n      usage: GPUTextureUsage.RENDER_ATTACHMENT,\n      size: [kTextureSize, kTextureSize, kTextureLayers],\n      mipLevelCount: kTextureLevels,\n    });\n\n    const colorAttachment1 = t.getColorAttachment(texture, {\n      dimension: '2d',\n      baseArrayLayer: layer0,\n      arrayLayerCount: 1,\n      baseMipLevel: level0,\n      mipLevelCount: 1,\n    });\n    const colorAttachment2 = t.getColorAttachment(texture, {\n      dimension: '2d',\n      baseArrayLayer: layer1,\n      baseMipLevel: level1,\n      mipLevelCount: 1,\n    });\n    const encoder = t.device.createCommandEncoder();\n    if (inSamePass) {\n      const renderPass = encoder.beginRenderPass({\n        colorAttachments: [colorAttachment1, colorAttachment2],\n      });\n      renderPass.end();\n    } else {\n      const renderPass1 = encoder.beginRenderPass({\n        colorAttachments: [colorAttachment1],\n      });\n      renderPass1.end();\n      const renderPass2 = encoder.beginRenderPass({\n        colorAttachments: [colorAttachment2],\n      });\n      renderPass2.end();\n    }\n\n    const success = inSamePass ? layer0 !== layer1 : true;\n    t.expectValidationError(() => {\n      encoder.finish();\n    }, !success);\n  });\n\ng.test('subresources,color_attachment_and_bind_group')\n  .desc(\n    `\n  Test that when one subresource of a texture is used as a color attachment, it cannot be used in a\n  bind group simultaneously in the same render pass encoder. It is allowed when the bind group is\n  used in another render pass encoder instead of the same one.`\n  )\n  .params(u =>\n    u\n      .combine('colorAttachmentLevel', [0, 1])\n      .combine('colorAttachmentLayer', [0, 1])\n      .combineWithParams([\n        { bgLevel: 0, bgLevelCount: 1 },\n        { bgLevel: 1, bgLevelCount: 1 },\n        { bgLevel: 1, bgLevelCount: 2 },\n      ])\n      .combineWithParams([\n        { bgLayer: 0, bgLayerCount: 1 },\n        { bgLayer: 1, bgLayerCount: 1 },\n        { bgLayer: 1, bgLayerCount: 2 },\n        { bgLayer: 0, bgLayerCount: kTextureLayers },\n      ])\n      .combine('bgUsage', kTextureBindingTypes)\n      .unless(t => t.bgUsage !== 'sampled-texture' && t.bgLevelCount > 1)\n      .combine('inSamePass', [true, false])\n  )\n  .beforeAllSubcases(t => {\n    if (t.isCompatibility) {\n      t.skipIf(t.params.bgLayer !== 0, 'view base array layer must equal 0 in compatibility mode');\n      t.skipIf(\n        t.params.bgLayerCount !== kTextureLayers,\n        'view array layers must equal texture array layers in compatibility mode'\n      );\n      t.selectDeviceForRenderableColorFormatOrSkipTestCase('r32float');\n    }\n  })\n  .fn(t => {\n    const {\n      colorAttachmentLevel,\n      colorAttachmentLayer,\n      bgLevel,\n      bgLevelCount,\n      bgLayer,\n      bgLayerCount,\n      bgUsage,\n      inSamePass,\n    } = t.params;\n\n    t.skipIf(\n      t.isCompatibility &&\n        bgUsage !== 'sampled-texture' &&\n        !(t.device.limits.maxStorageTexturesInFragmentStage! >= 1),\n      `maxStorageTexturesInFragmentStage(${t.device.limits.maxStorageTexturesInFragmentStage}) < 1`\n    );\n\n    const texture = t.createTextureTracked({\n      format: 'r32float',\n      usage:\n        GPUTextureUsage.RENDER_ATTACHMENT |\n        GPUTextureUsage.TEXTURE_BINDING |\n        GPUTextureUsage.STORAGE_BINDING,\n      size: [kTextureSize, kTextureSize, kTextureLayers],\n      mipLevelCount: kTextureLevels,\n    });\n    const bindGroupView = texture.createView({\n      dimension: '2d-array',\n      baseArrayLayer: bgLayer,\n      arrayLayerCount: bgLayerCount,\n      baseMipLevel: bgLevel,\n      mipLevelCount: bgLevelCount,\n    });\n    const bindGroup = t.createBindGroupForTest(bindGroupView, bgUsage, 'unfilterable-float');\n\n    const colorAttachment = t.getColorAttachment(texture, {\n      dimension: '2d',\n      baseArrayLayer: colorAttachmentLayer,\n      arrayLayerCount: 1,\n      baseMipLevel: colorAttachmentLevel,\n      mipLevelCount: 1,\n    });\n\n    const encoder = t.device.createCommandEncoder();\n    const renderPass = encoder.beginRenderPass({\n      colorAttachments: [colorAttachment],\n    });\n    if (inSamePass) {\n      renderPass.setBindGroup(0, bindGroup);\n      renderPass.end();\n    } else {\n      renderPass.end();\n\n      const texture2 = t.createTextureTracked({\n        format: 'r32float',\n        usage: GPUTextureUsage.RENDER_ATTACHMENT,\n        size: [kTextureSize, kTextureSize, 1],\n        mipLevelCount: 1,\n      });\n      const colorAttachment2 = t.getColorAttachment(texture2);\n      const renderPass2 = encoder.beginRenderPass({\n        colorAttachments: [colorAttachment2],\n      });\n      renderPass2.setBindGroup(0, bindGroup);\n      renderPass2.end();\n    }\n\n    const isMipLevelNotOverlapped = t.isRangeNotOverlapped(\n      colorAttachmentLevel,\n      colorAttachmentLevel,\n      bgLevel,\n      bgLevel + bgLevelCount - 1\n    );\n    const isArrayLayerNotOverlapped = t.isRangeNotOverlapped(\n      colorAttachmentLayer,\n      colorAttachmentLayer,\n      bgLayer,\n      bgLayer + bgLayerCount - 1\n    );\n    const isNotOverlapped = isMipLevelNotOverlapped || isArrayLayerNotOverlapped;\n\n    const success = inSamePass ? isNotOverlapped : true;\n    t.expectValidationError(() => {\n      encoder.finish();\n    }, !success);\n  });\n\ng.test('subresources,depth_stencil_attachment_and_bind_group')\n  .desc(\n    `\n  Test that when one subresource of a texture is used as a depth stencil attachment, it cannot be\n  used in a bind group simultaneously in the same render pass encoder. It is allowed when the bind\n  group is used in another render pass encoder instead of the same one, or the subresource is used\n  as a read-only depth stencil attachment.`\n  )\n  .params(u =>\n    u\n      .combine('dsLevel', [0, 1])\n      .combine('dsLayer', [0, 1])\n      .combineWithParams([\n        { bgLevel: 0, bgLevelCount: 1 },\n        { bgLevel: 1, bgLevelCount: 1 },\n        { bgLevel: 1, bgLevelCount: 2 },\n      ])\n      .combineWithParams([\n        { bgLayer: 0, bgLayerCount: 1 },\n        { bgLayer: 1, bgLayerCount: 1 },\n        { bgLayer: 1, bgLayerCount: 2 },\n        { bgLayer: 0, bgLayerCount: kTextureLayers },\n      ])\n      .beginSubcases()\n      .combine('depthReadOnly', [true, false])\n      .combine('stencilReadOnly', [true, false])\n      .combine('bgAspect', ['depth-only', 'stencil-only'] as const)\n      .combine('inSamePass', [true, false])\n  )\n  .beforeAllSubcases(t => {\n    if (t.isCompatibility) {\n      t.skipIf(t.params.bgLayer !== 0, 'view base array layer must equal 0 in compatibility mode');\n      t.skipIf(\n        t.params.bgLayerCount !== kTextureLayers,\n        'view array layers must equal texture array layers in compatibility mode'\n      );\n    }\n  })\n  .fn(t => {\n    const {\n      dsLevel,\n      dsLayer,\n      bgLevel,\n      bgLevelCount,\n      bgLayer,\n      bgLayerCount,\n      depthReadOnly,\n      stencilReadOnly,\n      bgAspect,\n      inSamePass,\n    } = t.params;\n\n    const texture = t.createTextureTracked({\n      format: 'depth24plus-stencil8',\n      usage: GPUTextureUsage.RENDER_ATTACHMENT | GPUTextureUsage.TEXTURE_BINDING,\n      size: [kTextureSize, kTextureSize, kTextureLayers],\n      mipLevelCount: kTextureLevels,\n    });\n    const bindGroupView = texture.createView({\n      dimension: '2d-array',\n      baseArrayLayer: bgLayer,\n      arrayLayerCount: bgLayerCount,\n      baseMipLevel: bgLevel,\n      mipLevelCount: bgLevelCount,\n      aspect: bgAspect,\n    });\n    const sampleType = bgAspect === 'depth-only' ? 'depth' : 'uint';\n    const bindGroup = t.createBindGroupForTest(bindGroupView, 'sampled-texture', sampleType);\n\n    const attachmentView = texture.createView({\n      dimension: '2d',\n      baseArrayLayer: dsLayer,\n      arrayLayerCount: 1,\n      baseMipLevel: dsLevel,\n      mipLevelCount: 1,\n    });\n    const depthStencilAttachment: GPURenderPassDepthStencilAttachment = {\n      view: attachmentView,\n      depthReadOnly,\n      depthLoadOp: depthReadOnly ? undefined : 'load',\n      depthStoreOp: depthReadOnly ? undefined : 'store',\n      stencilReadOnly,\n      stencilLoadOp: stencilReadOnly ? undefined : 'load',\n      stencilStoreOp: stencilReadOnly ? undefined : 'store',\n    };\n\n    const encoder = t.device.createCommandEncoder();\n    const renderPass = encoder.beginRenderPass({\n      colorAttachments: [],\n      depthStencilAttachment,\n    });\n    if (inSamePass) {\n      renderPass.setBindGroup(0, bindGroup);\n      renderPass.end();\n    } else {\n      renderPass.end();\n\n      const texture2 = t.createTextureTracked({\n        format: 'rgba8unorm',\n        usage: GPUTextureUsage.RENDER_ATTACHMENT,\n        size: [kTextureSize, kTextureSize, 1],\n        mipLevelCount: 1,\n      });\n      const colorAttachment2 = t.getColorAttachment(texture2);\n      const renderPass2 = encoder.beginRenderPass({\n        colorAttachments: [colorAttachment2],\n      });\n      renderPass2.setBindGroup(0, bindGroup);\n      renderPass2.end();\n    }\n\n    const isMipLevelNotOverlapped = t.isRangeNotOverlapped(\n      dsLevel,\n      dsLevel,\n      bgLevel,\n      bgLevel + bgLevelCount - 1\n    );\n    const isArrayLayerNotOverlapped = t.isRangeNotOverlapped(\n      dsLayer,\n      dsLayer,\n      bgLayer,\n      bgLayer + bgLayerCount - 1\n    );\n    const isNotOverlapped = isMipLevelNotOverlapped || isArrayLayerNotOverlapped;\n    const readonly =\n      (bgAspect === 'stencil-only' && stencilReadOnly) ||\n      (bgAspect === 'depth-only' && depthReadOnly);\n\n    const success = !inSamePass || isNotOverlapped || readonly;\n    t.expectValidationError(() => {\n      encoder.finish();\n    }, !success);\n  });\n\ng.test('subresources,multiple_bind_groups')\n  .desc(\n    `\n  Test that when one color texture subresource is bound to different bind groups, its list of\n  internal usages within one usage scope can only be a compatible usage list. For texture\n  subresources in bind groups, the compatible usage lists are {TEXTURE_BINDING} and\n  {STORAGE_BINDING}, which means it can only be bound as both TEXTURE_BINDING and STORAGE_BINDING in\n  different render pass encoders, otherwise a validation error will occur.`\n  )\n  .params(u =>\n    u\n      .combine('bg0Levels', [\n        { base: 0, count: 1 },\n        { base: 1, count: 1 },\n        { base: 1, count: 2 },\n      ])\n      .combine('bg0Layers', [\n        { base: 0, count: 1 },\n        { base: 1, count: 1 },\n        { base: 1, count: 2 },\n        { base: 0, count: kTextureLayers },\n      ])\n      .combine('bg1Levels', [\n        { base: 0, count: 1 },\n        { base: 1, count: 1 },\n        { base: 1, count: 2 },\n      ])\n      .combine('bg1Layers', [\n        { base: 0, count: 1 },\n        { base: 1, count: 1 },\n        { base: 1, count: 2 },\n        { base: 0, count: kTextureLayers },\n      ])\n      .combine('bgUsage0', kTextureBindingTypes)\n      .combine('bgUsage1', kTextureBindingTypes)\n      .unless(\n        t =>\n          (t.bgUsage0 !== 'sampled-texture' && t.bg0Levels.count > 1) ||\n          (t.bgUsage1 !== 'sampled-texture' && t.bg1Levels.count > 1)\n      )\n      .beginSubcases()\n      .combine('inSamePass', [true, false])\n  )\n  .beforeAllSubcases(t => {\n    if (t.isCompatibility) {\n      t.skipIf(\n        t.params.bg0Layers.base !== 0 || t.params.bg1Layers.base !== 0,\n        'view base array layer must equal 0 in compatibility mode'\n      );\n      t.skipIf(\n        t.params.bg0Layers.count !== kTextureLayers || t.params.bg1Layers.count !== kTextureLayers,\n        'view array layers must equal texture array layers in compatibility mode'\n      );\n      t.selectDeviceForRenderableColorFormatOrSkipTestCase('r32float');\n    }\n  })\n  .fn(t => {\n    const { bg0Levels, bg0Layers, bg1Levels, bg1Layers, bgUsage0, bgUsage1, inSamePass } = t.params;\n\n    t.skipIf(\n      t.isCompatibility &&\n        (bgUsage0 !== 'sampled-texture' || bgUsage1 !== 'sampled-texture') &&\n        !(t.device.limits.maxStorageTexturesInFragmentStage! >= 2),\n      `maxStorageTexturesInFragmentStage(${t.device.limits.maxStorageTexturesInFragmentStage}) < 2`\n    );\n\n    const texture = t.createTextureTracked({\n      format: 'r32float',\n      usage: GPUTextureUsage.STORAGE_BINDING | GPUTextureUsage.TEXTURE_BINDING,\n      size: [kTextureSize, kTextureSize, kTextureLayers],\n      mipLevelCount: kTextureLevels,\n    });\n    const bg0 = texture.createView({\n      dimension: '2d-array',\n      baseArrayLayer: bg0Layers.base,\n      arrayLayerCount: bg0Layers.count,\n      baseMipLevel: bg0Levels.base,\n      mipLevelCount: bg0Levels.count,\n    });\n    const bg1 = texture.createView({\n      dimension: '2d-array',\n      baseArrayLayer: bg1Layers.base,\n      arrayLayerCount: bg1Layers.count,\n      baseMipLevel: bg1Levels.base,\n      mipLevelCount: bg1Levels.count,\n    });\n    const bindGroup0 = t.createBindGroupForTest(bg0, bgUsage0, 'unfilterable-float');\n    const bindGroup1 = t.createBindGroupForTest(bg1, bgUsage1, 'unfilterable-float');\n\n    const colorTexture = t.createTextureTracked({\n      format: 'r32float',\n      usage: GPUTextureUsage.RENDER_ATTACHMENT,\n      size: [kTextureSize, kTextureSize, 1],\n      mipLevelCount: 1,\n    });\n    const colorAttachment = t.getColorAttachment(colorTexture);\n    const encoder = t.device.createCommandEncoder();\n    const renderPass = encoder.beginRenderPass({\n      colorAttachments: [colorAttachment],\n    });\n    if (inSamePass) {\n      renderPass.setBindGroup(0, bindGroup0);\n      renderPass.setBindGroup(1, bindGroup1);\n      renderPass.end();\n    } else {\n      renderPass.setBindGroup(0, bindGroup0);\n      renderPass.end();\n\n      const renderPass2 = encoder.beginRenderPass({\n        colorAttachments: [colorAttachment],\n      });\n      renderPass2.setBindGroup(1, bindGroup1);\n      renderPass2.end();\n    }\n\n    const bothReadOnly =\n      IsReadOnlyTextureBindingType(bgUsage0) && IsReadOnlyTextureBindingType(bgUsage1);\n    const isMipLevelNotOverlapped = t.isRangeNotOverlapped(\n      bg0Levels.base,\n      bg0Levels.base + bg0Levels.count - 1,\n      bg1Levels.base,\n      bg1Levels.base + bg1Levels.count - 1\n    );\n    const isArrayLayerNotOverlapped = t.isRangeNotOverlapped(\n      bg0Layers.base,\n      bg0Layers.base + bg0Layers.count - 1,\n      bg1Layers.base,\n      bg1Layers.base + bg1Layers.count - 1\n    );\n    const isNotOverlapped = isMipLevelNotOverlapped || isArrayLayerNotOverlapped;\n\n    const success = !inSamePass || bothReadOnly || isNotOverlapped || bgUsage0 === bgUsage1;\n    t.expectValidationError(() => {\n      encoder.finish();\n    }, !success);\n  });\n\ng.test('subresources,depth_stencil_texture_in_bind_groups')\n  .desc(\n    `\n  Test that when one depth stencil texture subresource is bound to different bind groups, we can\n  always bind these two bind groups in either the same or different render pass encoder as the depth\n  stencil texture can only be bound as TEXTURE_BINDING in the bind group.`\n  )\n  .params(u =>\n    u\n      .combine('view0Levels', [\n        { base: 0, count: 1 },\n        { base: 1, count: 1 },\n        { base: 1, count: 2 },\n      ])\n      .combine('view0Layers', [\n        { base: 0, count: 1 },\n        { base: 1, count: 1 },\n        { base: 1, count: 2 },\n        { base: 0, count: kTextureLayers },\n      ])\n      .combine('view1Levels', [\n        { base: 0, count: 1 },\n        { base: 1, count: 1 },\n        { base: 1, count: 2 },\n      ])\n      .combine('view1Layers', [\n        { base: 0, count: 1 },\n        { base: 1, count: 1 },\n        { base: 1, count: 2 },\n        { base: 0, count: kTextureLayers },\n      ])\n      .combine('aspect0', ['depth-only', 'stencil-only'] as const)\n      .combine('aspect1', ['depth-only', 'stencil-only'] as const)\n      .combine('inSamePass', [true, false])\n  )\n  .beforeAllSubcases(t => {\n    if (t.isCompatibility) {\n      t.skipIf(\n        t.params.view0Layers.base !== 0 || t.params.view1Layers.base !== 0,\n        'view base array layer must equal 0 in compatibility mode'\n      );\n      t.skipIf(\n        t.params.view0Layers.count !== kTextureLayers ||\n          t.params.view1Layers.count !== kTextureLayers,\n        'view array layers must equal texture array layers in compatibility mode'\n      );\n    }\n  })\n  .fn(t => {\n    const { view0Levels, view0Layers, view1Levels, view1Layers, aspect0, aspect1, inSamePass } =\n      t.params;\n\n    const texture = t.createTextureTracked({\n      format: 'depth24plus-stencil8',\n      usage: GPUTextureUsage.TEXTURE_BINDING,\n      size: [kTextureSize, kTextureSize, kTextureLayers],\n      mipLevelCount: kTextureLevels,\n    });\n    const bindGroupView0 = texture.createView({\n      dimension: '2d-array',\n      baseArrayLayer: view0Layers.base,\n      arrayLayerCount: view0Layers.count,\n      baseMipLevel: view0Levels.base,\n      mipLevelCount: view0Levels.count,\n      aspect: aspect0,\n    });\n    const bindGroupView1 = texture.createView({\n      dimension: '2d-array',\n      baseArrayLayer: view1Layers.base,\n      arrayLayerCount: view1Layers.count,\n      baseMipLevel: view1Levels.base,\n      mipLevelCount: view1Levels.count,\n      aspect: aspect1,\n    });\n\n    const sampleType0 = aspect0 === 'depth-only' ? 'depth' : 'uint';\n    const sampleType1 = aspect1 === 'depth-only' ? 'depth' : 'uint';\n    const bindGroup0 = t.createBindGroupForTest(bindGroupView0, 'sampled-texture', sampleType0);\n    const bindGroup1 = t.createBindGroupForTest(bindGroupView1, 'sampled-texture', sampleType1);\n\n    const colorTexture = t.createTextureTracked({\n      format: 'rgba8unorm',\n      usage: GPUTextureUsage.RENDER_ATTACHMENT,\n      size: [kTextureSize, kTextureSize, 1],\n      mipLevelCount: 1,\n    });\n    const colorAttachment = t.getColorAttachment(colorTexture);\n    const encoder = t.device.createCommandEncoder();\n    const renderPass = encoder.beginRenderPass({\n      colorAttachments: [colorAttachment],\n    });\n    if (inSamePass) {\n      renderPass.setBindGroup(0, bindGroup0);\n      renderPass.setBindGroup(1, bindGroup1);\n      renderPass.end();\n    } else {\n      renderPass.setBindGroup(0, bindGroup0);\n      renderPass.end();\n\n      const renderPass2 = encoder.beginRenderPass({\n        colorAttachments: [colorAttachment],\n      });\n      renderPass2.setBindGroup(1, bindGroup1);\n      renderPass2.end();\n    }\n\n    t.expectValidationError(() => {\n      encoder.finish();\n    }, false);\n  });\n"],"mappings":"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"}