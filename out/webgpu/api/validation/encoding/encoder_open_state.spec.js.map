{"version":3,"file":"encoder_open_state.spec.js","names":["description","makeTestGroup","keysOf","unreachable","ValidationTest","beginRenderPassWithQuerySet","F","createRenderPipelineForTest","device","createRenderPipeline","layout","vertex","module","createShaderModule","code","entryPoint","fragment","targets","format","writeMask","createBindGroupForTest","createBindGroup","entries","binding","resource","createSampler","createBindGroupLayout","visibility","GPUShaderStage","FRAGMENT","sampler","type","g","kEncoderCommandInfo","beginComputePass","beginRenderPass","clearBuffer","copyBufferToBuffer","copyBufferToTexture","copyTextureToBuffer","copyTextureToTexture","insertDebugMarker","popDebugGroup","pushDebugGroup","writeTimestamp","resolveQuerySet","kEncoderCommands","kRenderPassEncoderCommandInfo","draw","drawIndexed","drawIndexedIndirect","drawIndirect","setIndexBuffer","setBindGroup","setVertexBuffer","setPipeline","setViewport","setScissorRect","setBlendConstant","setStencilReference","beginOcclusionQuery","endOcclusionQuery","executeBundles","kRenderPassEncoderCommands","kRenderBundleEncoderCommandInfo","kRenderBundleEncoderCommands","kComputePassEncoderCommandInfo","dispatchWorkgroups","dispatchWorkgroupsIndirect","kComputePassEncoderCommands","test","desc","params","u","combine","beginSubcases","beforeAllSubcases","t","command","selectDeviceOrSkipTestCase","fn","finishBeforeCommand","srcBuffer","createBufferTracked","size","usage","GPUBufferUsage","COPY_SRC","GPUTextureUsage","COPY_DST","dstBuffer","QUERY_RESOLVE","textureSize","width","height","textureFormat","srcTexture","createTextureTracked","dstTexture","querySet","createQuerySetTracked","count","encoder","createCommandEncoder","finish","expectValidationError","colorAttachments","buffer","texture","ex","skipIf","TypeError","renderPass","INDIRECT","VERTEX","pipeline","bindGroup","end","kNumTestPoints","kViewportMinDepth","kViewportMaxDepth","r","b","a","bundleEncoder","createRenderBundleEncoder","colorFormats","computePass","indirectBuffer","computePipeline","createNoOpComputePipeline"],"sources":["../../../../../src/webgpu/api/validation/encoding/encoder_open_state.spec.ts"],"sourcesContent":["export const description = `\nValidation tests to all commands of GPUCommandEncoder, GPUComputePassEncoder, and\nGPURenderPassEncoder when the encoder is not finished.\n`;\n\nimport { makeTestGroup } from '../../../../common/framework/test_group.js';\nimport { keysOf } from '../../../../common/util/data_tables.js';\nimport { unreachable } from '../../../../common/util/util.js';\nimport { ValidationTest } from '../validation_test.js';\n\nimport { beginRenderPassWithQuerySet } from './queries/common.js';\n\nclass F extends ValidationTest {\n  createRenderPipelineForTest(): GPURenderPipeline {\n    return this.device.createRenderPipeline({\n      layout: 'auto',\n      vertex: {\n        module: this.device.createShaderModule({\n          code: `\n            @vertex fn main() -> @builtin(position) vec4<f32> {\n              return vec4<f32>();\n            }\n          `,\n        }),\n        entryPoint: 'main',\n      },\n      fragment: {\n        module: this.device.createShaderModule({\n          code: `@fragment fn main() {}`,\n        }),\n        entryPoint: 'main',\n        targets: [{ format: 'rgba8unorm', writeMask: 0 }],\n      },\n    });\n  }\n\n  createBindGroupForTest(): GPUBindGroup {\n    return this.device.createBindGroup({\n      entries: [\n        {\n          binding: 0,\n          resource: this.device.createSampler(),\n        },\n      ],\n      layout: this.device.createBindGroupLayout({\n        entries: [\n          {\n            binding: 0,\n            visibility: GPUShaderStage.FRAGMENT,\n            sampler: { type: 'filtering' },\n          },\n        ],\n      }),\n    });\n  }\n}\n\nexport const g = makeTestGroup(F);\n\n// MAINTENANCE_TODO: Remove writeTimestamp from here once it's (hopefully) added back to the spec.\ntype EncoderCommands =\n  | keyof Omit<GPUCommandEncoder, '__brand' | 'label' | 'finish'>\n  | 'writeTimestamp';\nconst kEncoderCommandInfo: {\n  readonly [k in EncoderCommands]: {};\n} = {\n  beginComputePass: {},\n  beginRenderPass: {},\n  clearBuffer: {},\n  copyBufferToBuffer: {},\n  copyBufferToTexture: {},\n  copyTextureToBuffer: {},\n  copyTextureToTexture: {},\n  insertDebugMarker: {},\n  popDebugGroup: {},\n  pushDebugGroup: {},\n  writeTimestamp: {},\n  resolveQuerySet: {},\n};\nconst kEncoderCommands = keysOf(kEncoderCommandInfo);\n\ntype RenderPassEncoderCommands = keyof Omit<GPURenderPassEncoder, '__brand' | 'label' | 'end'>;\nconst kRenderPassEncoderCommandInfo: {\n  readonly [k in RenderPassEncoderCommands]: {};\n} = {\n  draw: {},\n  drawIndexed: {},\n  drawIndexedIndirect: {},\n  drawIndirect: {},\n  setIndexBuffer: {},\n  setBindGroup: {},\n  setVertexBuffer: {},\n  setPipeline: {},\n  setViewport: {},\n  setScissorRect: {},\n  setBlendConstant: {},\n  setStencilReference: {},\n  beginOcclusionQuery: {},\n  endOcclusionQuery: {},\n  executeBundles: {},\n  pushDebugGroup: {},\n  popDebugGroup: {},\n  insertDebugMarker: {},\n};\nconst kRenderPassEncoderCommands = keysOf(kRenderPassEncoderCommandInfo);\n\ntype RenderBundleEncoderCommands = keyof Omit<\n  GPURenderBundleEncoder,\n  '__brand' | 'label' | 'finish'\n>;\nconst kRenderBundleEncoderCommandInfo: {\n  readonly [k in RenderBundleEncoderCommands]: {};\n} = {\n  draw: {},\n  drawIndexed: {},\n  drawIndexedIndirect: {},\n  drawIndirect: {},\n  setPipeline: {},\n  setBindGroup: {},\n  setIndexBuffer: {},\n  setVertexBuffer: {},\n  pushDebugGroup: {},\n  popDebugGroup: {},\n  insertDebugMarker: {},\n};\nconst kRenderBundleEncoderCommands = keysOf(kRenderBundleEncoderCommandInfo);\n\n// MAINTENANCE_TODO: remove the deprecated 'dispatch' and 'dispatchIndirect' here once they're\n// removed from `@webgpu/types`.\ntype ComputePassEncoderCommands = keyof Omit<\n  GPUComputePassEncoder,\n  '__brand' | 'label' | 'end' | 'dispatch' | 'dispatchIndirect'\n>;\nconst kComputePassEncoderCommandInfo: {\n  readonly [k in ComputePassEncoderCommands]: {};\n} = {\n  setBindGroup: {},\n  setPipeline: {},\n  dispatchWorkgroups: {},\n  dispatchWorkgroupsIndirect: {},\n  pushDebugGroup: {},\n  popDebugGroup: {},\n  insertDebugMarker: {},\n};\nconst kComputePassEncoderCommands = keysOf(kComputePassEncoderCommandInfo);\n\ng.test('non_pass_commands')\n  .desc(\n    `\n  Test that functions of GPUCommandEncoder generate a validation error if the encoder is already\n  finished.\n\n  TODO: writeTimestamp is removed from the spec so it's skipped if it TypeErrors.\n  `\n  )\n  .params(u =>\n    u\n      .combine('command', kEncoderCommands)\n      .beginSubcases()\n      .combine('finishBeforeCommand', [false, true])\n  )\n  .beforeAllSubcases(t => {\n    switch (t.params.command) {\n      case 'writeTimestamp':\n        t.selectDeviceOrSkipTestCase('timestamp-query');\n        break;\n    }\n  })\n  .fn(t => {\n    const { command, finishBeforeCommand } = t.params;\n\n    const srcBuffer = t.createBufferTracked({\n      size: 16,\n      usage: GPUBufferUsage.COPY_SRC | GPUTextureUsage.COPY_DST,\n    });\n    const dstBuffer = t.createBufferTracked({\n      size: 16,\n      usage: GPUBufferUsage.COPY_DST | GPUBufferUsage.QUERY_RESOLVE,\n    });\n\n    const textureSize = { width: 1, height: 1 };\n    const textureFormat = 'rgba8unorm';\n    const srcTexture = t.createTextureTracked({\n      size: textureSize,\n      format: textureFormat,\n      usage: GPUTextureUsage.COPY_SRC,\n    });\n    const dstTexture = t.createTextureTracked({\n      size: textureSize,\n      format: textureFormat,\n      usage: GPUTextureUsage.COPY_DST,\n    });\n\n    const querySet = t.createQuerySetTracked({\n      type: command === 'writeTimestamp' ? 'timestamp' : 'occlusion',\n      count: 1,\n    });\n\n    const encoder = t.device.createCommandEncoder();\n\n    if (finishBeforeCommand) encoder.finish();\n\n    t.expectValidationError(() => {\n      switch (command) {\n        case 'beginComputePass':\n          {\n            encoder.beginComputePass();\n          }\n          break;\n        case 'beginRenderPass':\n          {\n            encoder.beginRenderPass({ colorAttachments: [] });\n          }\n          break;\n        case 'clearBuffer':\n          {\n            encoder.clearBuffer(dstBuffer, 0, 16);\n          }\n          break;\n        case 'copyBufferToBuffer':\n          {\n            encoder.copyBufferToBuffer(srcBuffer, 0, dstBuffer, 0, 0);\n          }\n          break;\n        case 'copyBufferToTexture':\n          {\n            encoder.copyBufferToTexture(\n              { buffer: srcBuffer },\n              { texture: dstTexture },\n              textureSize\n            );\n          }\n          break;\n        case 'copyTextureToBuffer':\n          {\n            encoder.copyTextureToBuffer(\n              { texture: srcTexture },\n              { buffer: dstBuffer },\n              textureSize\n            );\n          }\n          break;\n        case 'copyTextureToTexture':\n          {\n            encoder.copyTextureToTexture(\n              { texture: srcTexture },\n              { texture: dstTexture },\n              textureSize\n            );\n          }\n          break;\n        case 'insertDebugMarker':\n          {\n            encoder.insertDebugMarker('marker');\n          }\n          break;\n        case 'pushDebugGroup':\n          {\n            encoder.pushDebugGroup('group');\n          }\n          break;\n        case 'popDebugGroup':\n          {\n            encoder.popDebugGroup();\n          }\n          break;\n        case 'writeTimestamp':\n          try {\n            // eslint-disable-next-line @typescript-eslint/no-explicit-any\n            (encoder as any).writeTimestamp(querySet, 0);\n          } catch (ex) {\n            t.skipIf(ex instanceof TypeError, 'writeTimestamp is actually not available');\n          }\n          break;\n        case 'resolveQuerySet':\n          {\n            encoder.resolveQuerySet(querySet, 0, 1, dstBuffer, 0);\n          }\n          break;\n        default:\n          unreachable();\n      }\n    }, finishBeforeCommand);\n  });\n\ng.test('render_pass_commands')\n  .desc(\n    `\n    Test that functions of GPURenderPassEncoder generate a validation error if the encoder or the\n    pass is already finished.\n\n    - TODO: Consider testing: nothing before command, end before command, end+finish before command.\n  `\n  )\n  .params(u =>\n    u\n      .combine('command', kRenderPassEncoderCommands)\n      .beginSubcases()\n      .combine('finishBeforeCommand', [false, true])\n  )\n  .fn(t => {\n    const { command, finishBeforeCommand } = t.params;\n\n    const querySet = t.createQuerySetTracked({ type: 'occlusion', count: 1 });\n    const encoder = t.device.createCommandEncoder();\n    const renderPass = beginRenderPassWithQuerySet(t, encoder, querySet);\n\n    const buffer = t.createBufferTracked({\n      size: 12,\n      usage: GPUBufferUsage.INDIRECT | GPUBufferUsage.VERTEX,\n    });\n\n    const pipeline = t.createRenderPipelineForTest();\n\n    const bindGroup = t.createBindGroupForTest();\n\n    if (finishBeforeCommand) {\n      renderPass.end();\n      encoder.finish();\n    }\n\n    t.expectValidationError(() => {\n      switch (command) {\n        case 'draw':\n          {\n            renderPass.draw(1);\n          }\n          break;\n        case 'drawIndexed':\n          {\n            renderPass.drawIndexed(1);\n          }\n          break;\n        case 'drawIndirect':\n          {\n            renderPass.drawIndirect(buffer, 1);\n          }\n          break;\n        case 'setIndexBuffer':\n          {\n            renderPass.setIndexBuffer(buffer, 'uint32');\n          }\n          break;\n        case 'drawIndexedIndirect':\n          {\n            renderPass.drawIndexedIndirect(buffer, 0);\n          }\n          break;\n        case 'setBindGroup':\n          {\n            renderPass.setBindGroup(0, bindGroup);\n          }\n          break;\n        case 'setVertexBuffer':\n          {\n            renderPass.setVertexBuffer(1, buffer);\n          }\n          break;\n        case 'setPipeline':\n          {\n            renderPass.setPipeline(pipeline);\n          }\n          break;\n        case 'setViewport':\n          {\n            const kNumTestPoints = 8;\n            const kViewportMinDepth = 0;\n            const kViewportMaxDepth = 1;\n            renderPass.setViewport(0, 0, kNumTestPoints, 0, kViewportMinDepth, kViewportMaxDepth);\n          }\n          break;\n        case 'setScissorRect':\n          {\n            renderPass.setScissorRect(0, 0, 0, 0);\n          }\n          break;\n        case 'setBlendConstant':\n          {\n            renderPass.setBlendConstant({ r: 1.0, g: 1.0, b: 1.0, a: 1.0 });\n          }\n          break;\n        case 'setStencilReference':\n          {\n            renderPass.setStencilReference(0);\n          }\n          break;\n        case 'beginOcclusionQuery':\n          {\n            renderPass.beginOcclusionQuery(0);\n          }\n          break;\n        case 'endOcclusionQuery':\n          {\n            renderPass.endOcclusionQuery();\n          }\n          break;\n        case 'executeBundles':\n          {\n            renderPass.executeBundles([]);\n          }\n          break;\n        case 'pushDebugGroup':\n          {\n            encoder.pushDebugGroup('group');\n          }\n          break;\n        case 'popDebugGroup':\n          {\n            encoder.popDebugGroup();\n          }\n          break;\n        case 'insertDebugMarker':\n          {\n            encoder.insertDebugMarker('marker');\n          }\n          break;\n        default:\n          unreachable();\n      }\n    }, finishBeforeCommand);\n  });\n\ng.test('render_bundle_commands')\n  .desc(\n    `\n    Test that functions of GPURenderBundleEncoder generate a validation error if the encoder or the\n    pass is already finished.\n  `\n  )\n  .params(u =>\n    u\n      .combine('command', kRenderBundleEncoderCommands)\n      .beginSubcases()\n      .combine('finishBeforeCommand', [false, true])\n  )\n  .fn(t => {\n    const { command, finishBeforeCommand } = t.params;\n\n    const buffer = t.createBufferTracked({\n      size: 12,\n      usage: GPUBufferUsage.INDIRECT | GPUBufferUsage.VERTEX,\n    });\n\n    const pipeline = t.createRenderPipelineForTest();\n\n    const bindGroup = t.createBindGroupForTest();\n\n    const bundleEncoder = t.device.createRenderBundleEncoder({\n      colorFormats: ['rgba8unorm'],\n    });\n\n    if (finishBeforeCommand) {\n      bundleEncoder.finish();\n    }\n\n    t.expectValidationError(() => {\n      switch (command) {\n        case 'draw':\n          {\n            bundleEncoder.draw(1);\n          }\n          break;\n        case 'drawIndexed':\n          {\n            bundleEncoder.drawIndexed(1);\n          }\n          break;\n        case 'drawIndexedIndirect':\n          {\n            bundleEncoder.drawIndexedIndirect(buffer, 0);\n          }\n          break;\n        case 'drawIndirect':\n          {\n            bundleEncoder.drawIndirect(buffer, 1);\n          }\n          break;\n        case 'setPipeline':\n          {\n            bundleEncoder.setPipeline(pipeline);\n          }\n          break;\n        case 'setBindGroup':\n          {\n            bundleEncoder.setBindGroup(0, bindGroup);\n          }\n          break;\n        case 'setIndexBuffer':\n          {\n            bundleEncoder.setIndexBuffer(buffer, 'uint32');\n          }\n          break;\n        case 'setVertexBuffer':\n          {\n            bundleEncoder.setVertexBuffer(1, buffer);\n          }\n          break;\n        case 'pushDebugGroup':\n          {\n            bundleEncoder.pushDebugGroup('group');\n          }\n          break;\n        case 'popDebugGroup':\n          {\n            bundleEncoder.popDebugGroup();\n          }\n          break;\n        case 'insertDebugMarker':\n          {\n            bundleEncoder.insertDebugMarker('marker');\n          }\n          break;\n        default:\n          unreachable();\n      }\n    }, finishBeforeCommand);\n  });\n\ng.test('compute_pass_commands')\n  .desc(\n    `\n    Test that functions of GPUComputePassEncoder generate a validation error if the encoder or the\n    pass is already finished.\n\n    - TODO: Consider testing: nothing before command, end before command, end+finish before command.\n  `\n  )\n  .params(u =>\n    u\n      .combine('command', kComputePassEncoderCommands)\n      .beginSubcases()\n      .combine('finishBeforeCommand', [false, true])\n  )\n  .fn(t => {\n    const { command, finishBeforeCommand } = t.params;\n\n    const encoder = t.device.createCommandEncoder();\n    const computePass = encoder.beginComputePass();\n\n    const indirectBuffer = t.createBufferTracked({\n      size: 12,\n      usage: GPUBufferUsage.INDIRECT,\n    });\n\n    const computePipeline = t.createNoOpComputePipeline();\n\n    const bindGroup = t.createBindGroupForTest();\n\n    if (finishBeforeCommand) {\n      computePass.end();\n      encoder.finish();\n    }\n\n    t.expectValidationError(() => {\n      switch (command) {\n        case 'setBindGroup':\n          {\n            computePass.setBindGroup(0, bindGroup);\n          }\n          break;\n        case 'setPipeline':\n          {\n            computePass.setPipeline(computePipeline);\n          }\n          break;\n        case 'dispatchWorkgroups':\n          {\n            computePass.dispatchWorkgroups(0);\n          }\n          break;\n        case 'dispatchWorkgroupsIndirect':\n          {\n            computePass.dispatchWorkgroupsIndirect(indirectBuffer, 0);\n          }\n          break;\n        case 'pushDebugGroup':\n          {\n            computePass.pushDebugGroup('group');\n          }\n          break;\n        case 'popDebugGroup':\n          {\n            computePass.popDebugGroup();\n          }\n          break;\n        case 'insertDebugMarker':\n          {\n            computePass.insertDebugMarker('marker');\n          }\n          break;\n        default:\n          unreachable();\n      }\n    }, finishBeforeCommand);\n  });\n"],"mappings":"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"}