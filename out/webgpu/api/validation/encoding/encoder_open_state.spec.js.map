{"version":3,"file":"encoder_open_state.spec.js","names":["description","makeTestGroup","keysOf","unreachable","AllFeaturesMaxLimitsGPUTest","vtu","beginRenderPassWithQuerySet","F","createRenderPipelineForTest","device","createRenderPipeline","layout","vertex","module","createShaderModule","code","entryPoint","fragment","targets","format","writeMask","createBindGroupForTest","createBindGroup","entries","binding","resource","createSampler","createBindGroupLayout","visibility","GPUShaderStage","FRAGMENT","sampler","type","g","kEncoderCommandInfo","beginComputePass","beginRenderPass","clearBuffer","copyBufferToBuffer","copyBufferToTexture","copyTextureToBuffer","copyTextureToTexture","insertDebugMarker","popDebugGroup","pushDebugGroup","writeTimestamp","resolveQuerySet","kEncoderCommands","kRenderPassEncoderCommandInfo","draw","drawIndexed","drawIndexedIndirect","drawIndirect","multiDrawIndexedIndirect","multiDrawIndirect","setIndexBuffer","setBindGroup","setVertexBuffer","setPipeline","setViewport","setScissorRect","setBlendConstant","setStencilReference","beginOcclusionQuery","endOcclusionQuery","executeBundles","kRenderPassEncoderCommands","kRenderBundleEncoderCommandInfo","kRenderBundleEncoderCommands","kComputePassEncoderCommandInfo","dispatchWorkgroups","dispatchWorkgroupsIndirect","kComputePassEncoderCommands","test","desc","params","u","combine","beginSubcases","fn","t","command","finishBeforeCommand","skipIfDeviceDoesNotSupportQueryType","srcBuffer","createBufferTracked","size","usage","GPUBufferUsage","COPY_SRC","GPUTextureUsage","COPY_DST","dstBuffer","QUERY_RESOLVE","textureSize","width","height","textureFormat","srcTexture","createTextureTracked","dstTexture","querySet","createQuerySetTracked","count","encoder","createCommandEncoder","finish","expectValidationError","colorAttachments","buffer","texture","ex","skipIf","TypeError","skipIfDeviceDoesNotHaveFeature","renderPass","INDIRECT","VERTEX","pipeline","bindGroup","end","kNumTestPoints","kViewportMinDepth","kViewportMaxDepth","r","b","a","bundleEncoder","createRenderBundleEncoder","colorFormats","computePass","indirectBuffer","computePipeline","createNoOpComputePipeline"],"sources":["../../../../../src/webgpu/api/validation/encoding/encoder_open_state.spec.ts"],"sourcesContent":["export const description = `\nValidation tests to all commands of GPUCommandEncoder, GPUComputePassEncoder, and\nGPURenderPassEncoder when the encoder is not finished.\n`;\n\nimport { makeTestGroup } from '../../../../common/framework/test_group.js';\nimport { keysOf } from '../../../../common/util/data_tables.js';\nimport { unreachable } from '../../../../common/util/util.js';\nimport { AllFeaturesMaxLimitsGPUTest } from '../../../gpu_test.js';\nimport * as vtu from '../validation_test_utils.js';\n\nimport { beginRenderPassWithQuerySet } from './queries/common.js';\n\nclass F extends AllFeaturesMaxLimitsGPUTest {\n  createRenderPipelineForTest(): GPURenderPipeline {\n    return this.device.createRenderPipeline({\n      layout: 'auto',\n      vertex: {\n        module: this.device.createShaderModule({\n          code: `\n            @vertex fn main() -> @builtin(position) vec4<f32> {\n              return vec4<f32>();\n            }\n          `,\n        }),\n        entryPoint: 'main',\n      },\n      fragment: {\n        module: this.device.createShaderModule({\n          code: `@fragment fn main() {}`,\n        }),\n        entryPoint: 'main',\n        targets: [{ format: 'rgba8unorm', writeMask: 0 }],\n      },\n    });\n  }\n\n  createBindGroupForTest(): GPUBindGroup {\n    return this.device.createBindGroup({\n      entries: [\n        {\n          binding: 0,\n          resource: this.device.createSampler(),\n        },\n      ],\n      layout: this.device.createBindGroupLayout({\n        entries: [\n          {\n            binding: 0,\n            visibility: GPUShaderStage.FRAGMENT,\n            sampler: { type: 'filtering' },\n          },\n        ],\n      }),\n    });\n  }\n}\n\nexport const g = makeTestGroup(F);\n\n// MAINTENANCE_TODO: Remove writeTimestamp from here once it's (hopefully) added back to the spec.\ntype EncoderCommands =\n  | keyof Omit<GPUCommandEncoder, '__brand' | 'label' | 'finish'>\n  | 'writeTimestamp';\nconst kEncoderCommandInfo: {\n  readonly [k in EncoderCommands]: {};\n} = {\n  beginComputePass: {},\n  beginRenderPass: {},\n  clearBuffer: {},\n  copyBufferToBuffer: {},\n  copyBufferToTexture: {},\n  copyTextureToBuffer: {},\n  copyTextureToTexture: {},\n  insertDebugMarker: {},\n  popDebugGroup: {},\n  pushDebugGroup: {},\n  writeTimestamp: {},\n  resolveQuerySet: {},\n};\nconst kEncoderCommands = keysOf(kEncoderCommandInfo);\n\n// MAINTENANCE_TODO: Remove multiDrawIndirect and multiDrawIndexedIndirect once https://github.com/gpuweb/gpuweb/pull/2315 is merged.\ntype RenderPassEncoderCommands =\n  | keyof Omit<GPURenderPassEncoder, '__brand' | 'label' | 'end'>\n  | 'multiDrawIndirect'\n  | 'multiDrawIndexedIndirect';\nconst kRenderPassEncoderCommandInfo: {\n  readonly [k in RenderPassEncoderCommands]: {};\n} = {\n  draw: {},\n  drawIndexed: {},\n  drawIndexedIndirect: {},\n  drawIndirect: {},\n  multiDrawIndexedIndirect: {},\n  multiDrawIndirect: {},\n  setIndexBuffer: {},\n  setBindGroup: {},\n  setVertexBuffer: {},\n  setPipeline: {},\n  setViewport: {},\n  setScissorRect: {},\n  setBlendConstant: {},\n  setStencilReference: {},\n  beginOcclusionQuery: {},\n  endOcclusionQuery: {},\n  executeBundles: {},\n  pushDebugGroup: {},\n  popDebugGroup: {},\n  insertDebugMarker: {},\n};\nconst kRenderPassEncoderCommands = keysOf(kRenderPassEncoderCommandInfo);\n\ntype RenderBundleEncoderCommands = keyof Omit<\n  GPURenderBundleEncoder,\n  '__brand' | 'label' | 'finish'\n>;\nconst kRenderBundleEncoderCommandInfo: {\n  readonly [k in RenderBundleEncoderCommands]: {};\n} = {\n  draw: {},\n  drawIndexed: {},\n  drawIndexedIndirect: {},\n  drawIndirect: {},\n  setPipeline: {},\n  setBindGroup: {},\n  setIndexBuffer: {},\n  setVertexBuffer: {},\n  pushDebugGroup: {},\n  popDebugGroup: {},\n  insertDebugMarker: {},\n};\nconst kRenderBundleEncoderCommands = keysOf(kRenderBundleEncoderCommandInfo);\n\n// MAINTENANCE_TODO: remove the deprecated 'dispatch' and 'dispatchIndirect' here once they're\n// removed from `@webgpu/types`.\ntype ComputePassEncoderCommands = keyof Omit<\n  GPUComputePassEncoder,\n  '__brand' | 'label' | 'end' | 'dispatch' | 'dispatchIndirect'\n>;\nconst kComputePassEncoderCommandInfo: {\n  readonly [k in ComputePassEncoderCommands]: {};\n} = {\n  setBindGroup: {},\n  setPipeline: {},\n  dispatchWorkgroups: {},\n  dispatchWorkgroupsIndirect: {},\n  pushDebugGroup: {},\n  popDebugGroup: {},\n  insertDebugMarker: {},\n};\nconst kComputePassEncoderCommands = keysOf(kComputePassEncoderCommandInfo);\n\ng.test('non_pass_commands')\n  .desc(\n    `\n  Test that functions of GPUCommandEncoder generate a validation error if the encoder is already\n  finished.\n\n  TODO: writeTimestamp is removed from the spec so it's skipped if it TypeErrors.\n  `\n  )\n  .params(u =>\n    u\n      .combine('command', kEncoderCommands)\n      .beginSubcases()\n      .combine('finishBeforeCommand', [false, true])\n  )\n  .fn(t => {\n    const { command, finishBeforeCommand } = t.params;\n    if (command === 'writeTimestamp') {\n      t.skipIfDeviceDoesNotSupportQueryType('timestamp');\n    }\n\n    const srcBuffer = t.createBufferTracked({\n      size: 16,\n      usage: GPUBufferUsage.COPY_SRC | GPUTextureUsage.COPY_DST,\n    });\n    const dstBuffer = t.createBufferTracked({\n      size: 16,\n      usage: GPUBufferUsage.COPY_DST | GPUBufferUsage.QUERY_RESOLVE,\n    });\n\n    const textureSize = { width: 1, height: 1 };\n    const textureFormat = 'rgba8unorm';\n    const srcTexture = t.createTextureTracked({\n      size: textureSize,\n      format: textureFormat,\n      usage: GPUTextureUsage.COPY_SRC,\n    });\n    const dstTexture = t.createTextureTracked({\n      size: textureSize,\n      format: textureFormat,\n      usage: GPUTextureUsage.COPY_DST,\n    });\n\n    const querySet = t.createQuerySetTracked({\n      type: command === 'writeTimestamp' ? 'timestamp' : 'occlusion',\n      count: 1,\n    });\n\n    const encoder = t.device.createCommandEncoder();\n\n    if (finishBeforeCommand) encoder.finish();\n\n    t.expectValidationError(() => {\n      switch (command) {\n        case 'beginComputePass':\n          {\n            encoder.beginComputePass();\n          }\n          break;\n        case 'beginRenderPass':\n          {\n            encoder.beginRenderPass({ colorAttachments: [] });\n          }\n          break;\n        case 'clearBuffer':\n          {\n            encoder.clearBuffer(dstBuffer, 0, 16);\n          }\n          break;\n        case 'copyBufferToBuffer':\n          {\n            encoder.copyBufferToBuffer(srcBuffer, 0, dstBuffer, 0, 0);\n          }\n          break;\n        case 'copyBufferToTexture':\n          {\n            encoder.copyBufferToTexture(\n              { buffer: srcBuffer },\n              { texture: dstTexture },\n              textureSize\n            );\n          }\n          break;\n        case 'copyTextureToBuffer':\n          {\n            encoder.copyTextureToBuffer(\n              { texture: srcTexture },\n              { buffer: dstBuffer },\n              textureSize\n            );\n          }\n          break;\n        case 'copyTextureToTexture':\n          {\n            encoder.copyTextureToTexture(\n              { texture: srcTexture },\n              { texture: dstTexture },\n              textureSize\n            );\n          }\n          break;\n        case 'insertDebugMarker':\n          {\n            encoder.insertDebugMarker('marker');\n          }\n          break;\n        case 'pushDebugGroup':\n          {\n            encoder.pushDebugGroup('group');\n          }\n          break;\n        case 'popDebugGroup':\n          {\n            encoder.popDebugGroup();\n          }\n          break;\n        case 'writeTimestamp':\n          try {\n            // eslint-disable-next-line @typescript-eslint/no-explicit-any\n            (encoder as any).writeTimestamp(querySet, 0);\n          } catch (ex) {\n            t.skipIf(ex instanceof TypeError, 'writeTimestamp is actually not available');\n          }\n          break;\n        case 'resolveQuerySet':\n          {\n            encoder.resolveQuerySet(querySet, 0, 1, dstBuffer, 0);\n          }\n          break;\n        default:\n          unreachable();\n      }\n    }, finishBeforeCommand);\n  });\n\ng.test('render_pass_commands')\n  .desc(\n    `\n    Test that functions of GPURenderPassEncoder generate a validation error if the encoder or the\n    pass is already finished.\n\n    - TODO: Consider testing: nothing before command, end before command, end+finish before command.\n  `\n  )\n  .params(u =>\n    u\n      .combine('command', kRenderPassEncoderCommands)\n      .beginSubcases()\n      .combine('finishBeforeCommand', [false, true])\n  )\n  .fn(t => {\n    const { command, finishBeforeCommand } = t.params;\n    if (command === 'multiDrawIndirect' || command === 'multiDrawIndexedIndirect') {\n      t.skipIfDeviceDoesNotHaveFeature(\n        'chromium-experimental-multi-draw-indirect' as GPUFeatureName\n      );\n    }\n\n    const querySet = t.createQuerySetTracked({ type: 'occlusion', count: 1 });\n    const encoder = t.device.createCommandEncoder();\n    const renderPass = beginRenderPassWithQuerySet(t, encoder, querySet);\n\n    const buffer = t.createBufferTracked({\n      size: 12,\n      usage: GPUBufferUsage.INDIRECT | GPUBufferUsage.VERTEX,\n    });\n\n    const pipeline = t.createRenderPipelineForTest();\n\n    const bindGroup = t.createBindGroupForTest();\n\n    if (finishBeforeCommand) {\n      renderPass.end();\n      encoder.finish();\n    }\n\n    t.expectValidationError(() => {\n      switch (command) {\n        case 'draw':\n          {\n            renderPass.draw(1);\n          }\n          break;\n        case 'drawIndexed':\n          {\n            renderPass.drawIndexed(1);\n          }\n          break;\n        case 'drawIndirect':\n          {\n            renderPass.drawIndirect(buffer, 1);\n          }\n          break;\n        case 'setIndexBuffer':\n          {\n            renderPass.setIndexBuffer(buffer, 'uint32');\n          }\n          break;\n        case 'drawIndexedIndirect':\n          {\n            renderPass.drawIndexedIndirect(buffer, 0);\n          }\n          break;\n        case 'multiDrawIndirect':\n          {\n            // eslint-disable-next-line @typescript-eslint/no-explicit-any\n            (renderPass as any).multiDrawIndirect(buffer, 0, 1);\n          }\n          break;\n        case 'multiDrawIndexedIndirect':\n          {\n            // eslint-disable-next-line @typescript-eslint/no-explicit-any\n            (renderPass as any).multiDrawIndexedIndirect(buffer, 0, 1);\n          }\n          break;\n        case 'setBindGroup':\n          {\n            renderPass.setBindGroup(0, bindGroup);\n          }\n          break;\n        case 'setVertexBuffer':\n          {\n            renderPass.setVertexBuffer(1, buffer);\n          }\n          break;\n        case 'setPipeline':\n          {\n            renderPass.setPipeline(pipeline);\n          }\n          break;\n        case 'setViewport':\n          {\n            const kNumTestPoints = 8;\n            const kViewportMinDepth = 0;\n            const kViewportMaxDepth = 1;\n            renderPass.setViewport(0, 0, kNumTestPoints, 0, kViewportMinDepth, kViewportMaxDepth);\n          }\n          break;\n        case 'setScissorRect':\n          {\n            renderPass.setScissorRect(0, 0, 0, 0);\n          }\n          break;\n        case 'setBlendConstant':\n          {\n            renderPass.setBlendConstant({ r: 1.0, g: 1.0, b: 1.0, a: 1.0 });\n          }\n          break;\n        case 'setStencilReference':\n          {\n            renderPass.setStencilReference(0);\n          }\n          break;\n        case 'beginOcclusionQuery':\n          {\n            renderPass.beginOcclusionQuery(0);\n          }\n          break;\n        case 'endOcclusionQuery':\n          {\n            renderPass.endOcclusionQuery();\n          }\n          break;\n        case 'executeBundles':\n          {\n            renderPass.executeBundles([]);\n          }\n          break;\n        case 'pushDebugGroup':\n          {\n            encoder.pushDebugGroup('group');\n          }\n          break;\n        case 'popDebugGroup':\n          {\n            encoder.popDebugGroup();\n          }\n          break;\n        case 'insertDebugMarker':\n          {\n            encoder.insertDebugMarker('marker');\n          }\n          break;\n        default:\n          unreachable();\n      }\n    }, finishBeforeCommand);\n  });\n\ng.test('render_bundle_commands')\n  .desc(\n    `\n    Test that functions of GPURenderBundleEncoder generate a validation error if the encoder or the\n    pass is already finished.\n  `\n  )\n  .params(u =>\n    u\n      .combine('command', kRenderBundleEncoderCommands)\n      .beginSubcases()\n      .combine('finishBeforeCommand', [false, true])\n  )\n  .fn(t => {\n    const { command, finishBeforeCommand } = t.params;\n\n    const buffer = t.createBufferTracked({\n      size: 12,\n      usage: GPUBufferUsage.INDIRECT | GPUBufferUsage.VERTEX,\n    });\n\n    const pipeline = t.createRenderPipelineForTest();\n\n    const bindGroup = t.createBindGroupForTest();\n\n    const bundleEncoder = t.device.createRenderBundleEncoder({\n      colorFormats: ['rgba8unorm'],\n    });\n\n    if (finishBeforeCommand) {\n      bundleEncoder.finish();\n    }\n\n    t.expectValidationError(() => {\n      switch (command) {\n        case 'draw':\n          {\n            bundleEncoder.draw(1);\n          }\n          break;\n        case 'drawIndexed':\n          {\n            bundleEncoder.drawIndexed(1);\n          }\n          break;\n        case 'drawIndexedIndirect':\n          {\n            bundleEncoder.drawIndexedIndirect(buffer, 0);\n          }\n          break;\n        case 'drawIndirect':\n          {\n            bundleEncoder.drawIndirect(buffer, 1);\n          }\n          break;\n        case 'setPipeline':\n          {\n            bundleEncoder.setPipeline(pipeline);\n          }\n          break;\n        case 'setBindGroup':\n          {\n            bundleEncoder.setBindGroup(0, bindGroup);\n          }\n          break;\n        case 'setIndexBuffer':\n          {\n            bundleEncoder.setIndexBuffer(buffer, 'uint32');\n          }\n          break;\n        case 'setVertexBuffer':\n          {\n            bundleEncoder.setVertexBuffer(1, buffer);\n          }\n          break;\n        case 'pushDebugGroup':\n          {\n            bundleEncoder.pushDebugGroup('group');\n          }\n          break;\n        case 'popDebugGroup':\n          {\n            bundleEncoder.popDebugGroup();\n          }\n          break;\n        case 'insertDebugMarker':\n          {\n            bundleEncoder.insertDebugMarker('marker');\n          }\n          break;\n        default:\n          unreachable();\n      }\n    }, finishBeforeCommand);\n  });\n\ng.test('compute_pass_commands')\n  .desc(\n    `\n    Test that functions of GPUComputePassEncoder generate a validation error if the encoder or the\n    pass is already finished.\n\n    - TODO: Consider testing: nothing before command, end before command, end+finish before command.\n  `\n  )\n  .params(u =>\n    u\n      .combine('command', kComputePassEncoderCommands)\n      .beginSubcases()\n      .combine('finishBeforeCommand', [false, true])\n  )\n  .fn(t => {\n    const { command, finishBeforeCommand } = t.params;\n\n    const encoder = t.device.createCommandEncoder();\n    const computePass = encoder.beginComputePass();\n\n    const indirectBuffer = t.createBufferTracked({\n      size: 12,\n      usage: GPUBufferUsage.INDIRECT,\n    });\n\n    const computePipeline = vtu.createNoOpComputePipeline(t);\n\n    const bindGroup = t.createBindGroupForTest();\n\n    if (finishBeforeCommand) {\n      computePass.end();\n      encoder.finish();\n    }\n\n    t.expectValidationError(() => {\n      switch (command) {\n        case 'setBindGroup':\n          {\n            computePass.setBindGroup(0, bindGroup);\n          }\n          break;\n        case 'setPipeline':\n          {\n            computePass.setPipeline(computePipeline);\n          }\n          break;\n        case 'dispatchWorkgroups':\n          {\n            computePass.dispatchWorkgroups(0);\n          }\n          break;\n        case 'dispatchWorkgroupsIndirect':\n          {\n            computePass.dispatchWorkgroupsIndirect(indirectBuffer, 0);\n          }\n          break;\n        case 'pushDebugGroup':\n          {\n            computePass.pushDebugGroup('group');\n          }\n          break;\n        case 'popDebugGroup':\n          {\n            computePass.popDebugGroup();\n          }\n          break;\n        case 'insertDebugMarker':\n          {\n            computePass.insertDebugMarker('marker');\n          }\n          break;\n        default:\n          unreachable();\n      }\n    }, finishBeforeCommand);\n  });\n"],"mappings":"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"}