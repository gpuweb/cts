{"version":3,"file":"encoder_state.spec.js","names":["description","makeTestGroup","AllFeaturesMaxLimitsGPUTest","F","beginRenderPass","commandEncoder","view","colorAttachments","clearValue","r","g","b","a","loadOp","storeOp","createAttachmentTextureView","texture","createTextureTracked","format","size","width","height","depthOrArrayLayers","usage","GPUTextureUsage","RENDER_ATTACHMENT","createView","test","desc","params","u","combine","beginSubcases","fn","t","pass0Type","pass1Type","firstPassEnd","endPasses","encoder","device","createCommandEncoder","firstPass","beginComputePass","end","secondPass","passes","index","validEnd","expectValidationError","validFinish","includes","finish","prePassType","IsEncoderFinished","callCmd","pass","buffer","queue","submit","secondBuffer","insertDebugMarker","startsWith","paramsSubcasesOnly","passType","endCount","i","filter","p","endTwice","secondEndInAnotherPass","pass1","firstPassInvalid","popDebugGroup"],"sources":["../../../../../src/webgpu/api/validation/encoding/encoder_state.spec.ts"],"sourcesContent":["export const description = `\nTODO:\n- createCommandEncoder\n- non-pass command, or beginPass, during {render, compute} pass\n- {before (control case), after} finish()\n    - x= {finish(), ... all non-pass commands}\n- {before (control case), after} end()\n    - x= {render, compute} pass\n    - x= {finish(), ... all relevant pass commands}\n    - x= {\n        - before endPass (control case)\n        - after endPass (no pass open)\n        - after endPass+beginPass (a new pass of the same type is open)\n        - }\n    - should make whole encoder invalid\n- ?\n`;\n\nimport { makeTestGroup } from '../../../../common/framework/test_group.js';\nimport { AllFeaturesMaxLimitsGPUTest } from '../../../gpu_test.js';\n\nclass F extends AllFeaturesMaxLimitsGPUTest {\n  beginRenderPass(commandEncoder: GPUCommandEncoder, view: GPUTextureView): GPURenderPassEncoder {\n    return commandEncoder.beginRenderPass({\n      colorAttachments: [\n        {\n          view,\n          clearValue: { r: 1.0, g: 0.0, b: 0.0, a: 1.0 },\n          loadOp: 'clear',\n          storeOp: 'store',\n        },\n      ],\n    });\n  }\n\n  createAttachmentTextureView(): GPUTextureView {\n    const texture = this.createTextureTracked({\n      format: 'rgba8unorm',\n      size: { width: 1, height: 1, depthOrArrayLayers: 1 },\n      usage: GPUTextureUsage.RENDER_ATTACHMENT,\n    });\n    return texture.createView();\n  }\n}\n\nexport const g = makeTestGroup(F);\n\ng.test('pass_end_invalid_order')\n  .desc(\n    `\n  Test that beginning a {compute,render} pass before ending the previous {compute,render} pass\n  causes an error.\n  `\n  )\n  .params(u =>\n    u\n      .combine('pass0Type', ['compute', 'render'])\n      .combine('pass1Type', ['compute', 'render'])\n      .beginSubcases()\n      .combine('firstPassEnd', [true, false])\n      .combine('endPasses', [[], [0], [1], [0, 1], [1, 0]])\n  )\n  .fn(t => {\n    const { pass0Type, pass1Type, firstPassEnd, endPasses } = t.params;\n\n    const view = t.createAttachmentTextureView();\n    const encoder = t.device.createCommandEncoder();\n\n    const firstPass =\n      pass0Type === 'compute' ? encoder.beginComputePass() : t.beginRenderPass(encoder, view);\n\n    if (firstPassEnd) firstPass.end();\n\n    // Begin a second pass before ending the previous pass.\n    const secondPass =\n      pass1Type === 'compute' ? encoder.beginComputePass() : t.beginRenderPass(encoder, view);\n\n    const passes = [firstPass, secondPass];\n    for (const index of endPasses) {\n      const validEnd = (index === 0 && !firstPassEnd) || (index === 1 && firstPassEnd);\n      t.expectValidationError(() => {\n        passes[index].end();\n      }, !validEnd);\n    }\n\n    const validFinish = firstPassEnd && endPasses.includes(1);\n    t.expectValidationError(() => {\n      encoder.finish();\n    }, !validFinish);\n  });\n\ng.test('call_after_successful_finish')\n  .desc(`Test that encoding command after a successful finish generates a validation error.`)\n  .params(u =>\n    u\n      .combine('callCmd', [\n        'beginComputePass',\n        'beginRenderPass',\n        'finishAndSubmitFirst',\n        'finishAndSubmitSecond',\n        'insertDebugMarker',\n      ])\n      .beginSubcases()\n      .combine('prePassType', ['compute', 'render', 'no-op'])\n      .combine('IsEncoderFinished', [false, true])\n  )\n  .fn(t => {\n    const { prePassType, IsEncoderFinished, callCmd } = t.params;\n\n    const view = t.createAttachmentTextureView();\n    const encoder = t.device.createCommandEncoder();\n\n    if (prePassType !== 'no-op') {\n      const pass =\n        prePassType === 'compute' ? encoder.beginComputePass() : t.beginRenderPass(encoder, view);\n      pass.end();\n    }\n\n    let buffer;\n    if (IsEncoderFinished) {\n      buffer = encoder.finish();\n    }\n\n    switch (callCmd) {\n      case 'beginComputePass':\n        {\n          let pass: GPUComputePassEncoder;\n          t.expectValidationError(() => {\n            pass = encoder.beginComputePass();\n          }, IsEncoderFinished);\n          t.expectValidationError(() => {\n            pass.end();\n          }, IsEncoderFinished);\n          if (buffer) {\n            t.device.queue.submit([buffer]);\n          }\n        }\n        break;\n      case 'beginRenderPass':\n        {\n          let pass: GPURenderPassEncoder;\n          t.expectValidationError(() => {\n            pass = t.beginRenderPass(encoder, view);\n          }, IsEncoderFinished);\n          t.expectValidationError(() => {\n            pass.end();\n          }, IsEncoderFinished);\n          if (buffer) {\n            t.device.queue.submit([buffer]);\n          }\n        }\n        break;\n      case 'finishAndSubmitFirst':\n        t.expectValidationError(() => {\n          encoder.finish();\n        }, IsEncoderFinished);\n        if (buffer) {\n          t.device.queue.submit([buffer]);\n        }\n        break;\n      case 'finishAndSubmitSecond':\n        {\n          let secondBuffer: GPUCommandBuffer;\n          t.expectValidationError(() => {\n            secondBuffer = encoder.finish();\n          }, IsEncoderFinished);\n          t.expectValidationError(() => {\n            t.device.queue.submit([secondBuffer]);\n          }, IsEncoderFinished);\n        }\n        break;\n      case 'insertDebugMarker':\n        t.expectValidationError(() => {\n          encoder.insertDebugMarker('');\n        }, IsEncoderFinished);\n        if (buffer) {\n          t.device.queue.submit([buffer]);\n        }\n        break;\n    }\n\n    if (!IsEncoderFinished && !callCmd.startsWith('finish')) {\n      encoder.finish();\n    }\n  });\n\ng.test('pass_end_none')\n  .desc(\n    `\n  Test that finishing an encoder without ending a child {compute,render} pass generates a validation error.\n  `\n  )\n  .paramsSubcasesOnly(u => u.combine('passType', ['compute', 'render']).combine('endCount', [0, 1]))\n  .fn(t => {\n    const { passType, endCount } = t.params;\n\n    const view = t.createAttachmentTextureView();\n    const encoder = t.device.createCommandEncoder();\n\n    const pass =\n      passType === 'compute' ? encoder.beginComputePass() : t.beginRenderPass(encoder, view);\n\n    for (let i = 0; i < endCount; ++i) {\n      pass.end();\n    }\n\n    t.expectValidationError(() => {\n      encoder.finish();\n    }, endCount === 0);\n  });\n\ng.test('pass_end_twice,basic')\n  .desc(\n    'Test that ending a {compute,render} pass twice generates a validation error. The parent encoder (command encoder) can be either locked or open.'\n  )\n  .paramsSubcasesOnly(u =>\n    u //\n      .combine('passType', ['compute', 'render'])\n      // Simply end twice, the parent encoder is open at that time. If the second pass end is in the middle of another pass, the parent encoder is locked. It should generate a validation error in either situation.\n      .combine('endTwice', [false, true])\n      .combine('secondEndInAnotherPass', [false, 'compute', 'render'])\n      .filter(p => p.endTwice || !p.secondEndInAnotherPass)\n  )\n  .fn(t => {\n    const { passType, endTwice, secondEndInAnotherPass } = t.params;\n\n    const view = t.createAttachmentTextureView();\n    const encoder = t.device.createCommandEncoder();\n\n    const pass =\n      passType === 'compute' ? encoder.beginComputePass() : t.beginRenderPass(encoder, view);\n\n    pass.end();\n\n    if (secondEndInAnotherPass) {\n      const pass1 =\n        secondEndInAnotherPass === 'compute'\n          ? encoder.beginComputePass()\n          : t.beginRenderPass(encoder, view);\n\n      t.expectValidationError(() => {\n        pass.end();\n      });\n\n      pass1.end();\n    } else {\n      if (endTwice) {\n        t.expectValidationError(() => {\n          pass.end();\n        });\n      }\n    }\n\n    encoder.finish();\n  });\n\ng.test('pass_end_twice,render_pass_invalid')\n  .desc(\n    'Test that ending a render pass twice generates a validation error even if the pass is invalid.'\n  )\n  .paramsSubcasesOnly(u => u.combine('endTwice', [false, true]))\n  .fn(t => {\n    const { endTwice } = t.params;\n\n    const encoder = t.device.createCommandEncoder();\n    // Pass encoder creation will fail because both color and depth/stencil attachments are empty.\n    const pass = encoder.beginRenderPass({\n      colorAttachments: [],\n    });\n\n    pass.end();\n\n    if (endTwice) {\n      t.expectValidationError(() => {\n        pass.end();\n      });\n    }\n\n    t.expectValidationError(() => {\n      encoder.finish();\n    });\n  });\n\ng.test('pass_begin_invalid_encoder')\n  .desc(\n    `\n  Test that {compute,render} passes can still be opened on an invalid encoder.\n  `\n  )\n  .params(u =>\n    u\n      .combine('pass0Type', ['compute', 'render'])\n      .combine('pass1Type', ['compute', 'render'])\n      .beginSubcases()\n      .combine('firstPassInvalid', [false, true])\n  )\n  .fn(t => {\n    const { pass0Type, pass1Type, firstPassInvalid } = t.params;\n\n    const view = t.createAttachmentTextureView();\n\n    const encoder = t.device.createCommandEncoder();\n\n    let firstPass;\n    if (pass0Type === 'compute') {\n      firstPass = encoder.beginComputePass();\n    } else {\n      firstPass = t.beginRenderPass(encoder, view);\n    }\n\n    if (firstPassInvalid) {\n      // Popping an empty debug group stack invalidates the pass.\n      firstPass.popDebugGroup();\n    }\n\n    // Ending an invalid pass invalidates the encoder\n    firstPass.end();\n\n    // Passes can still be opened on an invalid encoder\n    const secondPass =\n      pass1Type === 'compute' ? encoder.beginComputePass() : t.beginRenderPass(encoder, view);\n\n    secondPass.end();\n\n    t.expectValidationError(() => {\n      encoder.finish();\n    }, firstPassInvalid);\n  });\n"],"mappings":"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"}