{"version":3,"sources":["../../../../src/webgpu/api/validation/render_pass_descriptor.spec.ts"],"names":["description","makeTestGroup","kRenderableColorTextureFormats","kTextureFormatInfo","ValidationTest","F","createTexture","options","format","width","height","arrayLayerCount","mipLevelCount","sampleCount","usage","GPUTextureUsage","RENDER_ATTACHMENT","device","size","depthOrArrayLayers","getColorAttachment","texture","textureViewDescriptor","view","createView","clearValue","r","g","b","a","loadOp","storeOp","getDepthStencilAttachment","depthClearValue","depthLoadOp","depthStoreOp","stencilClearValue","stencilLoadOp","stencilStoreOp","tryRenderPass","success","descriptor","commandEncoder","createCommandEncoder","renderPass","beginRenderPass","end","expectValidationError","finish","test","fn","t","colorTexture","colorAttachments","depthStencilTexture","depthStencilAttachment","paramsSimple","colorAttachmentsCount","_success","params","i","push","colorTexture1x1A","colorTexture1x1B","colorTexture2x2","depthStencilTexture1x1","depthStencilTexture2x2","baseArrayLayer","ARRAY_LAYER_COUNT","MIP_LEVEL_COUNT","COLOR_FORMAT","DEPTH_STENCIL_FORMAT","baseTextureViewDescriptor","dimension","baseMipLevel","resolveTargetTexture","resolveTarget","multisampledColorTexture","multisampledResolveTargetTexture","colorAttachment","COPY_SRC","COPY_DST","resolveTargetTextureView","multisampledDepthStencilTexture","u","combine","filter","multisample","resolve"],"mappings":"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","sourcesContent":["export const description = `\nrender pass descriptor validation tests.\n\nTODO: per-test descriptions, make test names more succinct\nTODO: review for completeness\n`;\n\nimport { makeTestGroup } from '../../../common/framework/test_group.js';\nimport { kRenderableColorTextureFormats, kTextureFormatInfo } from '../../capability_info.js';\n\nimport { ValidationTest } from './validation_test.js';\n\nclass F extends ValidationTest {\n  createTexture(\n    options: {\n      format?: GPUTextureFormat;\n      width?: number;\n      height?: number;\n      arrayLayerCount?: number;\n      mipLevelCount?: number;\n      sampleCount?: number;\n      usage?: GPUTextureUsageFlags;\n    } = {}\n  ): GPUTexture {\n    const {\n      format = 'rgba8unorm',\n      width = 16,\n      height = 16,\n      arrayLayerCount = 1,\n      mipLevelCount = 1,\n      sampleCount = 1,\n      usage = GPUTextureUsage.RENDER_ATTACHMENT,\n    } = options;\n\n    return this.device.createTexture({\n      size: { width, height, depthOrArrayLayers: arrayLayerCount },\n      format,\n      mipLevelCount,\n      sampleCount,\n      usage,\n    });\n  }\n\n  getColorAttachment(\n    texture: GPUTexture,\n    textureViewDescriptor?: GPUTextureViewDescriptor\n  ): GPURenderPassColorAttachment {\n    const view = texture.createView(textureViewDescriptor);\n\n    return {\n      view,\n      clearValue: { r: 1.0, g: 0.0, b: 0.0, a: 1.0 },\n      loadOp: 'clear',\n      storeOp: 'store',\n    };\n  }\n\n  getDepthStencilAttachment(\n    texture: GPUTexture,\n    textureViewDescriptor?: GPUTextureViewDescriptor\n  ): GPURenderPassDepthStencilAttachment {\n    const view = texture.createView(textureViewDescriptor);\n\n    return {\n      view,\n      depthClearValue: 1.0,\n      depthLoadOp: 'clear',\n      depthStoreOp: 'store',\n      stencilClearValue: 0,\n      stencilLoadOp: 'clear',\n      stencilStoreOp: 'store',\n    };\n  }\n\n  async tryRenderPass(success: boolean, descriptor: GPURenderPassDescriptor): Promise<void> {\n    const commandEncoder = this.device.createCommandEncoder();\n    const renderPass = commandEncoder.beginRenderPass(descriptor);\n    renderPass.end();\n\n    this.expectValidationError(() => {\n      commandEncoder.finish();\n    }, !success);\n  }\n}\n\nexport const g = makeTestGroup(F);\n\ng.test('a_render_pass_with_only_one_color_is_ok').fn(t => {\n  const colorTexture = t.createTexture({ format: 'rgba8unorm' });\n  const descriptor = {\n    colorAttachments: [t.getColorAttachment(colorTexture)],\n  };\n\n  t.tryRenderPass(true, descriptor);\n});\n\ng.test('a_render_pass_with_only_one_depth_attachment_is_ok').fn(t => {\n  const depthStencilTexture = t.createTexture({ format: 'depth24plus-stencil8' });\n  const descriptor = {\n    colorAttachments: [],\n    depthStencilAttachment: t.getDepthStencilAttachment(depthStencilTexture),\n  };\n\n  t.tryRenderPass(true, descriptor);\n});\n\ng.test('OOB_color_attachment_indices_are_handled')\n  .paramsSimple([\n    { colorAttachmentsCount: 8, _success: true }, // Control case\n    { colorAttachmentsCount: 9, _success: false }, // Out of bounds\n  ])\n  .fn(async t => {\n    const { colorAttachmentsCount, _success } = t.params;\n\n    const colorAttachments = [];\n    for (let i = 0; i < colorAttachmentsCount; i++) {\n      const colorTexture = t.createTexture();\n      colorAttachments.push(t.getColorAttachment(colorTexture));\n    }\n\n    await t.tryRenderPass(_success, { colorAttachments });\n  });\n\ng.test('attachments_must_have_the_same_size').fn(async t => {\n  const colorTexture1x1A = t.createTexture({ width: 1, height: 1, format: 'rgba8unorm' });\n  const colorTexture1x1B = t.createTexture({ width: 1, height: 1, format: 'rgba8unorm' });\n  const colorTexture2x2 = t.createTexture({ width: 2, height: 2, format: 'rgba8unorm' });\n  const depthStencilTexture1x1 = t.createTexture({\n    width: 1,\n    height: 1,\n    format: 'depth24plus-stencil8',\n  });\n  const depthStencilTexture2x2 = t.createTexture({\n    width: 2,\n    height: 2,\n    format: 'depth24plus-stencil8',\n  });\n\n  {\n    // Control case: all the same size (1x1)\n    const descriptor: GPURenderPassDescriptor = {\n      colorAttachments: [\n        t.getColorAttachment(colorTexture1x1A),\n        t.getColorAttachment(colorTexture1x1B),\n      ],\n      depthStencilAttachment: t.getDepthStencilAttachment(depthStencilTexture1x1),\n    };\n\n    t.tryRenderPass(true, descriptor);\n  }\n  {\n    // One of the color attachments has a different size\n    const descriptor: GPURenderPassDescriptor = {\n      colorAttachments: [\n        t.getColorAttachment(colorTexture1x1A),\n        t.getColorAttachment(colorTexture2x2),\n      ],\n    };\n\n    await t.tryRenderPass(false, descriptor);\n  }\n  {\n    // The depth stencil attachment has a different size\n    const descriptor: GPURenderPassDescriptor = {\n      colorAttachments: [\n        t.getColorAttachment(colorTexture1x1A),\n        t.getColorAttachment(colorTexture1x1B),\n      ],\n      depthStencilAttachment: t.getDepthStencilAttachment(depthStencilTexture2x2),\n    };\n\n    await t.tryRenderPass(false, descriptor);\n  }\n});\n\ng.test('attachments_must_match_whether_they_are_used_for_color_or_depth_stencil').fn(async t => {\n  const colorTexture = t.createTexture({ format: 'rgba8unorm' });\n  const depthStencilTexture = t.createTexture({ format: 'depth24plus-stencil8' });\n\n  {\n    // Using depth-stencil for color\n    const descriptor: GPURenderPassDescriptor = {\n      colorAttachments: [t.getColorAttachment(depthStencilTexture)],\n    };\n\n    await t.tryRenderPass(false, descriptor);\n  }\n  {\n    // Using color for depth-stencil\n    const descriptor: GPURenderPassDescriptor = {\n      colorAttachments: [],\n      depthStencilAttachment: t.getDepthStencilAttachment(colorTexture),\n    };\n\n    await t.tryRenderPass(false, descriptor);\n  }\n});\n\ng.test('check_layer_count_for_color_or_depth_stencil')\n  .paramsSimple([\n    { arrayLayerCount: 5, baseArrayLayer: 0, _success: false }, // using 2D array texture view with arrayLayerCount > 1 is not allowed\n    { arrayLayerCount: 1, baseArrayLayer: 0, _success: true }, // using 2D array texture view that covers the first layer of the texture is OK\n    { arrayLayerCount: 1, baseArrayLayer: 9, _success: true }, // using 2D array texture view that covers the last layer is OK for depth stencil\n  ])\n  .fn(async t => {\n    const { arrayLayerCount, baseArrayLayer, _success } = t.params;\n\n    const ARRAY_LAYER_COUNT = 10;\n    const MIP_LEVEL_COUNT = 1;\n    const COLOR_FORMAT = 'rgba8unorm';\n    const DEPTH_STENCIL_FORMAT = 'depth24plus-stencil8';\n\n    const colorTexture = t.createTexture({\n      format: COLOR_FORMAT,\n      width: 32,\n      height: 32,\n      mipLevelCount: MIP_LEVEL_COUNT,\n      arrayLayerCount: ARRAY_LAYER_COUNT,\n    });\n    const depthStencilTexture = t.createTexture({\n      format: DEPTH_STENCIL_FORMAT,\n      width: 32,\n      height: 32,\n      mipLevelCount: MIP_LEVEL_COUNT,\n      arrayLayerCount: ARRAY_LAYER_COUNT,\n    });\n\n    const baseTextureViewDescriptor: GPUTextureViewDescriptor = {\n      dimension: '2d-array',\n      baseArrayLayer,\n      arrayLayerCount,\n      baseMipLevel: 0,\n      mipLevelCount: MIP_LEVEL_COUNT,\n    };\n\n    {\n      // Check 2D array texture view for color\n      const textureViewDescriptor: GPUTextureViewDescriptor = {\n        ...baseTextureViewDescriptor,\n        format: COLOR_FORMAT,\n      };\n\n      const descriptor: GPURenderPassDescriptor = {\n        colorAttachments: [t.getColorAttachment(colorTexture, textureViewDescriptor)],\n      };\n\n      await t.tryRenderPass(_success, descriptor);\n    }\n    {\n      // Check 2D array texture view for depth stencil\n      const textureViewDescriptor: GPUTextureViewDescriptor = {\n        ...baseTextureViewDescriptor,\n        format: DEPTH_STENCIL_FORMAT,\n      };\n\n      const descriptor: GPURenderPassDescriptor = {\n        colorAttachments: [],\n        depthStencilAttachment: t.getDepthStencilAttachment(\n          depthStencilTexture,\n          textureViewDescriptor\n        ),\n      };\n\n      await t.tryRenderPass(_success, descriptor);\n    }\n  });\n\ng.test('check_mip_level_count_for_color_or_depth_stencil')\n  .paramsSimple([\n    { mipLevelCount: 2, baseMipLevel: 0, _success: false }, // using 2D texture view with mipLevelCount > 1 is not allowed\n    { mipLevelCount: 1, baseMipLevel: 0, _success: true }, // using 2D texture view that covers the first level of the texture is OK\n    { mipLevelCount: 1, baseMipLevel: 3, _success: true }, // using 2D texture view that covers the last level of the texture is OK\n  ])\n  .fn(async t => {\n    const { mipLevelCount, baseMipLevel, _success } = t.params;\n\n    const ARRAY_LAYER_COUNT = 1;\n    const MIP_LEVEL_COUNT = 4;\n    const COLOR_FORMAT = 'rgba8unorm';\n    const DEPTH_STENCIL_FORMAT = 'depth24plus-stencil8';\n\n    const colorTexture = t.createTexture({\n      format: COLOR_FORMAT,\n      width: 32,\n      height: 32,\n      mipLevelCount: MIP_LEVEL_COUNT,\n      arrayLayerCount: ARRAY_LAYER_COUNT,\n    });\n    const depthStencilTexture = t.createTexture({\n      format: DEPTH_STENCIL_FORMAT,\n      width: 32,\n      height: 32,\n      mipLevelCount: MIP_LEVEL_COUNT,\n      arrayLayerCount: ARRAY_LAYER_COUNT,\n    });\n\n    const baseTextureViewDescriptor: GPUTextureViewDescriptor = {\n      dimension: '2d',\n      baseArrayLayer: 0,\n      arrayLayerCount: ARRAY_LAYER_COUNT,\n      baseMipLevel,\n      mipLevelCount,\n    };\n\n    {\n      // Check 2D texture view for color\n      const textureViewDescriptor: GPUTextureViewDescriptor = {\n        ...baseTextureViewDescriptor,\n        format: COLOR_FORMAT,\n      };\n\n      const descriptor: GPURenderPassDescriptor = {\n        colorAttachments: [t.getColorAttachment(colorTexture, textureViewDescriptor)],\n      };\n\n      await t.tryRenderPass(_success, descriptor);\n    }\n    {\n      // Check 2D texture view for depth stencil\n      const textureViewDescriptor: GPUTextureViewDescriptor = {\n        ...baseTextureViewDescriptor,\n        format: DEPTH_STENCIL_FORMAT,\n      };\n\n      const descriptor: GPURenderPassDescriptor = {\n        colorAttachments: [],\n        depthStencilAttachment: t.getDepthStencilAttachment(\n          depthStencilTexture,\n          textureViewDescriptor\n        ),\n      };\n\n      await t.tryRenderPass(_success, descriptor);\n    }\n  });\n\ng.test('it_is_invalid_to_set_resolve_target_if_color_attachment_is_non_multisampled').fn(\n  async t => {\n    const colorTexture = t.createTexture({ sampleCount: 1 });\n    const resolveTargetTexture = t.createTexture({ sampleCount: 1 });\n\n    const descriptor: GPURenderPassDescriptor = {\n      colorAttachments: [\n        {\n          view: colorTexture.createView(),\n          resolveTarget: resolveTargetTexture.createView(),\n          clearValue: { r: 1.0, g: 0.0, b: 0.0, a: 1.0 },\n          loadOp: 'clear',\n          storeOp: 'store',\n        },\n      ],\n    };\n\n    await t.tryRenderPass(false, descriptor);\n  }\n);\n\ng.test('check_the_use_of_multisampled_textures_as_color_attachments').fn(async t => {\n  const colorTexture = t.createTexture({ sampleCount: 1 });\n  const multisampledColorTexture = t.createTexture({ sampleCount: 4 });\n\n  {\n    // It is allowed to use a multisampled color attachment without setting resolve target\n    const descriptor: GPURenderPassDescriptor = {\n      colorAttachments: [t.getColorAttachment(multisampledColorTexture)],\n    };\n    t.tryRenderPass(true, descriptor);\n  }\n  {\n    // It is not allowed to use multiple color attachments with different sample counts\n    const descriptor: GPURenderPassDescriptor = {\n      colorAttachments: [\n        t.getColorAttachment(colorTexture),\n        t.getColorAttachment(multisampledColorTexture),\n      ],\n    };\n\n    await t.tryRenderPass(false, descriptor);\n  }\n});\n\ng.test('it_is_invalid_to_use_a_multisampled_resolve_target').fn(async t => {\n  const multisampledColorTexture = t.createTexture({ sampleCount: 4 });\n  const multisampledResolveTargetTexture = t.createTexture({ sampleCount: 4 });\n\n  const colorAttachment = t.getColorAttachment(multisampledColorTexture);\n  colorAttachment.resolveTarget = multisampledResolveTargetTexture.createView();\n\n  const descriptor: GPURenderPassDescriptor = {\n    colorAttachments: [colorAttachment],\n  };\n\n  await t.tryRenderPass(false, descriptor);\n});\n\ng.test('it_is_invalid_to_use_a_resolve_target_with_array_layer_count_greater_than_1').fn(\n  async t => {\n    const multisampledColorTexture = t.createTexture({ sampleCount: 4 });\n    const resolveTargetTexture = t.createTexture({ arrayLayerCount: 2 });\n\n    const colorAttachment = t.getColorAttachment(multisampledColorTexture);\n    colorAttachment.resolveTarget = resolveTargetTexture.createView({ dimension: '2d-array' });\n\n    const descriptor: GPURenderPassDescriptor = {\n      colorAttachments: [colorAttachment],\n    };\n\n    await t.tryRenderPass(false, descriptor);\n  }\n);\n\ng.test('it_is_invalid_to_use_a_resolve_target_with_mipmap_level_count_greater_than_1').fn(\n  async t => {\n    const multisampledColorTexture = t.createTexture({ sampleCount: 4 });\n    const resolveTargetTexture = t.createTexture({ mipLevelCount: 2 });\n\n    const colorAttachment = t.getColorAttachment(multisampledColorTexture);\n    colorAttachment.resolveTarget = resolveTargetTexture.createView();\n\n    const descriptor: GPURenderPassDescriptor = {\n      colorAttachments: [colorAttachment],\n    };\n\n    await t.tryRenderPass(false, descriptor);\n  }\n);\n\ng.test('it_is_invalid_to_use_a_resolve_target_whose_usage_is_not_RENDER_ATTACHMENT').fn(async t => {\n  const multisampledColorTexture = t.createTexture({ sampleCount: 4 });\n  const resolveTargetTexture = t.createTexture({\n    usage: GPUTextureUsage.COPY_SRC | GPUTextureUsage.COPY_DST,\n  });\n\n  const colorAttachment = t.getColorAttachment(multisampledColorTexture);\n  colorAttachment.resolveTarget = resolveTargetTexture.createView();\n\n  const descriptor: GPURenderPassDescriptor = {\n    colorAttachments: [colorAttachment],\n  };\n\n  await t.tryRenderPass(false, descriptor);\n});\n\ng.test('it_is_invalid_to_use_a_resolve_target_in_error_state').fn(async t => {\n  const ARRAY_LAYER_COUNT = 1;\n\n  const multisampledColorTexture = t.createTexture({ sampleCount: 4 });\n  const resolveTargetTexture = t.createTexture({ arrayLayerCount: ARRAY_LAYER_COUNT });\n\n  const colorAttachment = t.getColorAttachment(multisampledColorTexture);\n  t.expectValidationError(() => {\n    colorAttachment.resolveTarget = resolveTargetTexture.createView({\n      dimension: '2d',\n      format: 'rgba8unorm',\n      baseArrayLayer: ARRAY_LAYER_COUNT + 1,\n    });\n  });\n\n  const descriptor: GPURenderPassDescriptor = {\n    colorAttachments: [colorAttachment],\n  };\n\n  await t.tryRenderPass(false, descriptor);\n});\n\ng.test('use_of_multisampled_attachment_and_non_multisampled_resolve_target_is_allowed').fn(\n  async t => {\n    const multisampledColorTexture = t.createTexture({ sampleCount: 4 });\n    const resolveTargetTexture = t.createTexture({ sampleCount: 1 });\n\n    const colorAttachment = t.getColorAttachment(multisampledColorTexture);\n    colorAttachment.resolveTarget = resolveTargetTexture.createView();\n\n    const descriptor: GPURenderPassDescriptor = {\n      colorAttachments: [colorAttachment],\n    };\n\n    t.tryRenderPass(true, descriptor);\n  }\n);\n\ng.test('use_a_resolve_target_in_a_format_different_than_the_attachment_is_not_allowed').fn(\n  async t => {\n    const multisampledColorTexture = t.createTexture({ sampleCount: 4 });\n    const resolveTargetTexture = t.createTexture({ format: 'bgra8unorm' });\n\n    const colorAttachment = t.getColorAttachment(multisampledColorTexture);\n    colorAttachment.resolveTarget = resolveTargetTexture.createView();\n\n    const descriptor: GPURenderPassDescriptor = {\n      colorAttachments: [colorAttachment],\n    };\n\n    await t.tryRenderPass(false, descriptor);\n  }\n);\n\ng.test('size_of_the_resolve_target_must_be_the_same_as_the_color_attachment').fn(async t => {\n  const size = 16;\n  const multisampledColorTexture = t.createTexture({ width: size, height: size, sampleCount: 4 });\n  const resolveTargetTexture = t.createTexture({\n    width: size * 2,\n    height: size * 2,\n    mipLevelCount: 2,\n  });\n\n  {\n    const resolveTargetTextureView = resolveTargetTexture.createView({\n      baseMipLevel: 0,\n      mipLevelCount: 1,\n    });\n\n    const colorAttachment = t.getColorAttachment(multisampledColorTexture);\n    colorAttachment.resolveTarget = resolveTargetTextureView;\n\n    const descriptor: GPURenderPassDescriptor = {\n      colorAttachments: [colorAttachment],\n    };\n\n    await t.tryRenderPass(false, descriptor);\n  }\n  {\n    const resolveTargetTextureView = resolveTargetTexture.createView({ baseMipLevel: 1 });\n\n    const colorAttachment = t.getColorAttachment(multisampledColorTexture);\n    colorAttachment.resolveTarget = resolveTargetTextureView;\n\n    const descriptor: GPURenderPassDescriptor = {\n      colorAttachments: [colorAttachment],\n    };\n\n    t.tryRenderPass(true, descriptor);\n  }\n});\n\ng.test('check_depth_stencil_attachment_sample_counts_mismatch').fn(async t => {\n  const multisampledDepthStencilTexture = t.createTexture({\n    sampleCount: 4,\n    format: 'depth24plus-stencil8',\n  });\n\n  {\n    // It is not allowed to use a depth stencil attachment whose sample count is different from the\n    // one of the color attachment\n    const depthStencilTexture = t.createTexture({\n      sampleCount: 1,\n      format: 'depth24plus-stencil8',\n    });\n    const multisampledColorTexture = t.createTexture({ sampleCount: 4 });\n    const descriptor: GPURenderPassDescriptor = {\n      colorAttachments: [t.getColorAttachment(multisampledColorTexture)],\n      depthStencilAttachment: t.getDepthStencilAttachment(depthStencilTexture),\n    };\n\n    await t.tryRenderPass(false, descriptor);\n  }\n  {\n    const colorTexture = t.createTexture({ sampleCount: 1 });\n    const descriptor: GPURenderPassDescriptor = {\n      colorAttachments: [t.getColorAttachment(colorTexture)],\n      depthStencilAttachment: t.getDepthStencilAttachment(multisampledDepthStencilTexture),\n    };\n\n    await t.tryRenderPass(false, descriptor);\n  }\n  {\n    // It is allowed to use a multisampled depth stencil attachment whose sample count is equal to\n    // the one of the color attachment.\n    const multisampledColorTexture = t.createTexture({ sampleCount: 4 });\n    const descriptor: GPURenderPassDescriptor = {\n      colorAttachments: [t.getColorAttachment(multisampledColorTexture)],\n      depthStencilAttachment: t.getDepthStencilAttachment(multisampledDepthStencilTexture),\n    };\n\n    t.tryRenderPass(true, descriptor);\n  }\n  {\n    // It is allowed to use a multisampled depth stencil attachment with no color attachment\n    const descriptor: GPURenderPassDescriptor = {\n      colorAttachments: [],\n      depthStencilAttachment: t.getDepthStencilAttachment(multisampledDepthStencilTexture),\n    };\n\n    t.tryRenderPass(true, descriptor);\n  }\n});\n\ng.test('multisample_render_target_formats_support_resolve')\n  .params(u =>\n    u\n      .combine('format', kRenderableColorTextureFormats)\n      .filter(t => kTextureFormatInfo[t.format].multisample)\n  )\n  .fn(async t => {\n    const { format } = t.params;\n    const multisampledColorTexture = t.createTexture({ format, sampleCount: 4 });\n    const resolveTarget = t.createTexture({ format });\n\n    const colorAttachment = t.getColorAttachment(multisampledColorTexture);\n    colorAttachment.resolveTarget = resolveTarget.createView();\n\n    t.tryRenderPass(kTextureFormatInfo[format].resolve, {\n      colorAttachments: [colorAttachment],\n    });\n  });\n"],"file":"render_pass_descriptor.spec.js"}