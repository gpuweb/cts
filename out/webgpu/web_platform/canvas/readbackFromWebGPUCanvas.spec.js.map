{"version":3,"file":"readbackFromWebGPUCanvas.spec.js","names":["description","makeTestGroup","assert","raceWithRejectOnTimeout","unreachable","kCanvasAlphaModes","kCanvasColorSpaces","kCanvasTextureFormats","GPUTest","checkElementsEqual","kAllCanvasTypes","createCanvas","createOnscreenCanvas","g","kPixelValue","kPixelValueFloat","expect","Uint8ClampedArray","initWebGPUCanvasContent","t","format","alphaMode","colorSpace","canvasType","canvas","ctx","getContext","GPUCanvasContext","configure","device","usage","GPUTextureUsage","COPY_SRC","COPY_DST","canvasTexture","getCurrentTexture","tempTexture","createTexture","size","width","height","depthOrArrayLayers","RENDER_ATTACHMENT","tempTextureView","createView","encoder","createCommandEncoder","clearOnePixel","origin","color","pass","beginRenderPass","colorAttachments","view","clearValue","loadOp","storeOp","end","copyTextureToTexture","texture","queue","submit","finish","destroy","drawImageSourceIntoCanvas","image","drawImage","checkImageResultWithSameColorSpaceCanvas","sourceColorSpace","readPixelsFrom2DCanvasAndCompare","checkImageResultWithDifferentColorSpaceCanvas","sourceData","destinationColorSpace","fromWebGPUCtx","source2DCanvas","source2DCtx","imgData","getImageData","data","set","putImageData","from2DCtx","checkImageResult","actual","expectOK","test","desc","params","u","combine","fn","snapshot","snapshotType","url","toDataURL","img","Image","src","decode","blobFromCanvas","Promise","resolve","toBlob","blob","URL","createObjectURL","createImageBitmap","offscreenCanvas","convertToBlob","undefined","skip","transferToImageBitmap","webgl","upload","expectCanvas","gl","bindTexture","TEXTURE_2D","texImage2D","RGBA","UNSIGNED_BYTE","texSubImage2D","fb","createFramebuffer","bindFramebuffer","FRAMEBUFFER","framebufferTexture2D","COLOR_ATTACHMENT0","pixels","Uint8Array","readPixels","webgpuCanvasType","canvas2DType","ib","readbackCanvas","document","createElement","readbackContext","alpha","expected","i","byteLength","expectValidationError","shouldThrow"],"sources":["../../../../src/webgpu/web_platform/canvas/readbackFromWebGPUCanvas.spec.ts"],"sourcesContent":["export const description = `\nTests for readback from WebGPU Canvas.\n\nThis includes testing that colorSpace makes it through from the WebGPU canvas\nto the form of copy (toDataURL, toBlob, ImageBitmap, drawImage)\n\nThe color space support is tested by drawing the readback form of the WebGPU\ncanvas into a 2D canvas of a different color space via drawImage (A). Another\n2D canvas is created with the same source data and color space as the WebGPU\ncanvas and also drawn into another 2D canvas of a different color space (B).\nThe contents of A and B should match.\n\nTODO: implement all canvas types, see TODO on kCanvasTypes.\n`;\n\nimport { makeTestGroup } from '../../../common/framework/test_group.js';\nimport { assert, raceWithRejectOnTimeout, unreachable } from '../../../common/util/util.js';\nimport {\n  kCanvasAlphaModes,\n  kCanvasColorSpaces,\n  kCanvasTextureFormats,\n} from '../../capability_info.js';\nimport { GPUTest } from '../../gpu_test.js';\nimport { checkElementsEqual } from '../../util/check_contents.js';\nimport {\n  kAllCanvasTypes,\n  CanvasType,\n  createCanvas,\n  createOnscreenCanvas,\n} from '../../util/create_elements.js';\n\nexport const g = makeTestGroup(GPUTest);\n\n// We choose 0x66 as the value for each color and alpha channel\n// 0x66 / 0xff = 0.4\n// Given a pixel value of RGBA = (0x66, 0, 0, 0x66) in the source WebGPU canvas,\n// For alphaMode = opaque, the copy output should be RGBA = (0x66, 0, 0, 0xff)\n// For alphaMode = premultiplied, the copy output should be RGBA = (0xff, 0, 0, 0x66)\nconst kPixelValue = 0x66;\nconst kPixelValueFloat = 0x66 / 0xff; // 0.4\n\n// Use four pixels rectangle for the test:\n// blue: top-left;\n// green: top-right;\n// red: bottom-left;\n// yellow: bottom-right;\nconst expect = {\n  /* prettier-ignore */\n  'opaque': new Uint8ClampedArray([\n    0, 0, kPixelValue, 0xff, // blue\n    0, kPixelValue, 0, 0xff, // green\n    kPixelValue, 0, 0, 0xff, // red\n    kPixelValue, kPixelValue, 0, 0xff, // yellow\n  ]),\n  /* prettier-ignore */\n  'premultiplied': new Uint8ClampedArray([\n    0, 0, 0xff, kPixelValue, // blue\n    0, 0xff, 0, kPixelValue, // green\n    0xff, 0, 0, kPixelValue, // red\n    0xff, 0xff, 0, kPixelValue, // yellow\n  ]),\n};\n\nfunction initWebGPUCanvasContent<T extends CanvasType>(\n  t: GPUTest,\n  format: GPUTextureFormat,\n  alphaMode: GPUCanvasAlphaMode,\n  colorSpace: PredefinedColorSpace,\n  canvasType: T\n) {\n  const canvas = createCanvas(t, canvasType, 2, 2);\n  const ctx = canvas.getContext('webgpu');\n  assert(ctx instanceof GPUCanvasContext, 'Failed to get WebGPU context from canvas');\n\n  ctx.configure({\n    device: t.device,\n    format,\n    usage: GPUTextureUsage.COPY_SRC | GPUTextureUsage.COPY_DST,\n    alphaMode,\n    colorSpace,\n  });\n\n  const canvasTexture = ctx.getCurrentTexture();\n  const tempTexture = t.device.createTexture({\n    size: { width: 1, height: 1, depthOrArrayLayers: 1 },\n    format,\n    usage: GPUTextureUsage.COPY_SRC | GPUTextureUsage.RENDER_ATTACHMENT,\n  });\n  const tempTextureView = tempTexture.createView();\n  const encoder = t.device.createCommandEncoder();\n\n  const clearOnePixel = (origin: GPUOrigin3D, color: GPUColor) => {\n    const pass = encoder.beginRenderPass({\n      colorAttachments: [\n        { view: tempTextureView, clearValue: color, loadOp: 'clear', storeOp: 'store' },\n      ],\n    });\n    pass.end();\n    encoder.copyTextureToTexture(\n      { texture: tempTexture },\n      { texture: canvasTexture, origin },\n      { width: 1, height: 1 }\n    );\n  };\n\n  clearOnePixel([0, 0], [0, 0, kPixelValueFloat, kPixelValueFloat]);\n  clearOnePixel([1, 0], [0, kPixelValueFloat, 0, kPixelValueFloat]);\n  clearOnePixel([0, 1], [kPixelValueFloat, 0, 0, kPixelValueFloat]);\n  clearOnePixel([1, 1], [kPixelValueFloat, kPixelValueFloat, 0, kPixelValueFloat]);\n\n  t.device.queue.submit([encoder.finish()]);\n  tempTexture.destroy();\n\n  return canvas;\n}\n\nfunction drawImageSourceIntoCanvas(\n  t: GPUTest,\n  image: CanvasImageSource,\n  colorSpace: PredefinedColorSpace\n) {\n  const canvas: HTMLCanvasElement = createOnscreenCanvas(t, 2, 2);\n  const ctx = canvas.getContext('2d', { colorSpace });\n  assert(ctx !== null);\n  ctx.drawImage(image, 0, 0);\n  return ctx;\n}\n\nfunction checkImageResultWithSameColorSpaceCanvas(\n  t: GPUTest,\n  image: CanvasImageSource,\n  sourceColorSpace: PredefinedColorSpace,\n  expect: Uint8ClampedArray\n) {\n  const ctx = drawImageSourceIntoCanvas(t, image, sourceColorSpace);\n  readPixelsFrom2DCanvasAndCompare(t, ctx, expect);\n}\n\nfunction checkImageResultWithDifferentColorSpaceCanvas(\n  t: GPUTest,\n  image: CanvasImageSource,\n  sourceColorSpace: PredefinedColorSpace,\n  sourceData: Uint8ClampedArray\n) {\n  const destinationColorSpace = sourceColorSpace === 'srgb' ? 'display-p3' : 'srgb';\n\n  // draw the WebGPU derived data into a canvas\n  const fromWebGPUCtx = drawImageSourceIntoCanvas(t, image, destinationColorSpace);\n\n  // create a 2D canvas with the same source data in the same color space as the WebGPU\n  // canvas\n  const source2DCanvas: HTMLCanvasElement = createOnscreenCanvas(t, 2, 2);\n  const source2DCtx = source2DCanvas.getContext('2d', { colorSpace: sourceColorSpace });\n  assert(source2DCtx !== null);\n  const imgData = source2DCtx.getImageData(0, 0, 2, 2);\n  imgData.data.set(sourceData);\n  source2DCtx.putImageData(imgData, 0, 0);\n\n  // draw the source 2D canvas into another 2D canvas with the destination color space and\n  // then pull out the data. This result should be the same as the WebGPU derived data\n  // written to a 2D canvas of the same destination color space.\n  const from2DCtx = drawImageSourceIntoCanvas(t, source2DCanvas, destinationColorSpace);\n  const expect = from2DCtx.getImageData(0, 0, 2, 2).data;\n\n  readPixelsFrom2DCanvasAndCompare(t, fromWebGPUCtx, expect);\n}\n\nfunction checkImageResult(\n  t: GPUTest,\n  image: CanvasImageSource,\n  sourceColorSpace: PredefinedColorSpace,\n  expect: Uint8ClampedArray\n) {\n  checkImageResultWithSameColorSpaceCanvas(t, image, sourceColorSpace, expect);\n  checkImageResultWithDifferentColorSpaceCanvas(t, image, sourceColorSpace, expect);\n}\n\nfunction readPixelsFrom2DCanvasAndCompare(\n  t: GPUTest,\n  ctx: CanvasRenderingContext2D | OffscreenCanvasRenderingContext2D,\n  expect: Uint8ClampedArray\n) {\n  const actual = ctx.getImageData(0, 0, ctx.canvas.width, ctx.canvas.height).data;\n\n  t.expectOK(checkElementsEqual(actual, expect));\n}\n\ng.test('onscreenCanvas,snapshot')\n  .desc(\n    `\n    Ensure snapshot of canvas with WebGPU context is correct with\n    - various WebGPU canvas texture formats\n    - WebGPU canvas alpha mode = {\"opaque\", \"premultiplied\"}\n    - colorSpace = {\"srgb\", \"display-p3\"}\n    - snapshot methods = {convertToBlob, transferToImageBitmap, createImageBitmap}\n\n    TODO: Snapshot canvas to jpeg, webp and other mime type and\n          different quality. Maybe we should test them in reftest.\n    `\n  )\n  .params(u =>\n    u //\n      .combine('format', kCanvasTextureFormats)\n      .combine('alphaMode', kCanvasAlphaModes)\n      .combine('colorSpace', kCanvasColorSpaces)\n      .combine('snapshotType', ['toDataURL', 'toBlob', 'imageBitmap'])\n  )\n  .fn(async t => {\n    const canvas = initWebGPUCanvasContent(\n      t,\n      t.params.format,\n      t.params.alphaMode,\n      t.params.colorSpace,\n      'onscreen'\n    );\n\n    let snapshot: HTMLImageElement | ImageBitmap;\n    switch (t.params.snapshotType) {\n      case 'toDataURL': {\n        const url = canvas.toDataURL();\n        const img = new Image(canvas.width, canvas.height);\n        img.src = url;\n        await raceWithRejectOnTimeout(img.decode(), 5000, 'load image timeout');\n        snapshot = img;\n        break;\n      }\n      case 'toBlob': {\n        const blobFromCanvas = new Promise(resolve => {\n          canvas.toBlob(blob => resolve(blob));\n        });\n        const blob = (await blobFromCanvas) as Blob;\n        const url = URL.createObjectURL(blob);\n        const img = new Image(canvas.width, canvas.height);\n        img.src = url;\n        await raceWithRejectOnTimeout(img.decode(), 5000, 'load image timeout');\n        snapshot = img;\n        break;\n      }\n      case 'imageBitmap': {\n        snapshot = await createImageBitmap(canvas);\n        break;\n      }\n      default:\n        unreachable();\n    }\n\n    checkImageResult(t, snapshot, t.params.colorSpace, expect[t.params.alphaMode]);\n  });\n\ng.test('offscreenCanvas,snapshot')\n  .desc(\n    `\n    Ensure snapshot of offscreenCanvas with WebGPU context is correct with\n    - various WebGPU canvas texture formats\n    - WebGPU canvas alpha mode = {\"opaque\", \"premultiplied\"}\n    - colorSpace = {\"srgb\", \"display-p3\"}\n    - snapshot methods = {convertToBlob, transferToImageBitmap, createImageBitmap}\n\n    TODO: Snapshot offscreenCanvas to jpeg, webp and other mime type and\n          different quality. Maybe we should test them in reftest.\n    `\n  )\n  .params(u =>\n    u //\n      .combine('format', kCanvasTextureFormats)\n      .combine('alphaMode', kCanvasAlphaModes)\n      .combine('colorSpace', kCanvasColorSpaces)\n      .combine('snapshotType', ['convertToBlob', 'transferToImageBitmap', 'imageBitmap'])\n  )\n  .fn(async t => {\n    const offscreenCanvas = initWebGPUCanvasContent(\n      t,\n      t.params.format,\n      t.params.alphaMode,\n      t.params.colorSpace,\n      'offscreen'\n    );\n\n    let snapshot: HTMLImageElement | ImageBitmap;\n    switch (t.params.snapshotType) {\n      case 'convertToBlob': {\n        if (typeof offscreenCanvas.convertToBlob === undefined) {\n          t.skip(\"Browser doesn't support OffscreenCanvas.convertToBlob\");\n          return;\n        }\n        const blob = await offscreenCanvas.convertToBlob();\n        const url = URL.createObjectURL(blob);\n        const img = new Image(offscreenCanvas.width, offscreenCanvas.height);\n        img.src = url;\n        await raceWithRejectOnTimeout(img.decode(), 5000, 'load image timeout');\n        snapshot = img;\n        break;\n      }\n      case 'transferToImageBitmap': {\n        if (typeof offscreenCanvas.transferToImageBitmap === undefined) {\n          t.skip(\"Browser doesn't support OffscreenCanvas.transferToImageBitmap\");\n          return;\n        }\n        snapshot = offscreenCanvas.transferToImageBitmap();\n        break;\n      }\n      case 'imageBitmap': {\n        snapshot = await createImageBitmap(offscreenCanvas);\n        break;\n      }\n      default:\n        unreachable();\n    }\n\n    checkImageResult(t, snapshot, t.params.colorSpace, expect[t.params.alphaMode]);\n  });\n\ng.test('onscreenCanvas,uploadToWebGL')\n  .desc(\n    `\n    Ensure upload WebGPU context canvas to webgl texture is correct with\n    - various WebGPU canvas texture formats\n    - WebGPU canvas alpha mode = {\"opaque\", \"premultiplied\"}\n    - upload methods = {texImage2D, texSubImage2D}\n    `\n  )\n  .params(u =>\n    u //\n      .combine('format', kCanvasTextureFormats)\n      .combine('alphaMode', kCanvasAlphaModes)\n      .combine('webgl', ['webgl', 'webgl2'])\n      .combine('upload', ['texImage2D', 'texSubImage2D'])\n  )\n  .fn(t => {\n    const { format, webgl, upload } = t.params;\n    const canvas = initWebGPUCanvasContent(t, format, t.params.alphaMode, 'srgb', 'onscreen');\n\n    const expectCanvas: HTMLCanvasElement = createOnscreenCanvas(t, canvas.width, canvas.height);\n    const gl = expectCanvas.getContext(webgl) as WebGLRenderingContext | WebGL2RenderingContext;\n    if (gl === null) {\n      return;\n    }\n\n    const texture = gl.createTexture();\n    gl.bindTexture(gl.TEXTURE_2D, texture);\n    switch (upload) {\n      case 'texImage2D': {\n        gl.texImage2D(gl.TEXTURE_2D, 0, gl.RGBA, gl.RGBA, gl.UNSIGNED_BYTE, canvas);\n        break;\n      }\n      case 'texSubImage2D': {\n        gl.texImage2D(\n          gl.TEXTURE_2D,\n          0,\n          gl.RGBA,\n          canvas.width,\n          canvas.height,\n          0,\n          gl.RGBA,\n          gl.UNSIGNED_BYTE,\n          null\n        );\n        gl.texSubImage2D(gl.TEXTURE_2D, 0, 0, 0, gl.RGBA, gl.UNSIGNED_BYTE, canvas);\n        break;\n      }\n      default:\n        unreachable();\n    }\n\n    const fb = gl.createFramebuffer();\n\n    gl.bindFramebuffer(gl.FRAMEBUFFER, fb);\n    gl.framebufferTexture2D(gl.FRAMEBUFFER, gl.COLOR_ATTACHMENT0, gl.TEXTURE_2D, texture, 0);\n\n    const pixels = new Uint8Array(canvas.width * canvas.height * 4);\n    gl.readPixels(0, 0, 2, 2, gl.RGBA, gl.UNSIGNED_BYTE, pixels);\n    const actual = new Uint8ClampedArray(pixels);\n\n    t.expectOK(checkElementsEqual(actual, expect[t.params.alphaMode]));\n  });\n\ng.test('drawTo2DCanvas')\n  .desc(\n    `\n    Ensure draw WebGPU context canvas to 2d context canvas/offscreenCanvas is correct with\n    - various WebGPU canvas texture formats\n    - WebGPU canvas alpha mode = {\"opaque\", \"premultiplied\"}\n    - colorSpace = {\"srgb\", \"display-p3\"}\n    - WebGPU canvas type = {\"onscreen\", \"offscreen\"}\n    - 2d canvas type = {\"onscreen\", \"offscreen\"}\n    `\n  )\n  .params(u =>\n    u //\n      .combine('format', kCanvasTextureFormats)\n      .combine('alphaMode', kCanvasAlphaModes)\n      .combine('colorSpace', kCanvasColorSpaces)\n      .combine('webgpuCanvasType', kAllCanvasTypes)\n      .combine('canvas2DType', kAllCanvasTypes)\n  )\n  .fn(t => {\n    const { format, webgpuCanvasType, alphaMode, colorSpace, canvas2DType } = t.params;\n\n    const canvas = initWebGPUCanvasContent(t, format, alphaMode, colorSpace, webgpuCanvasType);\n\n    const expectCanvas = createCanvas(t, canvas2DType, canvas.width, canvas.height);\n    const ctx = expectCanvas.getContext('2d') as CanvasRenderingContext2D;\n    if (ctx === null) {\n      t.skip(canvas2DType + ' canvas cannot get 2d context');\n      return;\n    }\n\n    ctx.drawImage(canvas, 0, 0);\n    readPixelsFrom2DCanvasAndCompare(t, ctx, expect[t.params.alphaMode]);\n  });\n\ng.test('transferToImageBitmap_unconfigured_nonzero_size')\n  .desc(\n    `Regression test for a crash when calling transferImageBitmap on an unconfigured. Case where the canvas is not empty`\n  )\n  .fn(t => {\n    const canvas = createCanvas(t, 'offscreen', 2, 3);\n    canvas.getContext('webgpu');\n\n    // Transferring gives an ImageBitmap of the correct size filled with transparent black.\n    const ib = canvas.transferToImageBitmap();\n    t.expect(ib.width === canvas.width);\n    t.expect(ib.height === canvas.height);\n\n    const readbackCanvas = document.createElement('canvas');\n    readbackCanvas.width = canvas.width;\n    readbackCanvas.height = canvas.height;\n    const readbackContext = readbackCanvas.getContext('2d', {\n      alpha: true,\n    });\n    if (readbackContext === null) {\n      t.skip('Cannot get a 2D canvas context');\n      return;\n    }\n\n    // Since there isn't a configuration we expect the ImageBitmap to have the default alphaMode of \"opaque\".\n    const expected = new Uint8ClampedArray(canvas.width * canvas.height * 4);\n    for (let i = 0; i < expected.byteLength; i += 4) {\n      expected[i + 0] = 0;\n      expected[i + 1] = 0;\n      expected[i + 2] = 0;\n      expected[i + 3] = 255;\n    }\n\n    readbackContext.drawImage(ib, 0, 0);\n    readPixelsFrom2DCanvasAndCompare(t, readbackContext, expected);\n  });\n\ng.test('transferToImageBitmap_zero_size')\n  .desc(\n    `Regression test for a crash when calling transferImageBitmap on an unconfigured. Case where the canvas is empty.\n\n    TODO: Spec and expect a particular Exception type here.`\n  )\n  .params(u => u.combine('configure', [true, false]))\n  .fn(t => {\n    const { configure } = t.params;\n    const canvas = createCanvas(t, 'offscreen', 0, 1);\n    const ctx = canvas.getContext('webgpu')!;\n\n    if (configure) {\n      t.expectValidationError(() => ctx.configure({ device: t.device, format: 'bgra8unorm' }));\n    }\n\n    // Transferring would give an empty ImageBitmap which is not possible, so an Exception is thrown.\n    t.shouldThrow(true, () => {\n      canvas.transferToImageBitmap();\n    });\n  });\n\ng.test('transferToImageBitmap_huge_size')\n  .desc(`Regression test for a crash when calling transferImageBitmap on a HUGE canvas.`)\n  .fn(t => {\n    const canvas = createCanvas(t, 'offscreen', 1000000, 1000000);\n    canvas.getContext('webgpu')!;\n\n    // Transferring to such a HUGE image bitmap would not be possible, so an Exception is thrown.\n    t.shouldThrow(true, () => {\n      canvas.transferToImageBitmap();\n    });\n  });\n"],"mappings":";AAAA;AAAA,GAAA,OAAO,MAAMA,WAAW,GAAI;AAC5B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC,CAED,SAASC,aAAa,QAAQ,yCAAyC;AACvE,SAASC,MAAM,EAAEC,uBAAuB,EAAEC,WAAW,QAAQ,8BAA8B;AAC3F;AACEC,iBAAiB;AACjBC,kBAAkB;AAClBC,qBAAqB;AAChB,0BAA0B;AACjC,SAASC,OAAO,QAAQ,mBAAmB;AAC3C,SAASC,kBAAkB,QAAQ,8BAA8B;AACjE;AACEC,eAAe;;AAEfC,YAAY;AACZC,oBAAoB;AACf,+BAA+B;;AAEtC,OAAO,MAAMC,CAAC,GAAGZ,aAAa,CAACO,OAAO,CAAC;;AAEvC;AACA;AACA;AACA;AACA;AACA,MAAMM,WAAW,GAAG,IAAI;AACxB,MAAMC,gBAAgB,GAAG,IAAI,GAAG,IAAI,CAAC,CAAC;;AAEtC;AACA;AACA;AACA;AACA;AACA,MAAMC,MAAM,GAAG;;EAEb,QAAQ,EAAE,IAAIC,iBAAiB,CAAC;EAC9B,CAAC,EAAE,CAAC,EAAEH,WAAW,EAAE,IAAI,EAAE;EACzB,CAAC,EAAEA,WAAW,EAAE,CAAC,EAAE,IAAI,EAAE;EACzBA,WAAW,EAAE,CAAC,EAAE,CAAC,EAAE,IAAI,EAAE;EACzBA,WAAW,EAAEA,WAAW,EAAE,CAAC,EAAE,IAAI,CAAE;EAAA,CACpC,CAAC;;EAEF,eAAe,EAAE,IAAIG,iBAAiB,CAAC;EACrC,CAAC,EAAE,CAAC,EAAE,IAAI,EAAEH,WAAW,EAAE;EACzB,CAAC,EAAE,IAAI,EAAE,CAAC,EAAEA,WAAW,EAAE;EACzB,IAAI,EAAE,CAAC,EAAE,CAAC,EAAEA,WAAW,EAAE;EACzB,IAAI,EAAE,IAAI,EAAE,CAAC,EAAEA,WAAW,CAAE;EAAA,CAC7B;AACH,CAAC;;AAED,SAASI,uBAAuB;AAC9BC,CAAU;AACVC,MAAwB;AACxBC,SAA6B;AAC7BC,UAAgC;AAChCC,UAAa;AACb;EACA,MAAMC,MAAM,GAAGb,YAAY,CAACQ,CAAC,EAAEI,UAAU,EAAE,CAAC,EAAE,CAAC,CAAC;EAChD,MAAME,GAAG,GAAGD,MAAM,CAACE,UAAU,CAAC,QAAQ,CAAC;EACvCxB,MAAM,CAACuB,GAAG,YAAYE,gBAAgB,EAAE,0CAA0C,CAAC;;EAEnFF,GAAG,CAACG,SAAS,CAAC;IACZC,MAAM,EAAEV,CAAC,CAACU,MAAM;IAChBT,MAAM;IACNU,KAAK,EAAEC,eAAe,CAACC,QAAQ,GAAGD,eAAe,CAACE,QAAQ;IAC1DZ,SAAS;IACTC;EACF,CAAC,CAAC;;EAEF,MAAMY,aAAa,GAAGT,GAAG,CAACU,iBAAiB,EAAE;EAC7C,MAAMC,WAAW,GAAGjB,CAAC,CAACU,MAAM,CAACQ,aAAa,CAAC;IACzCC,IAAI,EAAE,EAAEC,KAAK,EAAE,CAAC,EAAEC,MAAM,EAAE,CAAC,EAAEC,kBAAkB,EAAE,CAAC,CAAC,CAAC;IACpDrB,MAAM;IACNU,KAAK,EAAEC,eAAe,CAACC,QAAQ,GAAGD,eAAe,CAACW;EACpD,CAAC,CAAC;EACF,MAAMC,eAAe,GAAGP,WAAW,CAACQ,UAAU,EAAE;EAChD,MAAMC,OAAO,GAAG1B,CAAC,CAACU,MAAM,CAACiB,oBAAoB,EAAE;;EAE/C,MAAMC,aAAa,GAAG,CAACC,MAAmB,EAAEC,KAAe,KAAK;IAC9D,MAAMC,IAAI,GAAGL,OAAO,CAACM,eAAe,CAAC;MACnCC,gBAAgB,EAAE;MAChB,EAAEC,IAAI,EAAEV,eAAe,EAAEW,UAAU,EAAEL,KAAK,EAAEM,MAAM,EAAE,OAAO,EAAEC,OAAO,EAAE,OAAO,CAAC,CAAC;;IAEnF,CAAC,CAAC;IACFN,IAAI,CAACO,GAAG,EAAE;IACVZ,OAAO,CAACa,oBAAoB;IAC1B,EAAEC,OAAO,EAAEvB,WAAW,CAAC,CAAC;IACxB,EAAEuB,OAAO,EAAEzB,aAAa,EAAEc,MAAM,CAAC,CAAC;IAClC,EAAET,KAAK,EAAE,CAAC,EAAEC,MAAM,EAAE,CAAC,CAAC,CAAC,CACxB;;EACH,CAAC;;EAEDO,aAAa,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,EAAE,CAAC,CAAC,EAAE,CAAC,EAAEhC,gBAAgB,EAAEA,gBAAgB,CAAC,CAAC;EACjEgC,aAAa,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,EAAE,CAAC,CAAC,EAAEhC,gBAAgB,EAAE,CAAC,EAAEA,gBAAgB,CAAC,CAAC;EACjEgC,aAAa,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,EAAE,CAAChC,gBAAgB,EAAE,CAAC,EAAE,CAAC,EAAEA,gBAAgB,CAAC,CAAC;EACjEgC,aAAa,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,EAAE,CAAChC,gBAAgB,EAAEA,gBAAgB,EAAE,CAAC,EAAEA,gBAAgB,CAAC,CAAC;;EAEhFI,CAAC,CAACU,MAAM,CAAC+B,KAAK,CAACC,MAAM,CAAC,CAAChB,OAAO,CAACiB,MAAM,EAAE,CAAC,CAAC;EACzC1B,WAAW,CAAC2B,OAAO,EAAE;;EAErB,OAAOvC,MAAM;AACf;;AAEA,SAASwC,yBAAyB;AAChC7C,CAAU;AACV8C,KAAwB;AACxB3C,UAAgC;AAChC;EACA,MAAME,MAAyB,GAAGZ,oBAAoB,CAACO,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC;EAC/D,MAAMM,GAAG,GAAGD,MAAM,CAACE,UAAU,CAAC,IAAI,EAAE,EAAEJ,UAAU,CAAC,CAAC,CAAC;EACnDpB,MAAM,CAACuB,GAAG,KAAK,IAAI,CAAC;EACpBA,GAAG,CAACyC,SAAS,CAACD,KAAK,EAAE,CAAC,EAAE,CAAC,CAAC;EAC1B,OAAOxC,GAAG;AACZ;;AAEA,SAAS0C,wCAAwC;AAC/ChD,CAAU;AACV8C,KAAwB;AACxBG,gBAAsC;AACtCpD,MAAyB;AACzB;EACA,MAAMS,GAAG,GAAGuC,yBAAyB,CAAC7C,CAAC,EAAE8C,KAAK,EAAEG,gBAAgB,CAAC;EACjEC,gCAAgC,CAAClD,CAAC,EAAEM,GAAG,EAAET,MAAM,CAAC;AAClD;;AAEA,SAASsD,6CAA6C;AACpDnD,CAAU;AACV8C,KAAwB;AACxBG,gBAAsC;AACtCG,UAA6B;AAC7B;EACA,MAAMC,qBAAqB,GAAGJ,gBAAgB,KAAK,MAAM,GAAG,YAAY,GAAG,MAAM;;EAEjF;EACA,MAAMK,aAAa,GAAGT,yBAAyB,CAAC7C,CAAC,EAAE8C,KAAK,EAAEO,qBAAqB,CAAC;;EAEhF;EACA;EACA,MAAME,cAAiC,GAAG9D,oBAAoB,CAACO,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC;EACvE,MAAMwD,WAAW,GAAGD,cAAc,CAAChD,UAAU,CAAC,IAAI,EAAE,EAAEJ,UAAU,EAAE8C,gBAAgB,CAAC,CAAC,CAAC;EACrFlE,MAAM,CAACyE,WAAW,KAAK,IAAI,CAAC;EAC5B,MAAMC,OAAO,GAAGD,WAAW,CAACE,YAAY,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC;EACpDD,OAAO,CAACE,IAAI,CAACC,GAAG,CAACR,UAAU,CAAC;EAC5BI,WAAW,CAACK,YAAY,CAACJ,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;;EAEvC;EACA;EACA;EACA,MAAMK,SAAS,GAAGjB,yBAAyB,CAAC7C,CAAC,EAAEuD,cAAc,EAAEF,qBAAqB,CAAC;EACrF,MAAMxD,MAAM,GAAGiE,SAAS,CAACJ,YAAY,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,CAACC,IAAI;;EAEtDT,gCAAgC,CAAClD,CAAC,EAAEsD,aAAa,EAAEzD,MAAM,CAAC;AAC5D;;AAEA,SAASkE,gBAAgB;AACvB/D,CAAU;AACV8C,KAAwB;AACxBG,gBAAsC;AACtCpD,MAAyB;AACzB;EACAmD,wCAAwC,CAAChD,CAAC,EAAE8C,KAAK,EAAEG,gBAAgB,EAAEpD,MAAM,CAAC;EAC5EsD,6CAA6C,CAACnD,CAAC,EAAE8C,KAAK,EAAEG,gBAAgB,EAAEpD,MAAM,CAAC;AACnF;;AAEA,SAASqD,gCAAgC;AACvClD,CAAU;AACVM,GAAiE;AACjET,MAAyB;AACzB;EACA,MAAMmE,MAAM,GAAG1D,GAAG,CAACoD,YAAY,CAAC,CAAC,EAAE,CAAC,EAAEpD,GAAG,CAACD,MAAM,CAACe,KAAK,EAAEd,GAAG,CAACD,MAAM,CAACgB,MAAM,CAAC,CAACsC,IAAI;;EAE/E3D,CAAC,CAACiE,QAAQ,CAAC3E,kBAAkB,CAAC0E,MAAM,EAAEnE,MAAM,CAAC,CAAC;AAChD;;AAEAH,CAAC,CAACwE,IAAI,CAAC,yBAAyB,CAAC;AAC9BC,IAAI;AACF;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK,CACF;;AACAC,MAAM,CAAC,CAAAC,CAAC;AACPA,CAAC,CAAC;AAAA,CACCC,OAAO,CAAC,QAAQ,EAAElF,qBAAqB,CAAC;AACxCkF,OAAO,CAAC,WAAW,EAAEpF,iBAAiB,CAAC;AACvCoF,OAAO,CAAC,YAAY,EAAEnF,kBAAkB,CAAC;AACzCmF,OAAO,CAAC,cAAc,EAAE,CAAC,WAAW,EAAE,QAAQ,EAAE,aAAa,CAAC,CAAC,CACnE;;AACAC,EAAE,CAAC,OAAMvE,CAAC,KAAI;EACb,MAAMK,MAAM,GAAGN,uBAAuB;EACpCC,CAAC;EACDA,CAAC,CAACoE,MAAM,CAACnE,MAAM;EACfD,CAAC,CAACoE,MAAM,CAAClE,SAAS;EAClBF,CAAC,CAACoE,MAAM,CAACjE,UAAU;EACnB,UAAU,CACX;;;EAED,IAAIqE,QAAwC;EAC5C,QAAQxE,CAAC,CAACoE,MAAM,CAACK,YAAY;IAC3B,KAAK,WAAW,CAAE;QAChB,MAAMC,GAAG,GAAGrE,MAAM,CAACsE,SAAS,EAAE;QAC9B,MAAMC,GAAG,GAAG,IAAIC,KAAK,CAACxE,MAAM,CAACe,KAAK,EAAEf,MAAM,CAACgB,MAAM,CAAC;QAClDuD,GAAG,CAACE,GAAG,GAAGJ,GAAG;QACb,MAAM1F,uBAAuB,CAAC4F,GAAG,CAACG,MAAM,EAAE,EAAE,IAAI,EAAE,oBAAoB,CAAC;QACvEP,QAAQ,GAAGI,GAAG;QACd;MACF;IACA,KAAK,QAAQ,CAAE;QACb,MAAMI,cAAc,GAAG,IAAIC,OAAO,CAAC,CAAAC,OAAO,KAAI;UAC5C7E,MAAM,CAAC8E,MAAM,CAAC,CAAAC,IAAI,KAAIF,OAAO,CAACE,IAAI,CAAC,CAAC;QACtC,CAAC,CAAC;QACF,MAAMA,IAAI,GAAI,MAAMJ,cAAuB;QAC3C,MAAMN,GAAG,GAAGW,GAAG,CAACC,eAAe,CAACF,IAAI,CAAC;QACrC,MAAMR,GAAG,GAAG,IAAIC,KAAK,CAACxE,MAAM,CAACe,KAAK,EAAEf,MAAM,CAACgB,MAAM,CAAC;QAClDuD,GAAG,CAACE,GAAG,GAAGJ,GAAG;QACb,MAAM1F,uBAAuB,CAAC4F,GAAG,CAACG,MAAM,EAAE,EAAE,IAAI,EAAE,oBAAoB,CAAC;QACvEP,QAAQ,GAAGI,GAAG;QACd;MACF;IACA,KAAK,aAAa,CAAE;QAClBJ,QAAQ,GAAG,MAAMe,iBAAiB,CAAClF,MAAM,CAAC;QAC1C;MACF;IACA;MACEpB,WAAW,EAAE,CAAC;;;EAGlB8E,gBAAgB,CAAC/D,CAAC,EAAEwE,QAAQ,EAAExE,CAAC,CAACoE,MAAM,CAACjE,UAAU,EAAEN,MAAM,CAACG,CAAC,CAACoE,MAAM,CAAClE,SAAS,CAAC,CAAC;AAChF,CAAC,CAAC;;AAEJR,CAAC,CAACwE,IAAI,CAAC,0BAA0B,CAAC;AAC/BC,IAAI;AACF;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK,CACF;;AACAC,MAAM,CAAC,CAAAC,CAAC;AACPA,CAAC,CAAC;AAAA,CACCC,OAAO,CAAC,QAAQ,EAAElF,qBAAqB,CAAC;AACxCkF,OAAO,CAAC,WAAW,EAAEpF,iBAAiB,CAAC;AACvCoF,OAAO,CAAC,YAAY,EAAEnF,kBAAkB,CAAC;AACzCmF,OAAO,CAAC,cAAc,EAAE,CAAC,eAAe,EAAE,uBAAuB,EAAE,aAAa,CAAC,CAAC,CACtF;;AACAC,EAAE,CAAC,OAAMvE,CAAC,KAAI;EACb,MAAMwF,eAAe,GAAGzF,uBAAuB;EAC7CC,CAAC;EACDA,CAAC,CAACoE,MAAM,CAACnE,MAAM;EACfD,CAAC,CAACoE,MAAM,CAAClE,SAAS;EAClBF,CAAC,CAACoE,MAAM,CAACjE,UAAU;EACnB,WAAW,CACZ;;;EAED,IAAIqE,QAAwC;EAC5C,QAAQxE,CAAC,CAACoE,MAAM,CAACK,YAAY;IAC3B,KAAK,eAAe,CAAE;QACpB,IAAI,OAAOe,eAAe,CAACC,aAAa,KAAKC,SAAS,EAAE;UACtD1F,CAAC,CAAC2F,IAAI,CAAC,uDAAuD,CAAC;UAC/D;QACF;QACA,MAAMP,IAAI,GAAG,MAAMI,eAAe,CAACC,aAAa,EAAE;QAClD,MAAMf,GAAG,GAAGW,GAAG,CAACC,eAAe,CAACF,IAAI,CAAC;QACrC,MAAMR,GAAG,GAAG,IAAIC,KAAK,CAACW,eAAe,CAACpE,KAAK,EAAEoE,eAAe,CAACnE,MAAM,CAAC;QACpEuD,GAAG,CAACE,GAAG,GAAGJ,GAAG;QACb,MAAM1F,uBAAuB,CAAC4F,GAAG,CAACG,MAAM,EAAE,EAAE,IAAI,EAAE,oBAAoB,CAAC;QACvEP,QAAQ,GAAGI,GAAG;QACd;MACF;IACA,KAAK,uBAAuB,CAAE;QAC5B,IAAI,OAAOY,eAAe,CAACI,qBAAqB,KAAKF,SAAS,EAAE;UAC9D1F,CAAC,CAAC2F,IAAI,CAAC,+DAA+D,CAAC;UACvE;QACF;QACAnB,QAAQ,GAAGgB,eAAe,CAACI,qBAAqB,EAAE;QAClD;MACF;IACA,KAAK,aAAa,CAAE;QAClBpB,QAAQ,GAAG,MAAMe,iBAAiB,CAACC,eAAe,CAAC;QACnD;MACF;IACA;MACEvG,WAAW,EAAE,CAAC;;;EAGlB8E,gBAAgB,CAAC/D,CAAC,EAAEwE,QAAQ,EAAExE,CAAC,CAACoE,MAAM,CAACjE,UAAU,EAAEN,MAAM,CAACG,CAAC,CAACoE,MAAM,CAAClE,SAAS,CAAC,CAAC;AAChF,CAAC,CAAC;;AAEJR,CAAC,CAACwE,IAAI,CAAC,8BAA8B,CAAC;AACnCC,IAAI;AACF;AACL;AACA;AACA;AACA;AACA,KAAK,CACF;;AACAC,MAAM,CAAC,CAAAC,CAAC;AACPA,CAAC,CAAC;AAAA,CACCC,OAAO,CAAC,QAAQ,EAAElF,qBAAqB,CAAC;AACxCkF,OAAO,CAAC,WAAW,EAAEpF,iBAAiB,CAAC;AACvCoF,OAAO,CAAC,OAAO,EAAE,CAAC,OAAO,EAAE,QAAQ,CAAC,CAAC;AACrCA,OAAO,CAAC,QAAQ,EAAE,CAAC,YAAY,EAAE,eAAe,CAAC,CAAC,CACtD;;AACAC,EAAE,CAAC,CAAAvE,CAAC,KAAI;EACP,MAAM,EAAEC,MAAM,EAAE4F,KAAK,EAAEC,MAAM,CAAC,CAAC,GAAG9F,CAAC,CAACoE,MAAM;EAC1C,MAAM/D,MAAM,GAAGN,uBAAuB,CAACC,CAAC,EAAEC,MAAM,EAAED,CAAC,CAACoE,MAAM,CAAClE,SAAS,EAAE,MAAM,EAAE,UAAU,CAAC;;EAEzF,MAAM6F,YAA+B,GAAGtG,oBAAoB,CAACO,CAAC,EAAEK,MAAM,CAACe,KAAK,EAAEf,MAAM,CAACgB,MAAM,CAAC;EAC5F,MAAM2E,EAAE,GAAGD,YAAY,CAACxF,UAAU,CAACsF,KAAK,CAAmD;EAC3F,IAAIG,EAAE,KAAK,IAAI,EAAE;IACf;EACF;;EAEA,MAAMxD,OAAO,GAAGwD,EAAE,CAAC9E,aAAa,EAAE;EAClC8E,EAAE,CAACC,WAAW,CAACD,EAAE,CAACE,UAAU,EAAE1D,OAAO,CAAC;EACtC,QAAQsD,MAAM;IACZ,KAAK,YAAY,CAAE;QACjBE,EAAE,CAACG,UAAU,CAACH,EAAE,CAACE,UAAU,EAAE,CAAC,EAAEF,EAAE,CAACI,IAAI,EAAEJ,EAAE,CAACI,IAAI,EAAEJ,EAAE,CAACK,aAAa,EAAEhG,MAAM,CAAC;QAC3E;MACF;IACA,KAAK,eAAe,CAAE;QACpB2F,EAAE,CAACG,UAAU;QACXH,EAAE,CAACE,UAAU;QACb,CAAC;QACDF,EAAE,CAACI,IAAI;QACP/F,MAAM,CAACe,KAAK;QACZf,MAAM,CAACgB,MAAM;QACb,CAAC;QACD2E,EAAE,CAACI,IAAI;QACPJ,EAAE,CAACK,aAAa;QAChB,IAAI,CACL;;QACDL,EAAE,CAACM,aAAa,CAACN,EAAE,CAACE,UAAU,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAEF,EAAE,CAACI,IAAI,EAAEJ,EAAE,CAACK,aAAa,EAAEhG,MAAM,CAAC;QAC3E;MACF;IACA;MACEpB,WAAW,EAAE,CAAC;;;EAGlB,MAAMsH,EAAE,GAAGP,EAAE,CAACQ,iBAAiB,EAAE;;EAEjCR,EAAE,CAACS,eAAe,CAACT,EAAE,CAACU,WAAW,EAAEH,EAAE,CAAC;EACtCP,EAAE,CAACW,oBAAoB,CAACX,EAAE,CAACU,WAAW,EAAEV,EAAE,CAACY,iBAAiB,EAAEZ,EAAE,CAACE,UAAU,EAAE1D,OAAO,EAAE,CAAC,CAAC;;EAExF,MAAMqE,MAAM,GAAG,IAAIC,UAAU,CAACzG,MAAM,CAACe,KAAK,GAAGf,MAAM,CAACgB,MAAM,GAAG,CAAC,CAAC;EAC/D2E,EAAE,CAACe,UAAU,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAEf,EAAE,CAACI,IAAI,EAAEJ,EAAE,CAACK,aAAa,EAAEQ,MAAM,CAAC;EAC5D,MAAM7C,MAAM,GAAG,IAAIlE,iBAAiB,CAAC+G,MAAM,CAAC;;EAE5C7G,CAAC,CAACiE,QAAQ,CAAC3E,kBAAkB,CAAC0E,MAAM,EAAEnE,MAAM,CAACG,CAAC,CAACoE,MAAM,CAAClE,SAAS,CAAC,CAAC,CAAC;AACpE,CAAC,CAAC;;AAEJR,CAAC,CAACwE,IAAI,CAAC,gBAAgB,CAAC;AACrBC,IAAI;AACF;AACL;AACA;AACA;AACA;AACA;AACA;AACA,KAAK,CACF;;AACAC,MAAM,CAAC,CAAAC,CAAC;AACPA,CAAC,CAAC;AAAA,CACCC,OAAO,CAAC,QAAQ,EAAElF,qBAAqB,CAAC;AACxCkF,OAAO,CAAC,WAAW,EAAEpF,iBAAiB,CAAC;AACvCoF,OAAO,CAAC,YAAY,EAAEnF,kBAAkB,CAAC;AACzCmF,OAAO,CAAC,kBAAkB,EAAE/E,eAAe,CAAC;AAC5C+E,OAAO,CAAC,cAAc,EAAE/E,eAAe,CAAC,CAC5C;;AACAgF,EAAE,CAAC,CAAAvE,CAAC,KAAI;EACP,MAAM,EAAEC,MAAM,EAAE+G,gBAAgB,EAAE9G,SAAS,EAAEC,UAAU,EAAE8G,YAAY,CAAC,CAAC,GAAGjH,CAAC,CAACoE,MAAM;;EAElF,MAAM/D,MAAM,GAAGN,uBAAuB,CAACC,CAAC,EAAEC,MAAM,EAAEC,SAAS,EAAEC,UAAU,EAAE6G,gBAAgB,CAAC;;EAE1F,MAAMjB,YAAY,GAAGvG,YAAY,CAACQ,CAAC,EAAEiH,YAAY,EAAE5G,MAAM,CAACe,KAAK,EAAEf,MAAM,CAACgB,MAAM,CAAC;EAC/E,MAAMf,GAAG,GAAGyF,YAAY,CAACxF,UAAU,CAAC,IAAI,CAA6B;EACrE,IAAID,GAAG,KAAK,IAAI,EAAE;IAChBN,CAAC,CAAC2F,IAAI,CAACsB,YAAY,GAAG,+BAA+B,CAAC;IACtD;EACF;;EAEA3G,GAAG,CAACyC,SAAS,CAAC1C,MAAM,EAAE,CAAC,EAAE,CAAC,CAAC;EAC3B6C,gCAAgC,CAAClD,CAAC,EAAEM,GAAG,EAAET,MAAM,CAACG,CAAC,CAACoE,MAAM,CAAClE,SAAS,CAAC,CAAC;AACtE,CAAC,CAAC;;AAEJR,CAAC,CAACwE,IAAI,CAAC,iDAAiD,CAAC;AACtDC,IAAI;AACF,qHAAoH,CACtH;;AACAI,EAAE,CAAC,CAAAvE,CAAC,KAAI;EACP,MAAMK,MAAM,GAAGb,YAAY,CAACQ,CAAC,EAAE,WAAW,EAAE,CAAC,EAAE,CAAC,CAAC;EACjDK,MAAM,CAACE,UAAU,CAAC,QAAQ,CAAC;;EAE3B;EACA,MAAM2G,EAAE,GAAG7G,MAAM,CAACuF,qBAAqB,EAAE;EACzC5F,CAAC,CAACH,MAAM,CAACqH,EAAE,CAAC9F,KAAK,KAAKf,MAAM,CAACe,KAAK,CAAC;EACnCpB,CAAC,CAACH,MAAM,CAACqH,EAAE,CAAC7F,MAAM,KAAKhB,MAAM,CAACgB,MAAM,CAAC;;EAErC,MAAM8F,cAAc,GAAGC,QAAQ,CAACC,aAAa,CAAC,QAAQ,CAAC;EACvDF,cAAc,CAAC/F,KAAK,GAAGf,MAAM,CAACe,KAAK;EACnC+F,cAAc,CAAC9F,MAAM,GAAGhB,MAAM,CAACgB,MAAM;EACrC,MAAMiG,eAAe,GAAGH,cAAc,CAAC5G,UAAU,CAAC,IAAI,EAAE;IACtDgH,KAAK,EAAE;EACT,CAAC,CAAC;EACF,IAAID,eAAe,KAAK,IAAI,EAAE;IAC5BtH,CAAC,CAAC2F,IAAI,CAAC,gCAAgC,CAAC;IACxC;EACF;;EAEA;EACA,MAAM6B,QAAQ,GAAG,IAAI1H,iBAAiB,CAACO,MAAM,CAACe,KAAK,GAAGf,MAAM,CAACgB,MAAM,GAAG,CAAC,CAAC;EACxE,KAAK,IAAIoG,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGD,QAAQ,CAACE,UAAU,EAAED,CAAC,IAAI,CAAC,EAAE;IAC/CD,QAAQ,CAACC,CAAC,GAAG,CAAC,CAAC,GAAG,CAAC;IACnBD,QAAQ,CAACC,CAAC,GAAG,CAAC,CAAC,GAAG,CAAC;IACnBD,QAAQ,CAACC,CAAC,GAAG,CAAC,CAAC,GAAG,CAAC;IACnBD,QAAQ,CAACC,CAAC,GAAG,CAAC,CAAC,GAAG,GAAG;EACvB;;EAEAH,eAAe,CAACvE,SAAS,CAACmE,EAAE,EAAE,CAAC,EAAE,CAAC,CAAC;EACnChE,gCAAgC,CAAClD,CAAC,EAAEsH,eAAe,EAAEE,QAAQ,CAAC;AAChE,CAAC,CAAC;;AAEJ9H,CAAC,CAACwE,IAAI,CAAC,iCAAiC,CAAC;AACtCC,IAAI;AACF;AACL;AACA,4DAA4D,CACzD;;AACAC,MAAM,CAAC,CAAAC,CAAC,KAAIA,CAAC,CAACC,OAAO,CAAC,WAAW,EAAE,CAAC,IAAI,EAAE,KAAK,CAAC,CAAC,CAAC;AAClDC,EAAE,CAAC,CAAAvE,CAAC,KAAI;EACP,MAAM,EAAES,SAAS,CAAC,CAAC,GAAGT,CAAC,CAACoE,MAAM;EAC9B,MAAM/D,MAAM,GAAGb,YAAY,CAACQ,CAAC,EAAE,WAAW,EAAE,CAAC,EAAE,CAAC,CAAC;EACjD,MAAMM,GAAG,GAAGD,MAAM,CAACE,UAAU,CAAC,QAAQ,CAAE;;EAExC,IAAIE,SAAS,EAAE;IACbT,CAAC,CAAC2H,qBAAqB,CAAC,MAAMrH,GAAG,CAACG,SAAS,CAAC,EAAEC,MAAM,EAAEV,CAAC,CAACU,MAAM,EAAET,MAAM,EAAE,YAAY,CAAC,CAAC,CAAC,CAAC;EAC1F;;EAEA;EACAD,CAAC,CAAC4H,WAAW,CAAC,IAAI,EAAE,MAAM;IACxBvH,MAAM,CAACuF,qBAAqB,EAAE;EAChC,CAAC,CAAC;AACJ,CAAC,CAAC;;AAEJlG,CAAC,CAACwE,IAAI,CAAC,iCAAiC,CAAC;AACtCC,IAAI,CAAE,gFAA+E,CAAC;AACtFI,EAAE,CAAC,CAAAvE,CAAC,KAAI;EACP,MAAMK,MAAM,GAAGb,YAAY,CAACQ,CAAC,EAAE,WAAW,EAAE,OAAO,EAAE,OAAO,CAAC;EAC7DK,MAAM,CAACE,UAAU,CAAC,QAAQ,CAAC;;EAE3B;EACAP,CAAC,CAAC4H,WAAW,CAAC,IAAI,EAAE,MAAM;IACxBvH,MAAM,CAACuF,qBAAqB,EAAE;EAChC,CAAC,CAAC;AACJ,CAAC,CAAC"}