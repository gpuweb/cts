{"version":3,"file":"arrayLength.spec.js","names":["description","makeTestGroup","GPUTest","align","g","kTestTypes","type","stride","kWgslStructures","runShaderTest","t","wgsl","offset","buffer_size","binding_size","binding_offset","pipeline","device","createComputePipeline","layout","compute","module","createShaderModule","code","entryPoint","buffer","createBufferTracked","size","usage","GPUBufferUsage","STORAGE","lengthBuffer","COPY_SRC","bindGroup","createBindGroup","getBindGroupLayout","entries","binding","resource","encoder","createCommandEncoder","pass","beginComputePass","setPipeline","setBindGroup","dispatchWorkgroups","end","queue","submit","finish","length","expectGPUBufferValuesEqual","Uint32Array","typeRequiresF16","test_type","includes","shaderHeader","test","specURL","desc","params","u","combineWithParams","beforeAllSubcases","selectDeviceOrSkipTestCase","fn","combine","member_offset"],"sources":["../../../../../../../src/webgpu/shader/execution/expression/call/builtin/arrayLength.spec.ts"],"sourcesContent":["export const description = `\nExecution tests for the 'arrayLength' builtin function.\n\nfn arrayLength(e: ptr<storage,array<T>> ) -> u32\nReturns the number of elements in the runtime-sized array.\n`;\n\nimport { makeTestGroup } from '../../../../../../common/framework/test_group.js';\nimport { GPUTest } from '../../../../../gpu_test.js';\nimport { align } from '../../../../../util/math.js';\n\nexport const g = makeTestGroup(GPUTest);\n\n// List of array element types to test.\nconst kTestTypes = [\n  { type: 'u32', stride: 4 },\n  { type: 'i32', stride: 4 },\n  { type: 'f32', stride: 4 },\n  { type: 'f16', stride: 2 },\n  { type: 'vec2<u32>', stride: 8 },\n  { type: 'vec2<i32>', stride: 8 },\n  { type: 'vec2<f32>', stride: 8 },\n  { type: 'vec2<f16>', stride: 4 },\n  { type: 'vec3<u32>', stride: 16 },\n  { type: 'vec3<i32>', stride: 16 },\n  { type: 'vec3<f32>', stride: 16 },\n  { type: 'vec3<f16>', stride: 8 },\n  { type: 'vec4<u32>', stride: 16 },\n  { type: 'vec4<i32>', stride: 16 },\n  { type: 'vec4<f32>', stride: 16 },\n  { type: 'vec4<f16>', stride: 8 },\n  { type: 'mat2x2<f32>', stride: 16 },\n  { type: 'mat2x3<f32>', stride: 32 },\n  { type: 'mat2x4<f32>', stride: 32 },\n  { type: 'mat3x2<f32>', stride: 24 },\n  { type: 'mat3x3<f32>', stride: 48 },\n  { type: 'mat3x4<f32>', stride: 48 },\n  { type: 'mat4x2<f32>', stride: 32 },\n  { type: 'mat4x3<f32>', stride: 64 },\n  { type: 'mat4x4<f32>', stride: 64 },\n  { type: 'mat2x2<f16>', stride: 8 },\n  { type: 'mat2x3<f16>', stride: 16 },\n  { type: 'mat2x4<f16>', stride: 16 },\n  { type: 'mat3x2<f16>', stride: 12 },\n  { type: 'mat3x3<f16>', stride: 24 },\n  { type: 'mat3x4<f16>', stride: 24 },\n  { type: 'mat4x2<f16>', stride: 16 },\n  { type: 'mat4x3<f16>', stride: 32 },\n  { type: 'mat4x4<f16>', stride: 32 },\n  { type: 'atomic<u32>', stride: 4 },\n  { type: 'atomic<i32>', stride: 4 },\n  { type: 'array<u32,4>', stride: 16 },\n  { type: 'array<i32,4>', stride: 16 },\n  { type: 'array<f32,4>', stride: 16 },\n  { type: 'array<f16,4>', stride: 8 },\n  // Structures - see declarations below.\n  { type: 'ElemStruct', stride: 4 },\n  { type: 'ElemStruct_ImplicitPadding', stride: 16 },\n  { type: 'ElemStruct_ExplicitPadding', stride: 32 },\n] as const;\n\n// Declarations for structures used as array element types.\nconst kWgslStructures = `\nstruct ElemStruct { a : u32 }\nstruct ElemStruct_ImplicitPadding { a : vec3<u32> }\nstruct ElemStruct_ExplicitPadding { @align(32) a : u32 }\n`;\n\n/**\n * Run a shader and check that the array length is correct.\n *\n * @param t The test object\n * @param wgsl The shader source\n * @param stride The stride in bytes of the array element type\n * @param offset The offset in bytes of the array from the start of the binding\n * @param buffer_size The size in bytes of the buffer to allocate\n * @param binding_size The size in bytes of the binding\n * @param binding_offset The offset in bytes of the binding\n * @param expected The array of expected values after running the shader\n */\nfunction runShaderTest(\n  t: GPUTest,\n  wgsl: string,\n  stride: number,\n  offset: number,\n  buffer_size: number,\n  binding_size: number,\n  binding_offset: number\n): void {\n  // Create the compute pipeline.\n  const pipeline = t.device.createComputePipeline({\n    layout: 'auto',\n    compute: {\n      module: t.device.createShaderModule({ code: wgsl }),\n      entryPoint: 'main',\n    },\n  });\n\n  // Create the buffer that will contain the runtime-sized array.\n  const buffer = t.createBufferTracked({\n    size: buffer_size,\n    usage: GPUBufferUsage.STORAGE,\n  });\n\n  // Create the buffer that will receive the array length.\n  const lengthBuffer = t.createBufferTracked({\n    size: 4,\n    usage: GPUBufferUsage.STORAGE | GPUBufferUsage.COPY_SRC,\n  });\n\n  // Set up bindings.\n  const bindGroup = t.device.createBindGroup({\n    layout: pipeline.getBindGroupLayout(0),\n    entries: [\n      { binding: 0, resource: { buffer, size: binding_size, offset: binding_offset } },\n      { binding: 1, resource: { buffer: lengthBuffer } },\n    ],\n  });\n\n  // Run the shader.\n  const encoder = t.device.createCommandEncoder();\n  const pass = encoder.beginComputePass();\n  pass.setPipeline(pipeline);\n  pass.setBindGroup(0, bindGroup);\n  pass.dispatchWorkgroups(1);\n  pass.end();\n  t.queue.submit([encoder.finish()]);\n\n  // Check the length.\n  const length = (binding_size - offset) / stride;\n  t.expectGPUBufferValuesEqual(lengthBuffer, new Uint32Array([length]));\n}\n\n/**\n * Test if a WGSL type string require using f16 extension.\n *\n * @param test_type The wgsl type for testing\n */\nfunction typeRequiresF16(test_type: string): boolean {\n  return test_type.includes('f16');\n}\n\n/**\n * Generate the necessary wgsl header for tested type, especially for f16\n *\n * @param test_type The wgsl type for testing\n */\nfunction shaderHeader(test_type: string): string {\n  return typeRequiresF16(test_type) ? 'enable f16;\\n\\n' : '';\n}\n\ng.test('single_element')\n  .specURL('https://www.w3.org/TR/WGSL/#arrayLength-builtin')\n  .desc(\n    `Test the arrayLength() builtin with a binding that is just large enough for a single element.\n\n     Test parameters:\n     - type: The WGSL type to use as the array element type.\n     - stride: The stride in bytes of the array element type.\n    `\n  )\n  .params(u => u.combineWithParams(kTestTypes))\n  .beforeAllSubcases(t => {\n    if (typeRequiresF16(t.params.type)) {\n      t.selectDeviceOrSkipTestCase('shader-f16');\n    }\n  })\n  .fn(t => {\n    const wgsl =\n      shaderHeader(t.params.type) +\n      kWgslStructures +\n      `\n      @group(0) @binding(0) var<storage, read_write> buffer : array<${t.params.type}>;\n      @group(0) @binding(1) var<storage, read_write> length : u32;\n      @compute @workgroup_size(1)\n      fn main() {\n        length = arrayLength(&buffer);\n      }\n    `;\n    let buffer_size: number = t.params.stride;\n    // Ensure that binding size is multiple of 4.\n    buffer_size = buffer_size + ((~buffer_size + 1) & 3);\n    runShaderTest(t, wgsl, t.params.stride, 0, buffer_size, buffer_size, 0);\n  });\n\ng.test('multiple_elements')\n  .specURL('https://www.w3.org/TR/WGSL/#arrayLength-builtin')\n  .desc(\n    `Test the arrayLength() builtin with a binding that is large enough for multiple elements.\n\n     We test sizes that are not exact multiples of the array element strides, to test that the\n     length is correctly floored to the next whole element.\n\n     Test parameters:\n     - buffer_size: The size in bytes of the buffer.\n     - type: The WGSL type to use as the array element type.\n     - stride: The stride in bytes of the array element type.\n    `\n  )\n  .params(u =>\n    u.combine('buffer_size', [640, 1004, 1048576] as const).combineWithParams(kTestTypes)\n  )\n  .beforeAllSubcases(t => {\n    if (typeRequiresF16(t.params.type)) {\n      t.selectDeviceOrSkipTestCase('shader-f16');\n    }\n  })\n  .fn(t => {\n    const wgsl =\n      shaderHeader(t.params.type) +\n      kWgslStructures +\n      `\n      @group(0) @binding(0) var<storage, read_write> buffer : array<${t.params.type}>;\n      @group(0) @binding(1) var<storage, read_write> length : u32;\n      @compute @workgroup_size(1)\n      fn main() {\n        length = arrayLength(&buffer);\n      }\n    `;\n    runShaderTest(t, wgsl, t.params.stride, 0, t.params.buffer_size, t.params.buffer_size, 0);\n  });\n\ng.test('struct_member')\n  .specURL('https://www.w3.org/TR/WGSL/#arrayLength-builtin')\n  .desc(\n    `Test the arrayLength() builtin with an array that is inside a structure.\n\n     We include offsets that are not exact multiples of the array element strides, to test that\n     the length is correctly floored to the next whole element.\n\n     Test parameters:\n     - member_offset: The offset (in bytes) of the array member from the start of the struct.\n     - type: The WGSL type to use as the array element type.\n     - stride: The stride in bytes of the array element type.\n    `\n  )\n  .params(u => u.combine('member_offset', [0, 4, 20] as const).combineWithParams(kTestTypes))\n  .beforeAllSubcases(t => {\n    if (typeRequiresF16(t.params.type)) {\n      t.selectDeviceOrSkipTestCase('shader-f16');\n    }\n  })\n  .fn(t => {\n    const member_offset = align(t.params.member_offset, t.params.stride);\n    const wgsl =\n      shaderHeader(t.params.type) +\n      kWgslStructures +\n      `\n      alias ArrayType = array<${t.params.type}>;\n      struct Struct {\n        ${t.params.member_offset > 0 ? `@size(${member_offset}) padding : u32,` : ``}\n        arr : ArrayType,\n      }\n      @group(0) @binding(0) var<storage, read_write> buffer : Struct;\n      @group(0) @binding(1) var<storage, read_write> length : u32;\n      @compute @workgroup_size(1)\n      fn main() {\n        length = arrayLength(&buffer.arr);\n      }\n    `;\n    const buffer_size = 1048576;\n    runShaderTest(t, wgsl, t.params.stride, member_offset, buffer_size, buffer_size, 0);\n  });\n\ng.test('binding_subregion')\n  .specURL('https://www.w3.org/TR/WGSL/#arrayLength-builtin')\n  .desc(\n    `Test the arrayLength() builtin when used with a binding that starts at a non-zero offset and\n     does not fill the entire buffer.\n    `\n  )\n  .fn(t => {\n    const wgsl = `\n      @group(0) @binding(0) var<storage, read_write> buffer : array<vec3<f32>>;\n      @group(0) @binding(1) var<storage, read_write> length : u32;\n      @compute @workgroup_size(1)\n      fn main() {\n        length = arrayLength(&buffer);\n      }\n    `;\n    const stride = 16;\n    const buffer_size = 1024;\n    const binding_size = 640;\n    const binding_offset = 256;\n    runShaderTest(t, wgsl, stride, 0, buffer_size, binding_size, binding_offset);\n  });\n\ng.test('read_only')\n  .specURL('https://www.w3.org/TR/WGSL/#arrayLength-builtin')\n  .desc(\n    `Test the arrayLength() builtin when used with a read-only storage buffer.\n    `\n  )\n  .fn(t => {\n    const wgsl = `\n      @group(0) @binding(0) var<storage, read> buffer : array<vec3<f32>>;\n      @group(0) @binding(1) var<storage, read_write> length : u32;\n      @compute @workgroup_size(1)\n      fn main() {\n        length = arrayLength(&buffer);\n      }\n    `;\n    const stride = 16;\n    const buffer_size = 1024;\n    runShaderTest(t, wgsl, stride, 0, buffer_size, buffer_size, 0);\n  });\n"],"mappings":"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"}