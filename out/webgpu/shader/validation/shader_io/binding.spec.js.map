{"version":3,"file":"binding.spec.js","names":["description","makeTestGroup","keysOf","ShaderValidationTest","g","kTests","const_expr","src","pass","override_expr","zero","one","comment","split_line","trailing_comma","int_literal","uint_literal","hex_literal","negative","missing_value","missing_left_paren","missing_right_paren","multiple_values","f32_val_literal","f32_val","no_params","misspelling","multi_binding","test","desc","params","u","combine","fn","t","code","attr","expectCompileResult","beforeAllSubcases","selectDeviceOrSkipTestCase"],"sources":["../../../../../src/webgpu/shader/validation/shader_io/binding.spec.ts"],"sourcesContent":["export const description = `Validation tests for binding`;\n\nimport { makeTestGroup } from '../../../../common/framework/test_group.js';\nimport { keysOf } from '../../../../common/util/data_tables.js';\nimport { ShaderValidationTest } from '../shader_validation_test.js';\n\nexport const g = makeTestGroup(ShaderValidationTest);\n\nconst kTests = {\n  const_expr: {\n    src: `const z = 5;\n    const y = 2;\n    @binding(z + y)`,\n    pass: true,\n  },\n  override_expr: {\n    src: `override z = 5;\n    @binding(z)`,\n    pass: false,\n  },\n\n  zero: {\n    src: `@binding(0)`,\n    pass: true,\n  },\n  one: {\n    src: `@binding(1)`,\n    pass: true,\n  },\n  comment: {\n    src: `@/* comment */binding(1)`,\n    pass: true,\n  },\n  split_line: {\n    src: '@ \\n binding(1)',\n    pass: true,\n  },\n  trailing_comma: {\n    src: `@binding(1,)`,\n    pass: true,\n  },\n  int_literal: {\n    src: `@binding(1i)`,\n    pass: true,\n  },\n  uint_literal: {\n    src: `@binding(1u)`,\n    pass: true,\n  },\n  hex_literal: {\n    src: `@binding(0x1)`,\n    pass: true,\n  },\n\n  negative: {\n    src: `@binding(-1)`,\n    pass: false,\n  },\n  missing_value: {\n    src: `@binding()`,\n    pass: false,\n  },\n  missing_left_paren: {\n    src: `@binding 1)`,\n    pass: false,\n  },\n  missing_right_paren: {\n    src: `@binding(1`,\n    pass: false,\n  },\n  multiple_values: {\n    src: `@binding(1,2)`,\n    pass: false,\n  },\n  f32_val_literal: {\n    src: `@binding(1.0)`,\n    pass: false,\n  },\n  f32_val: {\n    src: `@binding(1f)`,\n    pass: false,\n  },\n  no_params: {\n    src: `@binding`,\n    pass: false,\n  },\n  misspelling: {\n    src: `@abinding(1)`,\n    pass: false,\n  },\n  multi_binding: {\n    src: `@binding(1) @binding(1)`,\n    pass: false,\n  },\n};\ng.test('binding')\n  .desc(`Test validation of binding`)\n  .params(u => u.combine('attr', keysOf(kTests)))\n  .fn(t => {\n    const code = `\n${kTests[t.params.attr].src} @group(1)\nvar<storage> a: i32;\n\n@workgroup_size(1, 1, 1)\n@compute fn main() {\n  _ = a;\n}`;\n    t.expectCompileResult(kTests[t.params.attr].pass, code);\n  });\n\ng.test('binding_f16')\n  .desc(`Test validation of binding with f16`)\n  .beforeAllSubcases(t => {\n    t.selectDeviceOrSkipTestCase('shader-f16');\n  })\n  .fn(t => {\n    const code = `\n@group(1) @binding(1h)\nvar<storage> a: i32;\n\n@workgroup_size(1, 1, 1)\n@compute fn main() {\n  _ = a;\n}`;\n    t.expectCompileResult(false, code);\n  });\n"],"mappings":"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"}