{"version":3,"file":"comments.spec.js","names":["description","makeTestGroup","ShaderValidationTest","g","test","desc","fn","t","code","expectCompileResult","params","u","combine","beginSubcases","blankspace","includes","terminated"],"sources":["../../../../../src/webgpu/shader/validation/parse/comments.spec.ts"],"sourcesContent":["export const description = `Validation tests for comments`;\n\nimport { makeTestGroup } from '../../../../common/framework/test_group.js';\nimport { ShaderValidationTest } from '../shader_validation_test.js';\n\nexport const g = makeTestGroup(ShaderValidationTest);\n\ng.test('comments')\n  .desc(`Test that valid comments are handled correctly, including nesting.`)\n  .fn(t => {\n    const code = `\n/**\n * Here is my shader.\n *\n * /* I can nest /**/ comments. */\n * // I can nest line comments too.\n **/\n@fragment // This is the stage\nfn main(/*\nno\nparameters\n*/) -> @location(0) vec4<f32> {\n  return/*block_comments_delimit_tokens*/vec4<f32>(.4, .2, .3, .1);\n}/* terminated block comments are OK at EOF...*/`;\n    t.expectCompileResult(true, code);\n  });\n\ng.test('line_comment_eof')\n  .desc(`Test that line comments can come at EOF.`)\n  .fn(t => {\n    const code = `\n@fragment\nfn main() -> @location(0) vec4<f32> {\n  return vec4<f32>(.4, .2, .3, .1);\n}\n// line comments are OK at EOF...`;\n    t.expectCompileResult(true, code);\n  });\n\ng.test('line_comment_terminators')\n  .desc(`Test that line comments are terminated by any blankspace other than space and \\t`)\n  .params(u =>\n    u\n      .combine('blankspace', [\n        [' ', 'space'],\n        ['\\t', 'tab'],\n        ['\\u000a', 'line_feed'],\n        ['\\u000b', 'vertical_tab'],\n        ['\\u000c', 'form_feed'],\n        ['\\u000d', 'carriage_return'],\n        ['\\u000d\\u000a', 'carriage_return_line_feed'],\n        ['\\u0085', 'next_line'],\n        ['\\u2028', 'line_separator'],\n        ['\\u2029', 'paragraph_separator'],\n      ])\n      .beginSubcases()\n  )\n  .fn(t => {\n    const code = `// Line comment${t.params.blankspace[0]}const invalid_outside_comment = should_fail`;\n\n    t.expectCompileResult([' ', '\\t'].includes(t.params.blankspace[0]), code);\n  });\n\ng.test('unterminated_block_comment')\n  .desc(`Test that unterminated block comments cause an error`)\n  .params(u => u.combine('terminated', [true, false]).beginSubcases())\n  .fn(t => {\n    const code = `\n/**\n * Unterminated block comment.\n *\n ${t.params.terminated ? '*/' : ''}`;\n\n    t.expectCompileResult(t.params.terminated, code);\n  });\n"],"mappings":";;GAAA,OAAO,MAAMA,WAAW,GAAI,+BAA8B,CAE1D,SAASC,aAAa,QAAQ,4CAA4C;AAC1E,SAASC,oBAAoB,QAAQ,8BAA8B;;AAEnE,OAAO,MAAMC,CAAC,GAAGF,aAAa,CAACC,oBAAoB,CAAC;;AAEpDC,CAAC,CAACC,IAAI,CAAC,UAAU,CAAC;AACfC,IAAI,CAAE,oEAAmE,CAAC;AAC1EC,EAAE,CAAC,CAAAC,CAAC,KAAI;EACP,MAAMC,IAAI,GAAI;AAClB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iDAAiD;EAC7CD,CAAC,CAACE,mBAAmB,CAAC,IAAI,EAAED,IAAI,CAAC;AACnC,CAAC,CAAC;;AAEJL,CAAC,CAACC,IAAI,CAAC,kBAAkB,CAAC;AACvBC,IAAI,CAAE,0CAAyC,CAAC;AAChDC,EAAE,CAAC,CAAAC,CAAC,KAAI;EACP,MAAMC,IAAI,GAAI;AAClB;AACA;AACA;AACA;AACA,kCAAkC;EAC9BD,CAAC,CAACE,mBAAmB,CAAC,IAAI,EAAED,IAAI,CAAC;AACnC,CAAC,CAAC;;AAEJL,CAAC,CAACC,IAAI,CAAC,0BAA0B,CAAC;AAC/BC,IAAI,CAAE,kFAAiF,CAAC;AACxFK,MAAM,CAAC,CAAAC,CAAC;AACPA,CAAC;AACEC,OAAO,CAAC,YAAY,EAAE;AACrB,CAAC,GAAG,EAAE,OAAO,CAAC;AACd,CAAC,IAAI,EAAE,KAAK,CAAC;AACb,CAAC,QAAQ,EAAE,WAAW,CAAC;AACvB,CAAC,QAAQ,EAAE,cAAc,CAAC;AAC1B,CAAC,QAAQ,EAAE,WAAW,CAAC;AACvB,CAAC,QAAQ,EAAE,iBAAiB,CAAC;AAC7B,CAAC,cAAc,EAAE,2BAA2B,CAAC;AAC7C,CAAC,QAAQ,EAAE,WAAW,CAAC;AACvB,CAAC,QAAQ,EAAE,gBAAgB,CAAC;AAC5B,CAAC,QAAQ,EAAE,qBAAqB,CAAC;AAClC,CAAC;AACDC,aAAa,CAAC;AACnB,CAAC;AACAP,EAAE,CAAC,CAAAC,CAAC,KAAI;EACP,MAAMC,IAAI,GAAI,kBAAiBD,CAAC,CAACG,MAAM,CAACI,UAAU,CAAC,CAAC,CAAE,6CAA4C;;EAElGP,CAAC,CAACE,mBAAmB,CAAC,CAAC,GAAG,EAAE,IAAI,CAAC,CAACM,QAAQ,CAACR,CAAC,CAACG,MAAM,CAACI,UAAU,CAAC,CAAC,CAAC,CAAC,EAAEN,IAAI,CAAC;AAC3E,CAAC,CAAC;;AAEJL,CAAC,CAACC,IAAI,CAAC,4BAA4B,CAAC;AACjCC,IAAI,CAAE,sDAAqD,CAAC;AAC5DK,MAAM,CAAC,CAAAC,CAAC,KAAIA,CAAC,CAACC,OAAO,CAAC,YAAY,EAAE,CAAC,IAAI,EAAE,KAAK,CAAC,CAAC,CAACC,aAAa,CAAC,CAAC,CAAC;AACnEP,EAAE,CAAC,CAAAC,CAAC,KAAI;EACP,MAAMC,IAAI,GAAI;AAClB;AACA;AACA;AACA,GAAGD,CAAC,CAACG,MAAM,CAACM,UAAU,GAAG,IAAI,GAAG,EAAG,EAAC;;EAEhCT,CAAC,CAACE,mBAAmB,CAACF,CAAC,CAACG,MAAM,CAACM,UAAU,EAAER,IAAI,CAAC;AAClD,CAAC,CAAC"}