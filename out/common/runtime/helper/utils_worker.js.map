{"version":3,"file":"utils_worker.js","names":["globalTestConfig","Logger","setDefaultRequestAdapterOptions","setupWorkerEnvironment","ctsOptions","powerPreference","compatibility","enableDebugLogs","debug","unrollConstEvalLoops","logToWebSocket","log","compatibilityMode"],"sources":["../../../../src/common/runtime/helper/utils_worker.ts"],"sourcesContent":["import { globalTestConfig } from '../../framework/test_config.js';\nimport { Logger } from '../../internal/logging/logger.js';\nimport { TestQueryWithExpectation } from '../../internal/query/query.js';\nimport { setDefaultRequestAdapterOptions } from '../../util/navigator_gpu.js';\n\nimport { CTSOptions } from './options.js';\n\nexport interface WorkerTestRunRequest {\n  query: string;\n  expectations: TestQueryWithExpectation[];\n  ctsOptions: CTSOptions;\n}\n\n/**\n * Set config environment for workers with ctsOptions and return a Logger.\n */\nexport function setupWorkerEnvironment(ctsOptions: CTSOptions): Logger {\n  const { powerPreference, compatibility } = ctsOptions;\n  globalTestConfig.enableDebugLogs = ctsOptions.debug;\n  globalTestConfig.unrollConstEvalLoops = ctsOptions.unrollConstEvalLoops;\n  globalTestConfig.compatibility = compatibility;\n  globalTestConfig.logToWebSocket = ctsOptions.logToWebSocket;\n\n  const log = new Logger();\n\n  if (powerPreference || compatibility) {\n    setDefaultRequestAdapterOptions({\n      ...(powerPreference && { powerPreference }),\n      // MAINTENANCE_TODO: Change this to whatever the option ends up being\n      ...(compatibility && { compatibilityMode: true }),\n    });\n  }\n\n  return log;\n}\n"],"mappings":";;GAAA,SAASA,gBAAgB,QAAQ,gCAAgC,CACjE,SAASC,MAAM,QAAQ,kCAAkC;AAEzD,SAASC,+BAA+B,QAAQ,6BAA6B;;;;;;;;;;AAU7E;AACA;AACA;AACA,OAAO,SAASC,sBAAsBA,CAACC,UAAsB,EAAU;EACrE,MAAM,EAAEC,eAAe,EAAEC,aAAa,CAAC,CAAC,GAAGF,UAAU;EACrDJ,gBAAgB,CAACO,eAAe,GAAGH,UAAU,CAACI,KAAK;EACnDR,gBAAgB,CAACS,oBAAoB,GAAGL,UAAU,CAACK,oBAAoB;EACvET,gBAAgB,CAACM,aAAa,GAAGA,aAAa;EAC9CN,gBAAgB,CAACU,cAAc,GAAGN,UAAU,CAACM,cAAc;;EAE3D,MAAMC,GAAG,GAAG,IAAIV,MAAM,CAAC,CAAC;;EAExB,IAAII,eAAe,IAAIC,aAAa,EAAE;IACpCJ,+BAA+B,CAAC;MAC9B,IAAIG,eAAe,IAAI,EAAEA,eAAe,CAAC,CAAC,CAAC;MAC3C;MACA,IAAIC,aAAa,IAAI,EAAEM,iBAAiB,EAAE,IAAI,CAAC,CAAC;IAClD,CAAC,CAAC;EACJ;;EAEA,OAAOD,GAAG;AACZ"}