{"version":3,"file":"params_builder_toplevel.spec.js","names":["description","kUnitCaseParamsBuilder","makeTestGroup","makeTestGroupForUnitTesting","TestGroupTest","UnitTest","g","test","params","u","combineWithParams","fn","t","fail","paramsSimple","x","expect","paramsSubcasesOnly","a","y","filter","p","unless","t0","ran","Symbol","iterator","push","expectCases"],"sources":["../../src/unittests/params_builder_toplevel.spec.ts"],"sourcesContent":["export const description = `\nUnit tests for parameterization.\n`;\n\nimport { TestParams } from '../common/framework/fixture.js';\nimport { kUnitCaseParamsBuilder } from '../common/framework/params_builder.js';\nimport { makeTestGroup } from '../common/framework/test_group.js';\nimport { makeTestGroupForUnitTesting } from '../common/internal/test_group.js';\n\nimport { TestGroupTest } from './test_group_test.js';\nimport { UnitTest } from './unit_test.js';\n\nexport const g = makeTestGroup(TestGroupTest);\n\ng.test('combine_none,arg_unit')\n  .params(u => u.combineWithParams([]))\n  .fn(t => {\n    t.fail(\"this test shouldn't run\");\n  });\n\ng.test('combine_none,arg_ignored')\n  .params(() => kUnitCaseParamsBuilder.combineWithParams([]))\n  .fn(t => {\n    t.fail(\"this test shouldn't run\");\n  });\n\ng.test('combine_none,plain_builder')\n  .params(kUnitCaseParamsBuilder.combineWithParams([]))\n  .fn(t => {\n    t.fail(\"this test shouldn't run\");\n  });\n\ng.test('combine_none,plain_array')\n  .paramsSimple([])\n  .fn(t => {\n    t.fail(\"this test shouldn't run\");\n  });\n\ng.test('combine_one,case')\n  .params(u =>\n    u //\n      .combineWithParams([{ x: 1 }])\n  )\n  .fn(t => {\n    t.expect(t.params.x === 1);\n  });\n\ng.test('combine_one,subcase')\n  .paramsSubcasesOnly(u =>\n    u //\n      .combineWithParams([{ x: 1 }])\n  )\n  .fn(t => {\n    t.expect(t.params.x === 1);\n  });\n\ng.test('filter')\n  .params(u =>\n    u\n      .combineWithParams([\n        { a: true, x: 1 }, //\n        { a: false, y: 2 },\n      ])\n      .filter(p => p.a)\n  )\n  .fn(t => {\n    t.expect(t.params.a);\n  });\n\ng.test('unless')\n  .params(u =>\n    u\n      .combineWithParams([\n        { a: true, x: 1 }, //\n        { a: false, y: 2 },\n      ])\n      .unless(p => p.a)\n  )\n  .fn(t => {\n    t.expect(!t.params.a);\n  });\n\ng.test('generator').fn(t0 => {\n  const g = makeTestGroupForUnitTesting(UnitTest);\n\n  const ran: TestParams[] = [];\n\n  g.test('generator')\n    .params(u =>\n      u.combineWithParams({\n        *[Symbol.iterator]() {\n          for (let x = 0; x < 3; ++x) {\n            for (let y = 0; y < 2; ++y) {\n              yield { x, y };\n            }\n          }\n        },\n      })\n    )\n    .fn(t => {\n      ran.push(t.params);\n    });\n\n  t0.expectCases(g, [\n    { test: ['generator'], params: { x: 0, y: 0 } },\n    { test: ['generator'], params: { x: 0, y: 1 } },\n    { test: ['generator'], params: { x: 1, y: 0 } },\n    { test: ['generator'], params: { x: 1, y: 1 } },\n    { test: ['generator'], params: { x: 2, y: 0 } },\n    { test: ['generator'], params: { x: 2, y: 1 } },\n  ]);\n});\n"],"mappings":"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"}